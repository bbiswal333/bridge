(function(){ovi.provide("nokia.maps.util.proto");(function(){var e={}.toString,l=nokia.maps.util.proto=function(h,d,c,g){var b=Function(),f,r;b.prototype=d;b=new b;for(f in h)h.hasOwnProperty(f)&&(b[f]=c&&f in d&&e.call(r=h[f])==="[object Object]"?l(r,d[f],c):h[f]);if(c&&!g)for(f in d)if(d.hasOwnProperty(f)&&(r=d[f])===b[f]&&e.call(r)==="[object Object]")b[f]=l(0,r,c);return b}})();ovi.provide("nokia.maps.map.render.p2d._helpers");
(function(e){ovi.extend(e,{geoToScreen:function(e,h){var d=h.geoToPixel(e),c=h.w;d.x-=Math.round(d.x/c)*c;return d}})})(nokia.maps.map.render.p2d._helpers);ovi.provide("nokia.maps.util.Event");(function(e){var l=e.now,e=e.Event=function(e){this.type=""+e;this.timeStamp=l()};ovi.extend(e.prototype,{target:null,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}})})(nokia.maps.util);ovi.provide("nokia.maps.util.Cache");
(function(e){function l(a,b,c,d){this.c=a;this.J=b;if(this.f!==d)this.f=d;if(c)(c.Z=this).X=c}function h(a,c){b.J=a;b.f=c===void 0?1:c;return b}function d(a){return a===void 0?1:isNaN(a=+a)||a<0||a===r?e.d():a}var c={},g={},b={},f={},r=1/0;e.Cache=new ovi.Class({initialize:function(a,b,c,f){this.fc=d(a);if(b)this.ie=b;if(c)this.Oe=c;if(f)this.Y=f;this.s={}},Statics:{DONT:c,NEXT:g,NOT_ENOUGH_SPACE:f,change:h},f:0,change:h,add:function(a,e,k){var h=this.ie,p=this.Y,r=this.s,s=r[a],u;if(h){if((h=h(e))===
g)return s&&this.remove(a,1),p?p.add(a,e,k):g;if(h===c)return s&&this.remove(a),c;h===b?(e=h.J,k=h.f):e=h}if((k=d(k))>this.fc)return p?p.add(a,e,k):f;if(s)this.f+=k-s.f,s.J=e,s.f=k,this.gc(s);else{s=r[a]=this.W=new l(a,e,this.W,k);if(!this.ga)this.ga=s;this.f+=k}for(;this.f>this.fc;)this.S((u=this.ga).c,u),p&&p.add(u.c,u.J,u.f)},get:function(a,b){var c=this.s[a],d;c&&(b||this.gc(c));return c?c.J:(d=this.Y)?d.get(a,b):void 0},remove:function(a,b){var c=this.s[a],d,f;c&&this.S(a,c);if(!b&&(d=this.Y))f=
d.remove(a,b);return c?c.J:f},removeAll:function(a){var b=this.s,c,d;for(c in b)b.hasOwnProperty(c)&&!c.indexOf(a)&&this.S(c,b[c]);(d=this.Y)&&d.removeAll(a)},destroy:function(){var a=this.s,b,c;for(c in a)(b=a[c]).X=0,b.Z=0;this.ga=this.W=0;this.Y&&this.Y.destroy()},S:function(a,b,c){var d=b.Z,f=b.X,e;d?f?(d.X=f).Z=d:(this.ga=d).X=void 0:(this.W=f)?f.Z=void 0:this.ga=void 0;if(!c)delete this.s[a],this.f-=b.f,(e=this.Oe)&&e(b.J);return b.J},gc:function(a){var b=this.W;if((b=this.W)!==a){this.S(a.c,
a,1);if(b)(b.Z=a).X=b;(this.W=a).Z=void 0}}});l.prototype.f=1})(nokia.maps.util);ovi.provide("nokia.maps.map.provider.IData");ovi.provide("nokia.maps.map.provider.IObjectProvider");ovi.provide("nokia.maps.util.Arrows");
(function(e){var l=nokia.maps.gfx.Color,h={color:1,width:1,length:1,frequency:1};e.Arrows=new ovi.Class({width:1.2,length:1.6,frequency:5,color:"#FFFC",initialize:function(d){var c,g,b=e.d;if(typeof d==="object")for(c in h)h.hasOwnProperty(c)&&c in d&&(g=d[c],c==="color"?l.parseCss(g)===null&&b(c):g<=0&&b(c),this[c]=d[c])}})})(nokia.maps.util);ovi.provide("nokia.maps.map.provider.Tile");
(function(){var e=nokia.maps,l=e.dom.importNode,h=e.dom.cloneNode;ovi.extend((nokia.maps.map.provider.Tile=function(d,c,e){this.id=d;if(c)(this.data=c).style.position="absolute";this.Xi=(this.e=e)?e.getInvalidationMark():void 0}).prototype,{Xi:-1/0,Pk:1,state:void 0,getInvalidations:function(d){return this.e.getInvalidations(this,d)},getNode:function(d){var c=this.data,e;return c&&(d&&d!==document&&l(d,c,1)||(e=c.parentNode)&&e.nodeType!==11&&h(c,1)||c)}})})();ovi.provide("nokia.maps.map.render.p2d.Animation");
(function(e){var l=e.util,h=l.requestAnimationFrame,d=l.cancelAnimationFrame,c=e.util.now;e.map.render.p2d.Animation=ovi.Class({initialize:function(c,b,d,e){this.duration=e||300;this.Fw=c;this.Yq=b;if(typeof d==="function")this.nm=d;this.isRunning=!1},start:function(){function d(){var e=c(),a=e-b.be,l=a/b.duration,l=l>1?1:l;b.nm&&(l=b.nm(l));b.Fw(l,a,e-f,e);f=e;l>=1?b.stop():b.pp=h(d)}var b=this,f;b.be=c();f=b.be;b.isRunning=!0;b.pp=h(d)},stop:function(c){d(this.pp);this.isRunning=!1;c||this.Yq&&
this.Yq()}})})(nokia.maps);ovi.provide("nokia.maps.map.render.Preloader");
nokia.maps.map.render.Preloader=new ovi.Class({initialize:function(e,l){this.ya=ovi.bind(this,this.ya);this.yr=e;this.cr=l;this.sw=setTimeout(ovi.bind(this,this.Hd));this.Dn={};this.Sn=[]},total:0,past:0,Hd:function(){for(var e=this.yr,l=e.length,h=0,d,c,g,b,f,r,a=0,q=0,k=this.Dn,m;h<l;++h){this.Sn.push(c=e[h]);providers.addListener("response",this.ya);d=e[++h];f=e[++h];g=c.request;b=c.createId;argsLength=f.length;for(r=0;r<argsLength;)++a,g.apply(c,m=f.slice(r,r+=d))===TRUE?k[b.apply(c,m)]=1:++q}this.yr=
0;this.state=1;this.total=a;this.past=q;this.cr()},ya:function(e){var e=e.data[0],l=this.Dn;if(l[e]){l[e]=0;if(++this.past===this.total)this.Dn=0;this.cr()}},vx:function(){for(var e=that.Sn.length;e--;)that.Sn[e].removeListener("response",that.ya)},state:0,cancel:function(){clearTimeout(this.sw)}});ovi.provide("nokia.maps.map.render.InteractionRecorder");
(function(e){var l=e.util.Vector3D;e.map.render.InteractionRecorder=new ovi.Class({initialize:function(e){e=e||{};this.xs=e.toleraceX||3;this.ys=e.toleraceY||3;this.Pq=e.maxSpeed||300;this.Dw=e.timeDelta||300;this.Rp=e.directionTolerance||3;this.reset()},reset:function(){this.Ar=[]},setTollerance:function(e,d){this.xs=e||3;this.ys=d||3},recordXY:function(e,d,c,g,b){e||(e=(new Date).getTime());this.Ar.push({x:d,y:c,bx:g,by:b,time:e})},getRecorded:function(e){var d=this.Ar,c=d.length,g;e||(e=(new Date).getTime());
g=e-this.Dw;if(c===0||c>0&&g>d[c-1].time)return[];for(;c--;)if(e=d[c],e.time<g)return d.slice(c,d.length);return d},Cm:function(e,d){return e.bx===+e.bx&&d.bx===+d.bx?{dx:d.x+(d.bx-d.x)/2-(e.x+(e.bx-e.x)/2),dy:d.y+(d.by-d.y)/2-(e.y+(e.by-e.y)/2)}:{dx:d.x-e.x,dy:d.y-e.y}},getInteractionDirection:function(e){var e=this.getRecorded(e),d=e.length,c=this.Rp>1?this.Rp:2;d>1?(e=this.Cm(e[d-(c>d?d:c)],e[d-1]),e=new l(e.dx,e.dy,0)):e=new l(0,0,0);return e.normalize()},nt:function(e,d){var c=this.Cm(e,d);return Math.abs(c.dx)>
this.xs||Math.abs(c.dy)>this.ys},getInteractionSpeed:function(e){var e=this.getRecorded(e),d=e.length,c=0,c=0,g,b;if(d>1&&this.nt(e[d-1],e[d-2])){c=0;for(b=1;b<d;b++)g=this.Cm(e[b-1],e[b]),c+=Math.sqrt(g.dx*g.dx+g.dy*g.dy);c/=d-1;return c<=this.Pq?c:this.Pq}else return 0}})})(nokia.maps);ovi.provide("nokia.maps.map.render.KineticMove");
(function(e){e.map.render.KineticMove=new ovi.Class({initialize:function(e,h){this.nl=h||0.5;this.Zc=this.yo=0;e&&this.setInitialSpeed(e)},setInitialSpeed:function(e){this.yo=e;this.Zc=this.getDuration()},getValue:function(e){return this.yo+this.nl*e},getPath:function(e){return Math.abs(this.nl*e*e/2)},getDuration:function(){return this.yo/this.nl}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.ILayer");ovi.provide("nokia.maps.map.render.p2d.dom.ImageLayer");
(function(){var e=nokia.maps,l=e.util,h=e.map.render.p2d.dom,d=e.dom,c={state:!1};h.ImageLayer=function(c,b,d,e){this.e=b;this.La=e;this.o=c;this.Yd=b.opacity||1;this.nk=ovi.bind(this,this.nk);this.Wc=c.ownerDocument};h.ImageLayer.prototype={Ec:-1/0,za:e.util.u,shutdown:function(){this.La=l.u;this.nk=e.util.u;this.stop();d.Ob(this.o);return this.o},stop:function(){this.cm&&this.cm.abort()},show:function(){this.Wr("")},hide:function(){this.Wr("none")},Wr:function(c){this.o.style.display=c},render:function(d,
b,f,e,a,h,k,l,p,z,s,u){var b=this.e,e=this.Ec,w;this.bw=h;if(d>=b.min&&d<=b.max){this.pi=f;if(b.getInvalidations(e)&&(this.cm=w=b.request(k,u,this.nk))&&w.state)this.Cq=w,this.Ec=b.getInvalidationMark();(w=this.Cq)&&this.gl(w)}else this.gl(c)},nk:function(c){if(c.state)this.Cq=c;this.cm===c&&this.gl(c)},gl:function(c){var b,f,e,a,h;b=this.o;var k=b.firstChild;e=c.bbox;f=c.data;c=this.Yd;f?(k||(k=this.Wc.createElement("img")),h=this.pi,k.src=f.src,b=h.geoToPixel(e.topLeft).round(),f=h.geoToPixel(e.bottomRight).round(),
a=f.x-b.x,a=e.isCDB?a+h.w:a,h=b.x-h.w,h=b.x<Math.abs(h)?b.x:h,e=k.style,e.position="absolute",e.left=h+"px",e.top=b.y+"px",e.width=a+"px",e.height=f.y-b.y+"px",c!==1&&d.$d(k,c),this.o.appendChild(k)):k&&b.removeChild(k)},capture:function(c,b,d){var e=this.o.childNodes,a;a=this.bw;var h=e.length,k=0;b-=a.x;d-=a.y;c.save();for(c.set("opacity",this.Yd);k<h;k++)a=e[k],c.drawImage(a,0,0,a.naturalWidth||a.width,a.naturalHeight||a.height,a.offsetLeft-b,a.offsetTop-d,parseInt(a.style.width,10),parseInt(a.style.height,
10));c.restore()}}})();ovi.provide("nokia.maps.map.render.p2d.dom.CanvasLayer");
(function(){var e=nokia.maps,l=e.dom,h=e.map.render.p2d.dom;h.CanvasLayer=function(d,c,e){var c=new h.ImageLayer(d,c,0,e),b=d.ownerDocument;c.gl=function(c){var d,a,e,g,h,p=this.o.firstChild;e=c.bbox;d=c.data;c=this.Yd;p?this.o.removeChild(p):p=b.createElement("canvas");if(d)h=this.pi,p.width=d.width,p.height=d.height,p.getContext("2d").drawImage(d,0,0),d=h.geoToPixel(e.topLeft).round(),a=h.geoToPixel(e.bottomRight).round(),g=a.x-d.x,g=e.isCDB?g+h.w:g,h=d.x-h.w,h=d.x<Math.abs(h)?d.x:h,e=p.style,e.position=
"absolute",e.left=h+"px",e.top=d.y+"px",e.width=g+"px",e.height=a.y-d.y+"px",c!==1&&l.$d(p,c),this.o.appendChild(p)};return c}})();ovi.provide("nokia.maps.map.IView");ovi.provide("nokia.maps.map.ICam");ovi.provide("nokia.maps.map._EngineTransition");
(function(e){var l=ovi.extend,h={"2d-3d":void 0,"3d-2d":{},"2d-panorama":{altitude:27.26},"panorama-2d":{altitude:27.26,pitch:0,yaw:0},"3d-panorama":{pitch:0,altitude:20},"panorama-3d":{pitch:0}},d={"2d-3d":{},"3d-2d":void 0,"2d-panorama":{pitch:90},"panorama-2d":{altitude:27.26},"3d-panorama":{pitch:90},"panorama-3d":{pitch:0}};e.map.Ms=new ovi.Class({start:function(){this.inProgress=!0},finish:function(){this.inProgress=!1},getHandoverCam:function(c,d,b){c=h[d+"-"+c];return c===void 0?c:l({},b,
c)},getDestinationCam:function(c,e,b){c=d[e+"-"+c];return c===void 0?c:l({},b,c)}})})(nokia.maps);ovi.provide("nokia.maps.language.Manager");
(function(e){var l=e.util.getRootNameSpace("nokia.maps").Language;e.language.Manager=ovi.Class({translateToken:function(e,d,c){c=c||l.translations;c=c[e];d&&c==null&&ovi.warn("Translation: Cannot translate token: "+e);return c||e},translate:function(h,d,c){var c=c||/__i18n_([a-z\.]*_[a-z0-9]*)__/g,g=this,b=l.translations;return h.replace(c,function(c,h){(h==null||typeof h==="number")&&e.util.d("keyRegexp does not contain a valid token group");return g.translateToken(h,d,b)})}})})(nokia.maps);ovi.provide("nokia.maps.map.HitArea");
(function(){var e=Math,l=e.PI/180,h=e.ceil,d=e.min,c=e.sin,g=e.cos,b=nokia.maps.util,f=b.Point,r=nokia.maps.map.HitArea=new ovi.Class({initialize:function(a,f){var e=(f=[].concat(f)).length,m=e,p,r,s,u,w;this.values=f;for(this.type=a;m--;)isNaN(f[m]=f[m])&&b.d("Given argument is not the array of numbers");a==="rect"&&e>3&&(f=[+f[0],+f[1],+f[2],+f[1],+f[2],+f[3],+f[0],+f[3]],a="poly");if(a==="circle"&&e>2&&(s=+f[2])>0){p=+f[0];r=+f[1];m=d(h(s)*2,40);u=360/m;for(f=[];m--;)w=u*m*l,f.push(p+c(w)*s,r+
g(w)*s);a="poly"}if(a==="poly"&&e&&!(f.length%2))this.lc=f;!this.lc&&b.d("bad polygon")},Statics:{from:function(a){return a instanceof r?a:new r(a.type,a.values?a.values:a.coords)}},hitTest:function(a,b,c){return f.isCoveredBy(a,b,this.lc,c,!0)}})})();ovi.provide("nokia.maps.util.ColorHelper");
(function(e){function l(a){var b;if(a.charAt(0)==="#")b=f[a.length]?a:null;else if(a.substr(0,3)==="rgb"){b=a.match(/\d+(\.\d+)?/g);var c=b.length;b=c>2&&c<5?["#",d(+b[0]),d(+b[1]),d(+b[2]),c>3?d(+b[3]*255):"ff"].join(""):null}b||e.d("Invalid color definition: "+a);return b}function h(a){return!/^(#|rgb).*/.test(a)}function d(a){return a<16?"0"+g(a).toString(16):g(a).toString(16)}function c(a){a=b(a,16);return(a<<4)+a}var g=Math.round,b=parseInt,f={4:function(a){return["#",a.charAt(1),a.charAt(1),
a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),"ff"].join("")},5:function(a){return["#",a.charAt(1),a.charAt(1),a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),a.charAt(4),a.charAt(4)].join("")},7:function(a){return a+"ff"},9:function(a){return a}},r={4:function(a){return[c(a.charAt(1)),c(a.charAt(2)),c(a.charAt(3)),255]},5:function(a){return[c(a.charAt(1)),c(a.charAt(2)),c(a.charAt(3)),c(a.charAt(4))]},7:function(a){a=b(a.substring(1),16);return[a>>16&255,a>>8&255,a&255,255]},9:function(a){a=b(a.substring(1),
16);return[a>>24&255,a>>16&255,a>>8&255,a&255]}};e.ColorHelper={toInternal:function(a){return h(a)?a:(a=l(a),f[a.length]?f[a.length](a):a)},toRGBA:function(a,b){return h(a)?[0,0,0,255]:(b||(a=l(a)),r[a.length](a))},getHex3:function(a,b){return h(a)?a:(b||(a=l(a),a=f[a.length]?f[a.length](a):a),a.substr(0,7))},getAlpha:function(a,c){return h(a)?1:(c||(a=l(a),a=f[a.length]?f[a.length](a):a),b(a.substr(7,2),16)/255)},toRandomRGBA:function(a,b){if(h(a))return"000000ff";else{for(var a=this.toRGBA(a,b),
c=0;c<4;c++)a[c]=""+d(c<3?Math.floor(Math.random()*(a[c]-0+1))+0:a[c]);return a.join("")}}}})(nokia.maps.util);ovi.provide("nokia.maps.map._packaging.components-nokia");ovi.provide("nokia.maps.dom.KeyCodes");
(function(){function e(d,c){for(var e=c.length;e--;)l[c[e]]=d+e}var l={BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,META:91,CONTEXT_MENU:93,CMD_LEFT:91,CMD_RIGHT:93};e(32,["SPACE","PAGE_UP","PAGE_DOWN","END","HOME","LEFT","UP","RIGHT","DOWN"]);e(44,["PRINT_SCREEN","INSERT","DELETE"]);e(48,["ZERO","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE"]);e(96,["NUM_ZERO","NUM_ONE","NUM_TWO","NUM_THREE","NUM_FOUR","NUM_FIVE","NUM_SIX","NUM_SEVEN",
"NUM_EIGHT","NUM_NINE"]);e(112,["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"]);for(var h=65;h<=90;h++)l[String.fromCharCode(h).toUpperCase()]=h;nokia.maps.dom.KeyCodes=l})();ovi.provide("nokia.maps.map.render.Capabilities");
(function(){if(!nokia.maps.util.getConstructor(nokia.maps.map.render.Capabilities))var e=nokia.maps,l={min:0,max:0},h=(e.map.render.Capabilities=function(d){return e.util.proto(d,h,!0,!0)}).prototype={view:{heading:l,tilt:l,incline:l,distance:l,zoom:{min:-1/0,max:1/0}},cam:{fov:{min:70,max:70}},altMode:{GL:!0,OL:!1,SL:!1,SB:!1,WE:!1,WG:!1},provider:{tile:{bmp:!0,gfx:!1,mesh:!1},object:{spatial:!0,marker:!0,decal:!1}},ui:17,capture:!1,ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16,FOV:32,SIZE:64}})();
ovi.provide("nokia.maps.util.EventTarget");
(function(e){var e=e.EventTarget=function(e){var e=e||this,d;if(!e.Gu)for(d in l)d in e||(e[d]=l[d]);return e},l={Gu:!0,addListener:function(e,d){var c=this.Bl||(this.Bl={}),c=c[e]||(c[e]=ovi.Array([]));c.indexOf(d)<0&&c.push(d)},removeListener:function(e,d){var c=this.Bl,g,b;if(c&&(g=c[e]))b=g.indexOf(d),b>=0&&(g.splice(b,1),b<=g.Ia&&--g.Ia),g.length||delete c[e]},dispatch:function(e){var d=this.Bl,c;e.target=this;if(d&&(c=d[e.type])){for(d=0;d<c.length;d++)c.Ia=d,c[d].call(this,e),d=c.Ia;c.Ia=NaN}return!e.defaultPrevented}};
ovi.extend(e.prototype,l)})(nokia.maps.util);ovi.provide("nokia.maps.map.provider.NullObjectProvider");(function(e){e.map.provider.NullObjectProvider=new ovi.Class({zg:function(){},si:function(){},Dc:function(){},requestBBox:function(){return[]},cancelBBoxRequest:function(){},adopt:function(e){if(e.e)return!1;e.e=this;return e},orphan:function(e){if(e.e!==this)return!1;e.e=null;return e}})})(nokia.maps);ovi.provide("nokia.maps.geo.PixelProjection");
(function(e){var l=e.util,h=l.Point,d=l.d,e=e.geo.PixelProjection=function(c,e,b,f,h){(this.p=c)&&(this.w=+e)>0&&(this.h=+b)>0||d();if(f)this.x=+f;if(h)this.y=+h};ovi.extend(e.prototype,{x:0,y:0,geoToPixel:function(c){c=this.p.latLngToPoint(c.latitude,c.longitude);return new h(c.x*this.w-this.x,c.y*this.h-this.y)},latLngToPixel:function(c,d){var b=this.p.latLngToPoint(c,d);return new h(b.x*this.w-this.x,b.y*this.h-this.y)},pointToPixel:function(c){return new h(c.x*this.w-this.x,c.y*this.h-this.y)},
xyToPixel:function(c,d){return new h(c*this.w-this.x,d*this.h-this.y)},pixelToPoint:function(c){return new h((c.x+this.x)/this.w,(c.y+this.y)/this.h)},xyToPoint:function(c,d){return new h((c+this.x)/this.w,(d+this.y)/this.h)},pixelToGeo:function(c){return this.p.xyToGeo((c.x+this.x)/this.w,(c.y+this.y)/this.h)},xyToGeo:function(c,d){return this.p.xyToGeo((c+this.x)/this.w,(d+this.y)/this.h)}})})(nokia.maps);ovi.provide("nokia.maps.map.component.KeyControl");
(function(e){function l(){this.values={}}function h(b,c,d,a,e,g,h,l){this.Iu=b;this.Tq=c;this.Uq=d;this.Vq=a;this.Or=e;this.Pr=g;this.Qr=h;this.Ks=l}var d=e.map.component,c=e.dom.KeyCodes,g={duration:function(){return 600},power:function(){return 0.35},ease:e.util.animation.easeFunctions.EASE_OUT_CIRC};h.prototype={applies:function(b){var d=this.Iu,e=d&1024,a=d&2048,g=d&4096,k=d&8192;(d=b[d-(e?1024:0)+(a?2048:0)+(g?4096:0)+(k?8192:0)])&&(d=e&&b[c.SHIFT]||!e&&!b[c.SHIFT]);d&&(d=a&&b[c.CTRL]||!a&&!b[c.CTRL]);
d&&(d=g&&b[c.ALT]||!g&&!b[c.ALT]);d&&(d=k&&b[c.META]||!k&&!b[c.META]);return d}};l.prototype={add:function(b,c,d,a,e,g,l,p){this.values[b]=new h(b,c,d,a,e,g,l,p)},isMapped:function(b){var c=this.values,d;for(d in c)if(c.hasOwnProperty(d)&&d&b)return!0},remove:function(b){delete this.values[b]},query:function(b){var c=[],d=this.values,a;for(a in d)d[a].applies(b)&&c.push(d[a]);return c}};l.MOD_SHIFT=1024;l.MOD_ALT=1024;l.MOD_CTRL=1024;l.MOD_META=8192;d.KeyControl=new ovi.Class({c:"KeyControl",n:"0.0.0.1",
Extends:d.Component,Statics:{CAM_KEYMAP:function(){var b=new l;b.add(c.UP,0,0,0,-0.015);b.add(c.DOWN,0,0,0,0.015);b.add(c.LEFT,0,0,0,0,0.015);b.add(c.RIGHT,0,0,0,0,-0.015);b.add(1024|c.RIGHT,0,0,0,0,-0.015);b.add(1024|c.LEFT,0,0,0,0,0.015);b.add(1024|c.UP,0,0,0,-0.015);b.add(1024|c.DOWN,0,0,0,0.015);b.add(107,0,0,0,0,0,0,0.02);b.add(109,0,0,0,0,0,0,-0.02);b.add(187,0,0,0,0,0,0,0.02);b.add(189,0,0,0,0,0,0,-0.02);b.add(171,0,0,0,0,0,0,0.02);b.add(173,0,0,0,0,0,0,-0.02);return b}(),VIEW_KEYMAP:function(){var b=
new l;b.add(c.UP,0,0.002);b.add(c.DOWN,0,-0.002);b.add(c.LEFT,-0.002);b.add(c.RIGHT,0.002);b.add(107,0,0,0.001);b.add(109,0,0,-0.001);b.add(187,0,0,0.001);b.add(189,0,0,-0.001);b.add(171,0,0,0.001);b.add(173,0,0,-0.001);b.add(1024|c.RIGHT,0,0,0,0,0.015);b.add(1024|c.LEFT,0,0,0,0,-0.015);b.add(1024|c.UP,0,0,0,0.015);b.add(1024|c.DOWN,0,0,0,-0.015);return b}(),KeyMap:l},initialize:function(){this.Uj=ovi.bind(this,this.Uj);this.Vj=ovi.bind(this,this.Vj);this.tf=ovi.bind(this,this.tf);this.eb=ovi.bind(this,
this.eb);this.vl=ovi.bind(this,this.vl);this.cn=0;this.kt=d.KeyControl.CAM_KEYMAP;this.Rw=d.KeyControl.VIEW_KEYMAP;this.rf=null;this.oo("view");this.qe={}},attach:function(b){this._super(b);b.addListener("keydown",this.Uj);b.addListener("keyup",this.Vj);b.addListener("blur",this.tf);b.addListener("focus",this.tf);b.addListener("dragstart",this.eb)},detach:function(b){b.removeListener("keydown",this.Uj);b.removeListener("keyup",this.Vj);b.removeListener("blur",this.tf);b.removeListener("focus",this.tf);
b.removeListener("dragstart",this.eb);this._super(b)},oo:function(b){this.Ct=b;switch(b){case "cam":this.rf=this.kt;break;case "view":this.rf=this.Rw}},yl:function(b,c){b.zoom=c?Math.ceil(b.zoom):Math.floor(b.zoom);b.distance=void 0;return b},vl:function(b,c){return this.yl(ovi.extend({},c),c.zoom-b.zoom>0)},Ss:function(){return!1},Up:function(b){var c=b.length,d=c,a,e,k,h,l,z,s,u;for(e=k=h=l=z=s=u=0;c--;)a=b[c],e===0&&(e=a.Tq?a.Tq:0),k===0&&(k=a.Uq?a.Uq:0),h===0&&(h=a.Vq?a.Vq:0),l===0&&(l=a.Or?a.Or:
0),z===0&&(z=a.Pr?a.Pr:0),s===0&&(s=a.Qr?a.Qr:0),u===0&&(u=a.Ks?a.Ks:0);d?(this.cn||this.mapDisplay.beginControl(this.Ct,g),this.mapDisplay.control(null,e,k,h,l,z,s,h?0:u)):this.cn&&this.mapDisplay.endControl(this.vl);this.cn=d},Iv:function(b){var c;this.rf.isMapped(b)&&!this.qe[b]&&(this.qe[b]=1,c=this.rf.query(this.qe),this.Up(c));return c?c.length:0},Dr:function(b){var c;this.rf.isMapped(b)&&this.qe[b]&&(delete this.qe[b],c=this.rf.query(this.qe),this.Up(c));return c?c.length:0},Uj:function(b){var c=
b.nativeEvent;this.Iv(c.keyCode||c.which)&&b.preventDefault()},Vj:function(b){b=b.nativeEvent;this.Dr(b.keyCode||b.which)},tf:function(){var b=this.qe,c;for(c in b)this.Dr(b[c])},eb:function(){this.mapDisplay.endControl(this.Ss)},isCompatible:function(){this.mapDisplay.baseMapType===nokia.maps.map.Display.PANORAMA?this.oo("cam"):this.oo("view");return!0}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.capabilities");var oc=nokia.maps,pc=oc.map.render,qc=oc.dom.Page.browser;
pc.p2d.capabilities=pc.Capabilities({view:{distance:{max:1/0},zoom:{min:-8,max:22}},cam:{fov:{min:70,max:70}},provider:{tile:{gfx:!0}},capture:(!qc.msie||qc.version>=9)&&!qc.webkit});ovi.provide("nokia.maps.map.provider.Provider");
(function(){var e=0,l=Math,h=l.min,d=l.max,c=[],g=nokia.maps.util.Event;nokia.maps.map.provider.Provider=new ovi.Class({methodsToBind:[],staticsToBind:[],Extends:nokia.maps.util.EventTarget,initialize:function(b){var c=this;ovi.extend(c,b);if(b&&"strictUpdate"in b&&!("strictInvalid"in b))c.strictInvalid=c.strictUpdate;c.id=e++;c.max=h(c.max,30);c.min=d(c.min,0);b=d(0,c.updateCycle);if(b>0)c.Jw=setInterval(function(){c.To()},b*1E3);c.bb={};c.Hw=function(){c.To();c.Gs=0};c.ct()},pType:1,min:0,max:-1,
label:"",description:"",strictUpdate:!1,strictInvalid:!1,tb:Math.pow(-2,53),providesLevel:function(b){return b>=this.min&&b<=this.max},getInvalidationMark:function(){return this.tb},update:function(){this.Gs||(this.Gs=setTimeout(this.Hw,0))},To:function(){++this.tb;this.dispatch(new g("update"))},getCopyrights:function(){return c},shutdown:function(){clearInterval(this.Jw);delete this.fx},bt:function(b){for(var c=this.methodsToBind,d=c.length;d--;)this[c[d]]=ovi.bind(b,b[c[d]])},ct:function(){for(var b=
this,c=b.staticsToBind,d=c.length;d--;)b[c[d]]=function(a){return function(){var d=b.hx();return d[c[a]].apply(d,arguments)}}(d)}})})();ovi.provide("nokia.maps.map.provider.RemoteObjectProvider");
(function(e){(function(){var l;ovi.extend((l=function(e){this.Xq=e}).prototype,{getBBox:function(){return this.Xq.getBoundingBox()},getObject:function(){return this.Xq},cancel:e.util.u});return l})();e.map.provider.RemoteObjectProvider=new ovi.Class({Extends:e.map.provider.Provider,initialize:function(e){this._super(e)},requestBBox:function(){},cancelBBoxRequest:function(){}})})(nokia.maps);ovi.provide("nokia.maps.map.provider.BitmapProvider");
nokia.maps.map.provider.BitmapProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,request:function(e,l,h){var d=this,c,g=this.getBoundingBox();if(g.intersects(e))return e=this.getId(),this.cache&&(c=this.cache.get(e)),c===void 0&&!l&&(c=this.create(e,g,l)),l||c.send(function(b){d.cache&&b.state!==void 0&&d.cache.add(b.id,b);h(b)}),c},getInvalidations:function(e){return(e<this.getInvalidationMark())*1}});ovi.provide("nokia.maps.map.provider.CanvasProvider");
(function(){function e(e,d,c){this.id=e;this.bbox=d;this.provider=c}var l;ovi.extend(e.prototype,{send:function(e){var d=this;this.data=l=l||document.createElement("canvas");this.provider.draw(this.data,function(c,g){d.state=g;d.data=c;e(d)})},abort:function(){}});nokia.maps.map.provider.CanvasProvider=new ovi.Class({Extends:nokia.maps.map.provider.BitmapProvider,initialize:function(e){this._super(e)},create:function(h,d){return new e(h,d,this)},getId:function(){return this.id},getInvalidations:function(e){return(e<
this.getInvalidationMark())*1}});nokia.maps.map.provider.CanvasProvider.Request=e})();ovi.provide("nokia.maps.map.overlay.ObjectProvider");nokia.maps.map.overlay.ObjectProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,Mixins:[nokia.maps.util.OObject],readyObjects:null,cache:nokia.maps.util.u,finishRequest:function(e,l){l&&(this.notify(e),this.cache(e))},notify:function(e){this.set("readyObjects",e)}});ovi.provide("nokia.maps.map.DisplayContainer");
(function(){var e=nokia.maps,l=e.dom,h=ovi.Array.indexOf,d=e.util;nokia.maps.map.DisplayContainer=new ovi.Class({initialize:function(c,e){function b(a){if(r.enabled){var b=u.getClientRect(p),d=+a.pageX,e=+a.pageY,f,g,k=a.type,l=a.dataTransfer,m,s=null;m=null;var z=E,y=-1;if(c.width!==c.da.offsetWidth||c.height!==c.da.offsetHeight)c.cg(c.da.offsetWidth,c.da.offsetHeight),(a.type=="resizestart"||a.type=="resize")&&c.nw(16);a.display=c;if(!x[k]&&d===d&&e===e&&(a.displayX=f=d-b.left,a.displayY=g=e-b.top,
k!=="drag"&&k!=="drop"&&k!=="dragend"&&k!=="dragleave"&&k!=="gesturestart"&&k!=="gesturechange"&&k!=="gestureend"))a.displayObjects=s=c.getObjectsAt(a.displayX,a.displayY);m=s&&s.length>0&&s[0]||c;if(k==="dragstart"){for(m=L(m);m&&m.length;){if(m[0]&&m[0].isDraggable)break;m.shift()}C=m=m&&m[0]||c;D=!1}else if(k==="drag")m=C;else if(l&&(k==="dragenter"||k==="dragover"||k==="dragleave")){k==="dragleave"&&(m=null);A!==m&&(k=new q({type:"dragleave",target:A,relatedTarget:C,pageX:d,pageY:e,display:c,
displayX:f,displayY:g,dataTransfer:l}),I(A,k),A=null,D=!1);if(!A&&m)k=new q({type:"dragenter",target:A=m,relatedTarget:C,pageX:d,pageY:e,display:c,displayX:f,displayY:g,dataTransfer:l}),I(A,k),D=k.defaultPrevented;D?(k=new q({type:"dragover",target:A,relatedTarget:C,pageX:d,pageY:e,display:c,displayX:f,displayY:g,dataTransfer:l}),I(A,k)):l.dropEffect="none";a.cancel();return}else if(k==="drop"){A&&D?(k=a.clone(),k.target=A,I(A,k)):l.dropEffect="none";a.cancel();return}else if(k==="dragend")a.target=
m=C,C=A=null,D=!1;else if(v[k]){if(x[k]||E&&E!==m)d=a.clone(),d.type="mouseout",d.target=E,d.relatedTarget=x[k]?a.relatedTarget:m,I(E,d),E=null;for(;++y<O.length;)if((!s||h(s,O[y])<0)&&(O[y]!==c||x[k]))d=a.clone(),d.type="mouseleave",d.target=O[y],delete d.relatedTarget,I(d.target,d),O.splice(y--,1);if(!x[k]&&!E){if(h(O,m)<0)d=a.clone(),d.type="mouseenter",d.target=m,delete d.relatedTarget,I(m,d),O.push(m);d=a.clone();d.type="mouseover";d.target=E=m;d.relatedTarget=w[k]?a.relatedTarget:z;I(E,d)}}if(!x[k]&&
!w[k])a.target=m,I(m,a,"isRemote"in m&&m.isRemote?[c]:void 0)}}function f(a,b,c){return(b in y?k:p)[a+"Listener"](b,c,void 0)}var r=this,a=l.EventTarget,q=l.Event,k=a(l.pb(e,"div")),m=l.pb(k,"div"),p=a(l.pb(m,"div")).enableDrag(),z=l.pb(k,"div"),s=l.pb(m,"div"),c=a(c).enableDrag(),u=r.Rn=l.Page(p),w={mouseover:!0,mouseenter:!0},x={mouseout:!0,mouseleave:!0,blur:!0},v={mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseenter:!0,mouseleave:!0},y={keydown:!0,keyup:!0,focus:!0,blur:!0},
B={dragstart:!0,drag:!0,dragenter:!0,dragover:!0,drop:!0,dragleave:!0,dragend:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mouseup:!0,keydown:!0,keyup:!0,focus:!0,blur:!0,tap:!0,dbltap:!0,click:!0,dblclick:!0,longpress:!0,wheel:!0,contextmenu:!0,resizestart:!0,resize:!0,resizeend:!0,beforeunload:!0,touchstart:!0,touchmove:!0,touchend:!0},C,A,D,E=null,O=[],I=a.dispatchEvent,L=a.getDispatchPath,N;r.doc=e.ownerDocument;r.t=e;r.enabled=!0;k.tabIndex=0;(r.da=k).style.cssText+="position:relative;width:100%;height:100%;overflow:hidden;outline:none;";
c.Zd("width",k.offsetWidth);c.Zd("height",k.offsetHeight);(r.Zf=p).style.cssText+="position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;";if(ovi.browser.msie)p.style.backgroundColor="white",nokia.maps.dom.$d(p,0);(r.tj=m).style.cssText+="position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;";(r.T=z).style.cssText+="z-index:0;";r.So=l.Page(z);r.rb=s;for(N in B)f("add",N,b);r.addEvent=function(a){B[a]=!0;return f("add",a,b)};r.removeEvent=function(a){delete B[a];return f("remove",
a,b)};r.containerDestroy=function(){var a=this,c;for(c in B)f("remove",c,b);try{e.removeChild(k)}catch(h){}setTimeout(function(){for(var b in a)a[b]=typeof a[b]=="function"?d.u:null},0)}}})})();ovi.provide("nokia.maps.map.js.copyrights");ovi.provide("nokia.maps.resources.copyrights.json");nokia.maps.resources.copyrights.json='/*\n * Fetched 2010-11-08 from\n * http://maptile.maps.svc.ovi.com/maptiler/v2/copyright/newest?referer=&token=&output=xml&callback_func=BAR&callback_id=FOO\n *\n * Manually correction by Thomas Fischer:\n * - add missing default copyrights (whole world, level 0-20) for "normal" and "hybrid"\n * - fix wrong label for Chineese "normal" map from "NAVTEQ 2010" into "NavInfo 2010"\n * - changed all "2010" to "2011"\n *\n * Update by Michal Aichinger\n * - changed all "2011" to "2012"\n * \n * - change all "2012" to "2013"\n * - all labels should be in form "@ year company", not "@ company year"\n * - replace all Navteq by Nokia\n * - fixed hybrid copyright to not repeat Nokia for zoom levels 9 - 20, hybrid is copyrighted to Nokia and DigitaGlobe in whole space.  \n *\n * Update by Radek\n * - adding C3 Technologies for globe\n * - adding INEGI to terrain since it is in fact terrain hybrid\n * - currently we are loading copyrights from http://maps.nlp.nokia.com/maptile/2.1/copyright/newest and we use this one to updated missing features (or as fallback)\n * \n * Update by J\u00f6rg\n * - changing default copyright to 1987 - 2013 HERE\n * \n * Update by Tomas T.\n * - updating 2013 to 2014\n */\n\n{\n\t"panorama": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 22,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 2014 Nokia All Rights Reserved"\n\t\t}\n\t],\n\t\n\t"globe": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 22,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 2014 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 22,\n\t\t\t"label": "2014 DigitalGlobe",\n\t\t\t"alt": "copyright 2014 DigitalGlobe, Inc."\n\t\t}\n\t],\n\t\n\t"normal": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 1987 - 2014 HERE All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 8,\n\t\t\t"label": "2014 INEGI",\n\t\t\t"alt": "copyright 2014 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t}\n\t],\n\t"satellite": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 1987 - 2014 HERE All Rights Reserved"\n\t\t}\n\t],\n\t"hybrid": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 1987 - 2014 HERE All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 8,\n\t\t\t"label": "2014 INEGI",\n\t\t\t"alt": "copyright 2014 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t}\n\t],\n\t"terrain": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 1987 - 2014 HERE All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "SRTM V4, 2014, CIAT",\n\t\t\t"alt": "SRTM V4, 2014, CIAT"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 8,\n\t\t\t"label": "2014 INEGI",\n\t\t\t"alt": "copyright 2014 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t}\n\t]\n}';
(function(){function e(b,c){h(c,function(c,d){a[c]||(a[c]={});b[c]||(b[c]=[]);a[c][d.label]||b[c].unshift(d)})}function l(a,b){var c=b.boxes,d,e;if(c instanceof Array)for(d=c.length;d--;)e=c[d],c[d]=new r([e[2],e[1]],[e[0],e[3]],!0)}function h(a,b){var c,d;for(c in a)if(a.hasOwnProperty(c))for(d=a[c].length;d--;)b(c,a[c][d])}var d=nokia.maps,c=d.Config,g=d.net.Request,b=d.util.getRootNameSpace("nokia.maps").Settings,f=nokia.maps.util.services,r=d.geo.BoundingBox,a={},q=d.resources.copyrights=eval("("+
nokia.maps.resources.copyrights.json+")")||{},k=c.getDefault("copyrights"),d=new ovi.Class({Extends:d.util.OObject,initialize:function(){h(q,l);this.set("copyrights",q);this.onCopyrightLoaded=ovi.bind(this,this.onCopyrightLoaded);this.lo={}},loadCopyright:function(a){var d,e;e=b.serviceMode;d=c.getDefault("secureConnection");a=a||"base";!this.lo[a]&&k&&(d=d==="force"||d==="prefer"?k.replace("http://","https://"):k,d=d.replace("{serviceMode}",e?"."+e:""),d=d.replace("{service}",a),d=f.addNlpParams(d),
e=new g(g.JSONP,{callbackKey:"callback_func",standardJSONP:!0}),e.send(d,this.onCopyrightLoaded),this.lo[a]=!0)},onCopyrightLoaded:function(b){!b.error&&b.response&&(b=ovi.json.parse(b.response),a={},h(b,function(b,c){l(0,c);a[b]||(a[b]={});a[b][c.label]=!0}),e(b,q),q=b,this.set("copyrights",b))},get:function(a,b,c){var d=[],e=this.copyrights,f,g,k,h;switch(a){case "terrain":case "satellite":case "hybrid":f="aerial";break;case "traffic":f="traffic";break;default:f="base"}this.lo[f]||this.loadCopyright(f);
if(a=e[a])for(g=a.length;g--;)if(e=a[g],c>=e.minLevel&&c<=e.maxLevel){if(f=e.boxes){h=0;for(k=f.length;k--;)if(f[k].intersects(b)){h=1;break}}else h=1;h&&d.unshift({label:e.label,alt:e.alt})}return d}});nokia.maps.map.js.copyrights=new d})();ovi.provide("nokia.maps.css");
(function(e){var l=e.css,h=e.dom.Page.browser,d=e.dom.Page.platform,d=d.ipad||d.iphone||d.ipod,c=h.gecko?"Moz":h.opera?"O":h.msie?"ms":h.webkit?"Webkit":null,d=2*(h.msie&&h.version>=12||h.gecko&&h.version>=10||d||h.safari)|1*!(h.msie&&h.version<10||h.gecko&&h.version<=4),g={};ovi.extend(l,{transformType:d,Pw:c,$o:c?"-"+c.toLowerCase()+"-":"",Cs:c==="O"?"oTransitionEnd":c==="Webkit"?"webkitTransitionEnd":c==="MS"?"MSTransitionEnd":"transitionend",getVendorJsProperty:function(b){return g[b]||(g[b]=
c+b.substr(0,1).toUpperCase()+b.substr(1))},css3Style:function(b,d,e){b=b.style;b[d]=e;c&&(b[this.getVendorJsProperty(d)]=e)},cssTransform:function(b,c){this.css3Style(b,"transform",c)},cssTransformOrigin:function(b,c){this.css3Style(b,"transformOrigin",c)},cssTransformStyle:function(b,c){this.css3Style(b,"transformStyle",c)},cssBackfaceVisibility:function(b,c){this.css3Style(b,"backfaceVisibility",c)},supportsTransition:function(){return!h.msie||h.version>=10},applyMatrix:d&2?function(b,c){var d=
c.rows,a=d[0],e=d[1],d=d[2];b.style[l.getVendorJsProperty("transform")]="matrix3d("+a[0]+","+e[0]+","+d[0]+",0,"+a[1]+","+e[1]+","+d[1]+",0,"+a[2]+","+e[2]+","+d[2]+",0,"+a[3]+","+e[3]+","+d[3]+",1)"}:d&1?function(b,c){var d=c.rows,a=d[0],d=d[1];b.style[l.getVendorJsProperty("transform")]="matrix("+a[0]+","+d[0]+","+a[1]+","+d[1]+","+a[3]+","+d[3]+")"}:function(b,c){var d=c.rows,a=b.style;a.top=d[1][3]+"px";a.left=d[0][3]+"px"},translateXYElement:d&2?function(b,c,d){b.style[l.getVendorJsProperty("transform")]=
"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+c+","+d+",0,1)"}:d&1?function(b,c,d){b.style[l.getVendorJsProperty("transform")]="matrix(1,0,0,1,"+c+","+d+")"}:function(b,c,d){b=b.style;b.top=d+"px";b.left=c+"px"},transformElement:d?function(b,c,d,a,g,k){var h=new e.util.Matrix3D,h=h.translate(c,d,0);a&&(h=h.rotateZ(a));g!==void 0&&g!==1&&(h=h.scale(g,k!==void 0?k:g,1));l.applyMatrix(b,h)}:function(b,c,d){b=b.style;b.left=c+"px";b.top=d+"px"}})})(nokia.maps);ovi.provide("nokia.maps.map.Object");
(function(e){if(!e.util.getConstructor(e.map.Object)){var l=0,h=0,d=function(c,b){var d=c.Ua(),e=b.Ua(),a,l,k,m=0,p;if(!d||!e)return 0;a=d.length;l=e.length;for(k=a<l?a:l;m<k;m++)if(p=e[m]-d[m])return h?-p:p;return h?a-l:l-a},c={rev:0,sort:function(c,b,e){var l=[],a,q,k=c.length;for(q=0;q<k;q++)((a=c[q]).getIconForRendering||a.drawToTile)&&(b||a.isVisible())&&l.push(a);h=e;l.sort(d);return l},create:function(c){var b=c.t,d;d=null;b&&(d=(d=b.Ua())?d.slice():[],d.push(c.zIndex,b.objects.indexOf(c)));
return d}};nokia.maps.map.Object=new ovi.Class({Extends:e.util.OObject,Mixins:e.dom.EventTarget,Statics:{sortByZInfo:c.sort,CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4},dispatch:function(c){c.display=this.getDisplay();return e.dom.EventTarget.prototype.dispatch.call(this,c)},initialize:function(c){this.e=new e.map.provider.NullObjectProvider;this.id=l++;c&&"draggable"in c?(c.isDraggable=c.draggable,delete c.draggable,this._super(c),c.draggable=c.isDraggable,delete c.isDraggable):this._super(c);
this.addObserver("*",this.nc,this)},t:null,CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4,isEventTarget:!0,zIndex:0,visibility:!0,B:"object",ad:function(){return this.ac||(this.ac={})},destroy:function(){var c=this.t;c&&c.objects.remove(this);this.removeAllListeners();this.e=null;this.removeObserver("*",this.nc,this)},getInvalidations:function(c){var b=this.ac;return b?(b[1]>c)*1|(b[2]>c)*2|(b[4]>c)*4:0},nc:function(c,b){this.ja(b,0)},getProvider:function(){return this.e},getParent:function(){return this.t},
getRoot:function(){for(var c=this,b;b=c.t;)c=b;return c},getDisplay:function(){var c=this.getRoot();return c.B==="display"?c:null},isVisible:function(){var c=this,b=!1;do b=c.visibility;while(b&&(c=c.t));return b},ja:function(c,b){var d;d=this.e;var e;b|=c==="zIndex"?4:c==="visibility"?2:0;e=d.Dc(this,b);d=this.ad();b&1&&(d[1]=e);b&2&&(d[2]=e);b&4&&(d[4]=e)},zIndexSetter:function(c){this.bc();return c},eventListenerSetter:function(c){var b=0,d,e;if(c)for(e in this.removeAllListeners(),c)if((b=ovi.type(d=
c[e]))==="array")for(b=0;b<d.length;b+=3)this.addListenerNS(d[b+2],e,d[b],d[b+1]);else b==="function"&&this.addListenerNS(null,e,d,!1)},Ua:function(){var d;if(!(d=this.Bc))d=this.Bc=c.create(this);return d},bc:function(){this.Bc=void 0},adopt:function(c){return c.adopt(this)},orphan:function(){return this.e.orphan(this)}})}})(nokia.maps);ovi.provide("nokia.maps.map.Container");
(function(){var e=nokia.maps.map,l=nokia.maps.util,h=l.d,d=new ovi.Class({Extends:e.Object,initialize:function(c,d){c&&!c.length&&(d=c,c=void 0);var b=this,e=b.objects=new l.OList;e.tv=e.N;e.N=function(c,a,d){c===b&&h();var g=c.e,l=c.t;l&&l.objects.remove(c);if(c.orphan()&&c.adopt(b.e))return c.bc(),e.tv(c,a,d);l&&l.objects.add(c);c.e=g;h()};e.uv=e.oc;e.oc=function(b,a){e.get(b);return this.uv(b,a)};e.addObserver(b.At,b);b._super(d);c&&e.addAll(c)},B:"container",objectsSetter:function(c){this.objects.clear();
return this.objects.addAll(c)},At:function(c,d,b,e){var h=this.e,c=c.ia.length;d==="add"?(b.t=this,this.lq(b)&&this.Oj(h.zg,b,[]),e!==c-1&&this.Qm(e+1)):(this.lq(b)&&this.Oj(h.si,b,[]),b.t=null,b.bc(),e!==c&&this.Qm(e))},Oj:function(c,d,b){var e,h;if(this.zq(d)){d=d.objects;for(h=d.getLength();h--;)e=d.get(h),e=this.zq(e)?e.Oj(c,e,b):c.apply(this.e,[e].concat(b))}else e=c.apply(this.e,[d].concat(b));return e},zq:function(c){return c instanceof d},lq:function(c){for(var d=this.e.Tv;c=c.t;)if(c===d)return!0;
return!1},getBoundingBox:function(){for(var c=this.objects,d=c.getLength(),b,e=null;d--;)if(b=c.get(d).getBoundingBox())e=!e?b:e.merge(b);return e},ja:function(c,d){d|=c==="zIndex"?4:c==="visibility"?2:0;d&&this.Oj(this.e.Dc,this,[d])},Qm:function(c){for(var d=this.objects.ia,b=d.length;c<b;)d[c++].bc()},bc:function(){this._super();this.Qm(0)},contains:function(c){for(var d=!1;c&&!(d=c===this);)c=c.t;return d},orphan:function(){for(var c=this.objects,d=c.getLength();d--;)c.get(d).orphan();return this._super()},
adopt:function(c){for(var d=this.objects,b=d.getLength();b--;)d.get(b).adopt(c);return this._super(c)}});if(e.Container.isNs)e.Container=d})();ovi.provide("nokia.maps.map.provider.ImageProvider");
(function(){function e(e,d,c){this.id=e;this.provider=c;this.bbox=d}var l=nokia.maps.dom.imgLoader;ovi.extend(e.prototype,{send:function(e){var d=this;this.state=l.request(this.data=new Image,this.id,function(c,g){d.state=g;e(d)})},abort:function(){l.cancel(this.data)}});nokia.maps.map.provider.ImageProvider=new ovi.Class({Extends:nokia.maps.map.provider.BitmapProvider,initialize:function(e){this._super(e)},create:function(h,d){return new e(h,d,this)},getId:function(){return this.getUrl()},getInvalidations:function(e){return(e<
this.getInvalidationMark())*1}});nokia.maps.map.provider.ImageProvider.Request=e})();ovi.provide("nokia.maps.map.render.p2d.TileLayer");
(function(){var e=Math,l=e.abs,h=e.round,d=e.floor,c=e.log,g=e.LN2,b=e.pow;new Image;var e=nokia.maps,f=e.util,r=f.Point,a=f.Nf,q=e.dom,k=e.gfx.Painter.defaultPainter,m=nokia.maps.map.render.p2d.TileLayer=new ovi.Class({initialize:function(a,b,c,d){this.Yd=b.opacity||1;this.o=a;this.e=b;this.La=d;this.F=a.ownerDocument;this.kc={};this.Jc={};this.Kk=0;this.Se=new k;this.Fd=new r(-1,-1);b.addListener("response",this.ya=ovi.bind(this,this.ya))},Statics:{Am:function(a,b){return h(c(b.w/a.width)/g)},fq:function(a,
c,d){isNaN(d)&&(d=m.Am(a,c));return new r(c.w/(b(2,d)*a.width),c.h/(b(2,d)*a.height))},wt:function(b,c,e,f,g,k,q,y,B,C){var A,D,E,O,I,q=[],B=isNaN(B)?m.Am(b,c):h(B);if(b.providesLevel(B)){y=y.sub(f);k=b.uc;C=C||m.fq(b,c,B);c=new r(k.x*C.x,k.y*C.y);if(c.x%1||c.y%1)c=c.round(),C.x=c.x/k.x,C.y=c.y/k.y;c=b.pixelProjections[B];g=new r(g.x*c.w-f.x/C.x,g.y*c.h-f.y/C.y);c=new r(a(g.x,k.x),a(g.y,k.y));g=g.sub(c).round();A=(new r(c.x*-C.x,c.y*-C.y)).sub(f).round();c=(new r(k.x*C.x,k.y*C.y)).round();C=c.divide(2);
e=e.sub(f);f=d(g.y/k.y);for(D=A.y;D<e.y;D+=c.y){E=d(g.x/k.x);for(O=A.x;O<e.x;O+=c.x)(I=b.createId(B,f,E))&&q.push({rg:O,sg:D,c:I,Fc:B,Rr:f,Cp:E++,xr:l(y.x-(O+C.x))+l(y.y-(D+C.y))});f++}}return q}},Ec:-1/0,Fh:-1/0,Gh:-1/0,gd:0,ti:-1,Th:function(){this.La(this,this.bn>0)},za:e.util.u,stop:function(a,b){var c=this.Jc,d,e=this.e;if(this.Kk)for(d in c)c[d]&&(e.cancel(d),this.ya({data:[d]}));this.Jc=a||{};this.Kk=b||0},shutdown:function(){this.La=f.u;this.e.removeListener("response",this.ya);this.kc={};
q.Ob(this.o);this.stop();return this.o},ya:function(){throw Error("_onProviderResponse needs implementation");},zr:function(a,b,c){var d=0,e=a[b]||(d=1,a[b]=[]);c?e.push(c):a[b]=0;return d},Bv:function(a,b){var c=a[b];return c&&(c.length<2?(a[b]=0,c[0]):c.pop())},ju:function(a,b){var c=a[b];return c&&c[0]},Xn:function(a,b){var c=a[b],d;if(c&&a.hasOwnProperty(b)){for(d=c.length;d--;)this.Wn(c[d]);a[b]=0}},Xe:function(a,b,c){this.zr(c,a,b)},pj:function(a,b){b||(b={c:a.c});b.Fc=a.Fc;b.Ab=a.Ab;return b},
rw:function(a,b){return b.xr-a.xr},render:function(a,b,c,d,e,f,g,k,l,q,r,D,E,O){var a=this.e,d=m.fq(a,c,r=isNaN(r)?m.Am(a,c):r),b=m.wt(this.e,c,e,f,b,l,q,E,r,d),c=b.length,I,e=this.kc,l={},q=this.Jc,E={},g=0,k=a.getInvalidationMark(),L,N=0,G=a.strictInvalid,M=this.Yd;this.ti=r;this.Fd.x=h(a.uc.x*d.x);this.Fd.y=h(a.uc.y*d.y);this.kd=f;for(D||b.sort(this.rw);c--;){L=!1;f=b[c];I=f.c;r=this.Bv(e,I);if(!r&&(r=this.ju(l,I)))L=1;if(!r||!L&&a.getInvalidations(r.Ab,this.Ec))if(q[I]?(q[I]=0,d=!0):d=E[I]?!0:
a.request(f.Fc,f.Rr,f.Cp,D),d===!0?(++N,g+=this.zr(E,I,f)):d?(f.Ab=d,f.Ka=this.Lk(d.getNode(this.F)),this.Xe(I,f,l,M)):++N,r&&(G||d!==!0&&(!D||d!==!1)))this.Wn(r),L||this.Xn(e,I),r=0;if(r)L&&(r=this.pj(r)),r.rg=f.rg,r.sg=f.sg,this.Xe(I,r,l,M)}this.Fh=O;if(!D)this.Ec=k,this.Gh=O;this.stop(E,g);for(I in e)this.Xn(e,I);this.kc=l;this.bn=N;D||g||this.Th();return!g&&!N},capture:function(a,b,c){var d=this.kd,e,f;f=this.e;var g=f.width,k=f.height,h=this.kc,l,m;b-=d.x;c-=d.y;a.save();a.set("opacity",f.opacity);
for(e in h){d=h[e];for(l=d.length;l--;)f=d[l],m=f.Ka,a.drawImage(m.firstChild||m,0,0,g,k,f.rg-b,f.sg-c,g,k)}a.restore()}})})();ovi.provide("nokia.maps.map.render.p2d.MarkerLayer");
(function(e){function l(a){this.Hc=a}function h(a){var b=a.parentNode;return k||b&&b.nodeType!==11?q.cloneNode(a,!0):a}var d=[],c=e.util,g=e.map.provider,b=e.map.render.p2d._helpers.geoToScreen,f=c.Point,r=c.Rectangle,a=e.gfx,q=e.dom,k=a.Painter.defaultPainter.isVML;l.prototype.getObject=function(){return this.Hc};nokia.maps.map.render.p2d.MarkerLayer=new ovi.Class({initialize:function(a,b,c,d){this.o=a;this.F=a.ownerDocument;this.e=b;this.Sm=b instanceof g.LocalObjectProvider;this.He={};this.qq=
[];this.xp=new e.util.Cache(128);this.La=d;this.Oq=300;this.e.addListener("response",this.ya=ovi.bind(this,this.ya))},gd:0,ya:function(a){var c,d,e,f,g,k,h,l,q,r;if(a.data[0]===this.Wf){c=this.xp;e=this.F;k={};q=this.Xj;r=this.kd;g=this.Fq;h=a.data[1];for(l=h.length;l--;)f=h[l].getObject(!0),a=f.getIconForRendering(e),d=a.createElement(),d.style.position="absolute",c.add(a.c,d),k[f.id]=[f,this.Dm(f,g,q,r,a),d],this.Mn(a,d,b(f.coordinate,g).sub(f.anchor),l,!0);this.Vn();this.Wf=!1;this.He=k}},za:e.util.u,
Ib:function(a,b,c){for(var e=this.He,g=this.qq,k,h,l=g.length,q,r;l--;)if(h=g[l],k=e[h])if(h=k[1],h.contains(new f(a,b))&&(h=h.topLeft,k=k[0],q=k.hitArea,!q||q.hitTest(a-h.x,b-h.y)))if(r||(r=[]),r.push(k),c)break;return r||d},stop:function(){if(this.Wf)this.e.cancelBBoxRequest(this.Gq.bBox,2,this.Gq.zoom),this.Wf=!1},shutdown:function(){this.La=c.u;this.e.removeListener("response",this.ya);this.stop();this.He={};q.Ob(this.o);return this.o},Ec:-1/0,Fh:-1/0,Gh:-1/0,render:function(a,c,d,e,f,g,k,q,r,
B,C,A,D,E){var e=this.e,f=e.getInvalidationMark(),q=this.Ec,O,I,L,N,G,M,$,F,Z,ba=0,J,a=Math.round(Math.log(d.w/e.width)/Math.LN2),C=this.o,D=this.He;O={};I=this.qq;$=this.xp;F=this.F;Z=!A;J=this.Sm;this.Fq=d;this.Xj=c;this.kd=g;this.Wf&&!A&&this.stop();if(A&&this.Jq!==a){r=[];for(B=I.length;B--;)L=D[I[B]][0],r.push(J?L:new l(L))}else r=e.requestBBox(k,2,a,A);B=r.length;I.length=0;if(!this.Wf&&!A)this.Wf=r===!0?e.Gj(k,a):!1,this.Gq={bBox:k,zoom:a};for(;B--;){if((L=J?r[B]:r[B].getObject(!0))&&L!==!0){k=
0;N=L.id;a=D[N];M=b(L.coordinate,d).sub(L.anchor);a&&(G=a[2])?e.getInvalidations(L,q)?k=L.getIconForRendering(F):A||$.get(L.getIconForRendering(F).c):(G=$.get(L.getIconForRendering(F).c,A))?G=h(G):A||(k=L.getIconForRendering(F));if(k)G=k.createElement(),G.style.position="absolute",$.add(k.c,G),G=h(G),a&&(this.Un(C,a[2]),a[2]=G);G&&(k||(k=L.getIconForRendering(F)),a?(a[1]=this.Dm(L,d,c,g,k),D[N]=0,O[N]=a):O[N]=[L,this.Dm(L,d,c,g,k),G],I.push(N),this.Mn(k,G,M,B,!1))}if(A&&ba===this.Oq){Z=!1;break}ba++}this.Vn();
this.Fh=E;if(!A)this.Ec=f,this.Gh=E;this.He=O;this.La(this,!1);return Z},Dm:function(a,c,d,e,g){a=b(a.coordinate,c).sub(a.anchor);return new r([a,new f(a.x+g.width,a.y+g.height)])},kx:function(a,b,c,d,e){var g=new f(b,c);return a.contains(g)&&(!d||d.hitTest(b-bbox.topLeft.x,c-bbox.topLeft.y,e))},capture:function(c,d,e){var f=this.Fq,g,k=this.He,h=this.kd,l,q,r;d-=h.x;e-=h.y;for(g in k)h=k[g][0],l=h.icon,q=b(h.coordinate,f).sub(h.anchor),r=q.x-d,q=q.y-e,h.icon.isBitmap?c.drawImage(l.Jb,0,0,l.width,
l.height,r,q,l.width,l.height):c.drawGraphics(new a.Graphics(l.getIDL()),0,0,l.width,l.height,r,q,l.width,l.height)}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.dom.MarkerLayer");
(function(){var e=nokia.maps,l=e.css,h=Math.round;e.map.render.p2d.dom.MarkerLayer=new ovi.Class({Extends:e.map.render.p2d.MarkerLayer,initialize:function(d,c,e){this._super.apply(this,arguments);this.Oq=1E4;d.className=e.cssClass+"_markerLayer"},Mn:function(d,c,e,b){d=this.o;l.translateXYElement(c,h(e.x),h(e.y));c.style.zIndex=-b;c.parentNode!==d&&d.appendChild(c)},show:function(){if(this.gd)this.o.style.display="",this.gd=0},hide:function(){if(!this.gd)this.o.style.display="none",this.gd=!0},Vn:function(){var d=
this.o,c=this.He,e,b;if(d.childNodes.length)for(b in c)(e=c[b])&&this.Un(d,e[2])},Un:function(d,c){d.removeChild(c)}})})();ovi.provide("nokia.maps.map.render.p2d.canvas.TileLayer");
(function(){var e=Math.round,l=nokia.maps.util.u;nokia.maps.map.render.p2d.canvas.TileLayer=new ovi.Class({Extends:nokia.maps.map.render.p2d.TileLayer,initialize:function(e,d,c,g){this._super(e,d,c,g);this.useBuffer=c.useBuffer;this.ne=e.getContext("2d");this.Eb=this.Xl();this.Nd=this.Eb.getContext("2d");if(this.useBuffer)this.Go=this.Xl(),this.qs=this.Go.getContext("2d"),this.Bg=this.Xl(!0),this.gj=this.Bg.getContext("2d")},Xl:function(){var e=this.F.createElement("canvas");e.width=this.o.width;
e.height=this.o.height;return e},za:function(){var e=this.o,d=e.width,e=e.height;this.wl(this.Eb,d,e);this.useBuffer&&(this.wl(this.Go,d,e),this.wl(this.Bg,d,e))},wl:function(e,d,c){e.width=d;e.height=c},ya:function(e){var d=e.data,e=d[0],d=d[1],c=this.Jc,g=c[e],b,f=0,l,a=this.Yd;if(g){if(d)for(l=g.length;f<l;)(b=g[f]).Ab=d,b.Ka=d.getNode(this.F),this.Xe(e,b,this.kc,a),f++,--this.bn;c[e]=0;--this.Kk||this.Th()}},Xe:function(e,d,c,g){var b=this.Nd,f=d.Ka;if(g!==1)b.save(),b.globalAlpha=g;(f.nodeName!==
"IMG"||f.complete&&f.naturalWidth)&&b.drawImage(d.Ka,d.rg+this.kd.x,d.sg+this.kd.y,this.Fd.x,this.Fd.y);g!==1&&b.restore();this._super(e,d,c,g)},render:function(h,d,c,g,b,f,l,a,q,k,m,p,z,s){var u=!1,w,x,v=b.x||1;w=(b.x+g[3]-g[1])/2;var y=b.y||1;x=(b.y+g[0]-g[2])/2;p&&this.useBuffer?this.Fh!==s?(h=c.w/this.Ou,d=c.w,w=(this.Yj-w)*h-(c.x-w),w=e(w+(w>d/2?-d:w<-d/2?d:0)),x=-e(c.y-x-(this.Xm-x)*h),this.qs.clearRect(0,0,v,y),this.qs.drawImage(this.Bg,0,0),this.gj.clearRect(0,0,v,y),this.gj.drawImage(this.Go,
0,0,v,y,w,x,v*h,y*h),this.ne.drawImage(this.Bg,0,0)):this.ne.drawImage(this.Eb,0,0):(this.Gh===s&&this.Ec===this.e.getInvalidationMark()?(u=!0,this.Th()):(this.Nd.clearRect(0,0,v,y),this.useBuffer&&this.Nd.drawImage(this.Bg,0,0),u=this._super.call(this,h,d,c,g,b,f,l,a,q,k,m,p,z,s)),this.useBuffer&&(this.gj.clearRect(0,0,v,y),this.gj.drawImage(this.Eb,0,0)),this.ne.drawImage(this.Eb,0,0));this.Yj=c.x;this.Xm=c.y;this.Ou=c.w;return u},pj:function(e,d){d=this._super(e,d);d.Ka=e.Ka;return d},Lk:function(e){return e},
Wn:l,show:l,hide:l})})();ovi.provide("nokia.maps.map.render.p2d.canvas.MarkerLayer");
(function(){var e=nokia.maps,l=e.util.u,h=Math.round,d=Math.min;e.map.render.p2d.canvas.MarkerLayer=new ovi.Class({Extends:e.map.render.p2d.MarkerLayer,initialize:function(c){this._super.apply(this,arguments);this.ne=this.o.getContext("2d");this.Eb=this.F.createElement("canvas");this.Eb.width=c.width;this.Eb.height=c.height;this.Nd=this.Eb.getContext("2d");this.mm=this.lm=0},za:function(){var c=this.o,d=this.Eb;this.qg=d.width=c.width;this.Ef=d.height=c.height},Mn:function(c,e,b,f,l){if(!l){var f=
e,a,q,k;if(e.nodeName==="DIV"&&(f=e.firstChild))a=c.offsetX!==void 0;f&&(e=h(b.x+this.kd.x),b=h(b.y+this.kd.y),a?this.Nd.drawImage(f,c.offsetX,c.offsetY,q=d(c.width,c.naturalWidth-c.offsetX),k=d(c.height,c.naturalHeight-c.offsetY),e,b,q,k):this.Nd.drawImage(f,e,b,c.width,c.height))}},shutdown:function(){this._super();this.Eb=void 0},show:l,hide:l,Vn:l,Un:l,render:function(c,d,b,e,h,a,l,k,m,p,z,s,u,w){var x=!1;s?this.Fh!==w&&(this.Jq===c&&this.Yj!==void 0?(this.lm+=b.x-this.Yj,this.mm+=b.y-this.Xm):
(this.Nd.clearRect(0,0,this.qg,this.Ef),x=this._super(c,d,b,e,h,a,l,k,m,p,z,s,u,w))):this.Gh===w&&this.Ec===this.e.getInvalidationMark()?(this.La(this,!1),x=!0):(this.Nd.clearRect(0,0,this.qg,this.Ef),x=this._super(c,d,b,e,h,a,l,k,m,p,z,s,u,w),this.mm=this.lm=0);this.ne.drawImage(this.Eb,0-this.lm,0-this.mm);this.Yj=b.x;this.Xm=b.y;this.Jq=c;return x}})})();ovi.provide("nokia.maps.map.render.p2d.canvas.SpatialTileLayer");
(function(){var e=[],l=Math.pow,h=nokia.maps.map,d=h.Object.sortByZInfo,h=h.render.p2d.canvas,c=h.TileLayer;h.SpatialTileLayer=function(g,b,f,h){g=new c(g,b,f,h);g.Ib=function(a,b,c){var f=this.e,g=l(2,this.ti+8);a*=g;var b=b*g/this.Fd.x*this.Fd.y,g=f.getTileId(this.ti,a,b),h,r;if(g&&(h=this.kc[g])&&(h=h[0]))r=d(h.Ab.Ib(a%f.width,b%f.height,c),!1,!1);return r||e};return g}})();ovi.provide("nokia.maps.map._Copyright");ovi.provide("nokia.maps.resources.copyright.html");
nokia.maps.resources.copyright.html='<div class="nm_crimg" style="display:block;position:absolute;bottom:20px;left:4px;width:33px;height:24px;margin:6px;cursor:pointer" title="HERE"></div> \r\n<div class="nm_crnode" style="position:relative;top:0;padding-left:10px;padding-bottom:8px;height:13px;font-size:10px;font-family:arial, sans-serif;color:#333;white-space:nowrap;"> \r\n\t<span class="nm_crtext"></span>&nbsp;<a class="nm_toulink" target="_blank" style="text-decoration: underline;"></a>\r\n\t&nbsp;<a class="nm_rilink" target="_blank" title="" style="text-decoration: none;"></a>\r\n</div>';
(function(e){function l(b){a.test(b)||e.util.d("alignment '"+b+"'");this.sj.Xo(b);return b}var h=e.dom,d=Math.floor,c=e.util,g=new e.language.Manager,b=c.Point,f=new Image,r=e.loadPath+e.config.assetsPath+"/here_logo.png",a=/^(top|middle|bottom)(left|center|right)$/,q;f.src=r;e.map.gp=new ovi.Class({initialize:function(a){var b,d;this.ha=a;q=ovi.Array([a.SATELLITE,a.SATELLITE_PLAIN,a.SATELLITE_COMMUNITY,a.GLOBE,a.PANORAMA]);b=this.Fp=h.pb(a.tj,"div");b.innerHTML=e.resources.copyright.html;this.Oo=
h.findElement("nm_toulink",b);d=this.Bi=h.findElement("nm_rilink",b);d.onclick=function(){var b=a.m.getCam(),c="http://here.com/latitude,longitude,fov,yaw,pitch,panorama.day,report",d;for(d in b)c=c.replace(RegExp("\\b"+d+"\\b"),b[d]);this.href=c};d.onclick();this.ss=(this.yw=h.findElement("nm_crtext",b)).parentNode;(d=(this.Jm=b=h.findElement("nm_crimg",b)).style).backgroundRepeat="no-repeat";d.backgroundImage="url("+r+")";b.onclick=function(){var b=a.center;window.open(["http://here.com/?cid=nokiamaps-fw-ilc-na-acq-na-thirdparty-g0-na-1#",
b.latitude,b.longitude,a.zoomLevel,"0|0|"].join("|"))};a.Zd("poweredByWidth",b.offsetWidth);a.Zd("poweredByHeight",b.offsetHeight);this.ag=ovi.bind(this,this.ag);a.copyrightAlignmentSetter=l;a.addListener("basemapchangeend",this.ag);a.addListener("mapviewchangeend",this.ag);a.addListener("resizeend",this.ag);e.map.js.copyrights.addObserver("copyrights",this.ag);this.Xo(a.copyrightAlignment);this.$q();c.getRootNameSpace("nokia.maps").Settings.addObserver("defaultLanguage",this.$q,this)},$q:function(){var a;
a=this.Oo;a.title=a.innerHTML=g.translateToken("ovi.service.map._t66",!1);a.href=h.Page.browser.mobile?"http://nokia.mobi/terms":g.translateToken("ovi.service.map._t67",!1);a=this.Bi;a.title=a.innerHTML=g.translateToken("ovi.service.map._t94",!1);this.Bi.style.display="none"},Xo:function(c){var e=this.ha,f=this.Fp,g=this.ss,h=this.Jm;if(c){var l=a.exec(c),c=l[1],l=l[2],q=f.style;q.cssText="position:absolute;z-index:500;"+(c==="middle"?"top:50%;margin-top:"+d(f.offsetHeight/-2)+"px;":c+":"+(c==="top"?
"34px;":"-7px;"))+(l==="center"?"left:50%;margin-left:"+d(f.offsetWidth/-2)+"px;":l+":"+(l==="left"?"-4px;":"4px;"))+"width:"+q.width+";height:"+q.height+";"}if(f.style.bottom&&ovi.dom.hasClass(e.T.parentNode,"nm_adbar_bottom"))f.style.bottom="21px";f=new b(f.offsetLeft,f.offsetTop);e.Zd("copyrightPosition",f.add({x:g.offsetLeft,y:g.offsetTop}));e.Zd("poweredByPosition",f.add({x:h.offsetLeft,y:h.offsetTop}))},ag:function(){var a=this.ha,b=a.baseMapType,c=this.ss;this.yw.innerHTML="&copy; "+a.getCopyright();
q.indexOf(b)===-1?(c.style.color=this.Oo.style.color=this.Bi.style.color="#333",this.Jm.style.backgroundPosition="0 0"):(c.style.color=this.Oo.style.color=this.Bi.style.color="#FFF",this.Jm.style.backgroundPosition="0px -34px");this.Bi.style.display=b===a.PANORAMA?"":"none";this.Xo();a.Zd("copyrightWidth",c.offsetWidth);a.Zd("copyrightHeight",c.offsetHeight)},getCopyrightGfx:function(){var a=this.Fp,b=f.width;return(new e.gfx.Graphics).beginImage(a.offsetWidth+b,a.offsetHeight+34-6).drawImage(f,0,
this.kq()?34:0,b,34,6,3,b,34).set("fillColor",this.kq()?"#fff":"#333").fillText(String.fromCharCode(169)+" "+this.ha.getCopyright(),6,40)},kq:function(){var a=this.ha,b=a.baseMapType;return b===a.SATELLITE||b===a.SATELLITE_PLAIN||b===a.SATELLITE_COMMUNITY||b===a.GLOBE}})})(nokia.maps);ovi.provide("nokia.maps.map.Spatial");nokia.maps.map.Spatial=new ovi.Class({Extends:nokia.maps.map.Object,initialize:function(e){this._super(e);this.Hn={}},simplify:3,hd:1});ovi.provide("nokia.maps.map.provider.LocalObjectProvider");
(function(e){var l=Math,h=e.util,d=h.Event,c=h.d,g=e.geo.QuadTree,b=e.map.Object,f=b.sortByZInfo,r=b.CHANGE_SPATIAL,a=b.CHANGE_VISUAL,q=b.CHANGE_ZINDEX,k=e.map.provider.LocalObjectProvider=new ovi.Class({Extends:e.map.provider.Provider,Statics:{SPATIAL:1,MARKER:2},initialize:function(a,b){this.an=new g(18);this.xo=new g(18);this.Tv=a.e.orphan(a)&&this.adopt(a);this._super(b)},wq:-l.pow(2,53),vq:-l.pow(2,53),nj:function(a){return a?++this.wq:++this.vq},getInvalidationMark:function(a){return a?this.wq:
this.vq},To:function(){this.dispatch(new d("update"))},kp:function(b){var c,d=b.ad();c=b.hd?this.xo.insertBoundingBox(b.getBoundingBox()):this.an.insertCoordinate(b.coordinate);c.Mq=b;b.Ui=c;d[r]=d[a]=d[q]=this.nj(b.hd);return b},Gr:function(a){a.hd?this.xo.remove(a.Ui):this.an.remove(a.Ui);a.Ui=null;return a},si:function(a){a.e!==this&&c();if(!a.Ui)return this.getInvalidationMark(a.hd);this.Gr(a);this.update();this.Qp(a);return this.nj(a.hd)},zg:function(a){a.e!==this&&c();this.kp(a);this.update();
return this.nj(a.hd)},Dc:function(a,b){a.e!==this&&c();if(!a.Ui)return this.getInvalidationMark(a.hd);b&r&&(this.Gr(a),this.kp(a));this.Qp(a);this.update();return this.nj(a.hd)},Qp:function(a){var b,c;if(a.hd)for(c in b=a.Hn,b)b[c].Pp(a)},getInvalidations:function(a,b){return a.getInvalidations(b)},requestBBox:function(a,b){var c,d,e=[],b=b||k.SPATIAL|k.MARKER;if(b&k.SPATIAL){c=this.xo.intersectBoundingBox(a,1);for(d=c.length;d--;)e.push(c[d].Mq)}if(b&k.MARKER){c=this.an.intersectBoundingBox(a,1);
for(d=c.length;d--;)e.push(c[d].Mq)}return e=f(e)},cancelBBoxRequest:function(){},adopt:function(a){if(a.e||!(a instanceof b))return!1;a.e=this;return a},orphan:function(a){if(a.e!==this||!(a instanceof b))return!1;a.e=null;return a}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.dom.TileLayer");
(function(){new Image;var e=ovi.browser.msie,l=nokia.maps,h=l.dom,d=l.css,c=h.cloneNode;nokia.maps.map.render.p2d.dom.TileLayer=new ovi.Class({Extends:l.map.render.p2d.TileLayer,initialize:function(c,b,d){c.style.position="absolute";this.Bw=d.cssClass+"Tile";this._super.apply(this,arguments)},Th:function(){var c,b,e;if(d.supportsTransition()){c=this.o.children;b=c.length;for(e=this.Yd;b--;)this.Ds(c[b],e)}this._super()},ya:function(c){var b=c.data,c=b[0],b=b[1],e=this.Jc,h=e[c],a,l=0,k,m,p=this.Yd;
this.Xn(this.kc,c);if(h){if(b)for(k=h.length;l<k;)(a=h[l]).Ab=b,(a.Ka=m=this.Lk(b.getNode(this.F),l++)).style.position="absolute",d.supportsTransition()?(this.Xe(c,a,this.kc,0),this.Ds(m,p)):this.Xe(c,a,this.kc,p),--this.bn;e[c]=0;--this.Kk||this.Th()}},Ds:function(c,b){setTimeout(function(){h.$d(c,b)},20)},Wn:function(c){var b=c.Ka;this.o.removeChild(b);c=this.e.request(c.Fc,c.Rr,c.Cp,!0);(!c||c===!0)&&b.removeAttribute&&b.removeAttribute("src")},Xe:function(c,b,e,h){var a=b.Ka,l=this.Fd;d.translateXYElement(a,
b.rg,b.sg);this.bs(l.x,l.y,b);this.as(a,h);a.parentNode!==this.o&&this.o.appendChild(a);this._super(c,b,e,h);this.e.providesLevel(b.Fc)&&this.show()},as:function(c,b){b!==1&&h.$d(c,b)},bs:function(c,b,d){d=d.Ka.style;d.width=c+"px";d.height=b+"px"},Lk:function(d,b){var f=d.parentNode;if(f&&(!e||f.nodeType!==11)&&(b||f!==this.o))d=c(d,!0);d.className=this.Bw;d.style.position="absolute";return d},pj:function(c,b){b=this._super(c,b);b.Ka=this.Lk(c.Ka,!0);return b},show:function(){if(this.gd)this.o.style.display=
"",this.gd=!1},hide:function(){if(!this.gd)this.o.style.display="none",this.gd=!0}})})();ovi.provide("nokia.maps.map.render.p2d.dom.SpatialTileLayer");
(function(){var e=[],l=Math.pow,h=nokia.maps,d=h.css,c=h.dom,g=h.map,b=g.Object.sortByZInfo,g=g.render.p2d.dom,f=g.TileLayer;g.SpatialTileLayer=function(g,a,q,k){a=new f(g,a,q,k);a.Ib=function(a,c,d){var f=this.e,g=l(2,this.ti+8);a*=g;var c=c*g/this.Fd.x*this.Fd.y,g=f.getTileId(this.ti,a,c),k,h;if(g&&(k=this.kc[g])&&(k=k[0]))h=b(k.Ab.Ib(a%f.width,c%f.height,d),!1,!1);return h||e};a.zx=null;g.className=a.ex=q.cssClass+"SpatialTileLayer";a.bs=function(a,b,c){a=new nokia.maps.util.Point(a/c.Ab.e.tileSize.x,
b/c.Ab.e.tileSize.y);this.Se.setScale(c.Ka,a)};a.as=function(a,b){d.transformType>0&&b!==1&&c.$d(a,b)};a.pj=function(a,b){b||(b={c:a.c});b.Fc=a.Fc;b.Ab=a.Ab;b.Ka=c.cloneNode(a.Ka,!0);b.Ka=b.Ab.getNode(this.F);return b};a.capture=function(a,b,c){var d,e,f;e=this.e;var g=e.width,k=e.height,l=this.kc,q=this.kd;for(d in l)for(f=l[d].length;f--;)e=l[d][f],a.drawGraphics(new h.gfx.Graphics(e.Ab.getIDL()),0,0,g,k,e.rg+(q.x-b),e.sg+(q.y-c),g,k)};return a}})();ovi.provide("nokia.maps.map.render.p2d.canvas.MapLayer");
(function(){var e=Math.round,l=Math.max,h=nokia.maps.map.render.p2d.canvas;h.MapLayer=new ovi.Class({initialize:function(d,c,e,b){this.Mf=c.min;this.fb=c.max;this.e=c;this.La=b;this.t=d;this.Hl=new h.TileLayer(d,c,e,function(){});e.useBuffer=!1;this.Zj=new h.TileLayer(d,c,e,this.La);this.Lb=ovi.bind(this,this.Lb)},shutdown:function(){this.Hl.shutdown();this.Zj.shutdown();return this.o},za:function(){this.Hl.za();this.Zj.za()},stop:function(){this.Zj.stop()},render:function(d,c,g,b,f,h,a,q,k,m,p,z,
s,u){var w,p=e(p);for(w=l(this.Mf,p-3);w<p;)this.Hl.render(d,c,g,b,f,h,a,q,k,m,w++,!0,s,u);return this.Zj.render(d,c,g,b,f,h,a,q,k,m,p,z,s,u)}})})();ovi.provide("nokia.maps.map._MarkerIcon");
(function(){function e(c){return new b(typeof c==="object"?c.strokeColor?{strokeColor:a(c.strokeColor)}:void 0:{strokeColor:c})}var l=nokia.maps,h=l.map.HitArea,d=l.util,c=d.proto,g=d.Point,b=d.Pen,f=new b({strokeColor:"#FFF"}),r=d.Brush,a=d.ColorHelper.getHex3,q=l.gfx,k=q.GraphicsImage,m=q.IDL,p=q.Color.parseCss,z=[4207599104,4207599105,4207599106,"$Text$"],s=new l.gfx.SvgParser,u=d.pd("shape text textPen pen brush effect"),w=d.flatMerge(d.pd("anchor hitArea"),u),x=new d.Cache(50),v=nokia.maps.map.Sb=
new ovi.Class({Extends:nokia.maps.util.OObject,initialize:function(a){var b;a&&a.shape&&a.shape!==this.shape?(this.shape=this.shapeSetter(b=a.shape),delete a.shape,this._super(a),a.shape=b):(this.shapeSetter(this.shape),this._super(a));this.addObserver("*",this.we)},Statics:{Qn:w,$a:function(a){return a in w},Le:function(a){return!(a in u)},rc:{balloon:['<path style="opacity:0.4;fill:#353535" d="m 19,31 c 0,1.67 -2.69,3 -6,3 c -3.31,0 -6,-1.33 -6,-3 c 0,-1.67 2.69,-3 6,-3 c 3.31,0 6,1.33 6,3 z" /><path style="fill:#Facade01" d="m 13,0 c -3.47,0 -6.73,1.32 -9.19,3.75 C 1.36,7.82 0,9.41 0,12.84 c 0,3.43 1.36,6.64 3.81,9.06 L 13,31 l 9.19,-9.094 c 2.46,-2.43 3.81,-5.63 3.81,-9.06 c 0,-3.43 -1.36,-6.67 -3.81,-9.09 C 19.73,1.32 16.47,0 13,0 z"/><path style="fill:#ffffff" d="m 13,1 c -3.21,0 -6.23,1.23 -8.5,3.47 c -2.26,2.24 -3.5,5.22 -3.5,8.38 c 0,3.16 1.24,6.14 3.5,8.38 l 8.5,8.38 l 8.5,-8.38 c 2.26,-2.24 3.5,-5.22 3.5,-8.38 c 0,-3.16 -1.24,-6.14 -3.5,-8.38 C 19.23,2.23 16.2,1 13,1 z"/><path style="fill:#Facade00;fill-opacity:1" d="m 13,2.19 c -7,0 -10.74,4.96 -10.81,10.65 c 0,3.27 0.95,5.61 3.03,7.66 l 7.79,7.69 l 7.79,-7.69 c 2.07,-2.05 3.02,-4.27 3.03,-7.66 C 23.58,7.07 19.98,2.19 13,2.19 z"/><text x="13" y="18" font-size="10pt" font-family="arial" font-weight="bold" text-anchor="middle" fill="#Facade02">$Text$</text>',
28,36,13,31,"poly",[0,16,0,7,8,0,18,0,26,7,26,16,18,34,8,34]]}},text:"",pen:c({},f),textPen:c({},f),brush:c({},new r({color:"#1080DD"})),shape:"balloon",effect:"none",we:function(a,b){if(b in u)a.c="",a.Va=0},shapeSetter:function(a){var b=v.rc[a]||d.d("shape");this.f=new g(b[1],b[2]);this.anchor=new g(b[3],b[4]);this.hitArea=b[5]?new h(b[5],b[6]):void 0;return a},brushSetter:function(b){return new r(typeof b==="object"?b.color?{color:a(b.color)}:void 0:{color:b})},penSetter:e,textPenSetter:e,textSetter:function(a){return d.sanitizeText(a)},
ue:function(){var a=v.rc[this.shape],b,c,d,e;if(a&&typeof a[0]==="string"){b=z.length;for(c=a[0]=ovi.Array(s.parseSvg('<svg version="1.1" width="'+(d=a[1])+'" height="'+(e=a[2])+'" viewBox="0 0 '+d+" "+e+'">'+a[0]+"</svg>").data);b--;){e=[];for(d=-1;(d=c.indexOf(z[b],d+1))!==-1;)e.push(d);e.length&&(a[7+b]=e)}}return a},bf:function(a){for(var b=[p(this.brush.color,1),p(this.pen.strokeColor,1),p(this.textPen.strokeColor,1),this.text],c=b.length,d=a[0].slice(),e,f;c--;)if(e=a[7+c])for(f=e.length;f--;)d[e[f]]=
b[c];return d},getIcon:function(){var a,b;if(!this.Va){if(!(b=x.get(a=this.fa())))x.add(a,b=new k(new m(this.bf(this.ue()))));this.Va=b}return this.Va},fa:function(){return this.c||(this.c=(this.hasOwnProperty("shape")?this.shape:"").concat(this.text,this.textPen.fa(),"P",this.pen.fa(),"B",this.brush.fa()))}})})();ovi.provide("nokia.maps.map.Polyline");
(function(e){var l=nokia.maps.geo,h=l.BoundingBox,d=l.Coordinate,e=nokia.maps.util,c=e.math.clipping.clipStrips,g=e.isArray,b=e.Strip,f=nokia.maps.util.Rectangle,r=e.Point,a=e.Arrows,q=e.Pen,k=nokia.maps.gfx.Color.parseCss,m=k("#0000"),p=new b(["latitude","longitude","altitude"]),z=l.Shape.hp,s=[],u=Math,w=u.min,x=u.atan,v=u.sqrt,y=u.pow,B=u.floor,C=180/u.PI,A=nokia.maps.map.Polyline=new ovi.Class({Extends:nokia.maps.map.Spatial,initialize:function(a,b){a instanceof l.Strip||g(a)||e.d("Argument coords is not instance of geo.Strip or Array.");
var c=this.path=a instanceof l.Shape?a:new l.Shape(this.closedShape);a instanceof l.Shape?c.Fb=this.closedShape:a instanceof l.Strip?c.$p(a):c.splice(0,0,a,"auto");this.Zm={};(!b||!b.pen)&&(this.pen=this.penSetter());this._super(b);c.addObserver(this.zv,this)},destroy:function(){this.path.destroy();this._super()},Statics:{cj:100,Ls:s},hj:null,B:"polyline",color:null,stroke:"solid",width:0,lineJoin:null,pen:null,arrows:null,closedShape:!1,ja:function(a,b){a==="path"?(this.Kr(),b|=1):a!=="zIndex"&&
(b|=2);this._super(a,b)},zv:function(a,b){this.Kr();this.ja(b,1)},Kr:function(){this.hj=null;this.Zm={}},getNearest:function(a){var b=this.path,a=this.getNearestIndex(a);return b.get(a)},getNearestIndex:function(a){for(var b=this.path.asArray(),c=b.length,d=l.Coordinate.fromObject(a),e,f=d.distance({latitude:b[0],longitude:b[1]}),g=0,a=3;a<c;a+=3)e=d.distance({latitude:b[a],longitude:b[a+1]}),e<f&&(g=a/3,f=e);return g},getBoundingBox:function(){var a=this.path,b=this.hj;if(!b&&(b=a.getBoundingBox()))b.getWidth()==
360&&a.Gb%2==1&&(b=b.merge(new h(new d(this.coverNorthPole?90:-90,0,void 0,!0),void 0,!0))),this.hj=b;return b},pathSetter:function(a){var b=this.path;b.splice(0,b.getLength(),l.Strip.convertToArray(a),"unsafe values lat lng alt");return b},widthSetter:function(a){(a=e.Pa(a,0,A.cj))!==a&&e.d("width must be in range [0.."+A.cj+"]");this.pen=new q({lineWidth:a},this.pen);return a},strokeSetter:function(a){a!=="solid"&&e.d("cannot set anything else than stroke=solid");this.pen=new q({stroke:a},this.pen);
return a},colorSetter:function(a){k(a)===null&&e.d("color");this.pen=new q({strokeColor:a},this.pen);return a},lineJoinSetter:function(a){this.pen=new q({lineJoin:a},this.pen);return a},penSetter:function(a){a instanceof q||(a=new q(a));this.set("width",a.lineWidth);this.set("color",a.strokeColor);this.set("lineJoin",a.lineJoin);return a},arrowsSetter:function(b){return b instanceof a?b:b?new a(b):!1},coveredByTile:function(a,b,c){var d=a?a.length:0,e,f=this.lineWidth;if(this.closedShape)for(;d--;)if(r.isCoveredBy(b,
c,a[d],f,!0)){e=!0;break}return e||!1},drawToTile:function(a,b,e){var g=this.closedShape,l=this.getBoundingBox();h.fromObject([90,l.topLeft.longitude,-90,l.bottomRight.longitude],!0).contains(new d(0,180,void 0,1));var l=this.pen.lineWidth,p=this.pen.lineCap,q=this.pen.lineJoin,u=this.pen.miterLimit,v=e?2*(l>1?l:1)+0.13524:0,v=new f([new r(-v,-v),new r(a.getWidth()+v,a.getHeight()+v)]),b=this.path.clip(b,v,this.simplify,this.coverNorthPole,this.sm,e,A.cj),e=b.length,w,v=l||g,x,y,B;if(e){l&&(a.set("strokeColor",
k(this.pen.strokeColor)),a.set("lineWidth",l));p&&a.set("lineCap",p);q&&a.set("lineJoin",q);u&&a.set("miterLimit",u);g&&a.set("fillColor",this.brush.fill==="none"?m:k(this.brush.color));for(this.arrows&&(B=c(b,0,0,x=a.getWidth(),y=a.getHeight()));e--;){p=b[e];u=p.length;w=p[0];if(v){a.beginPath();a.moveTo(w.x,w.y);for(q=1;q<u;q++)a.lineTo((w=p[q]).x,w.y);g&&(a.closePath(),a.fill());l&&a.stroke()}for(q=u;q--;)p.push((w=p[q]).x,w.y);p.splice(0,u)}B&&this.Tt(a,x,y,B,l);return!g||!b.fullfilled?b:s}else return b===
z?s:!1},iu:function(a){for(var b=a.length,c=0;--b;)c+=a[b].distance(a[b-1]);return c},Tt:function(a,b,c,d,e){var g=this.arrows,k=e*g.width/2,e=e*g.length/2,h=e/2,l=e*2*g.frequency,m=v(y(e,2)+y(k,2)),b=new f([new r(m,m),new r(b-m,c-m)]),p,q,c=this.iu,s,z,u,A,za,T,pa;a.set("fillColor",g.color);for(g=d.length;g--;)if(z=0,m=d[g],p=m.length)if((q=c(m))>=l){s=w(B(q/l),1E3);q/=s+1;for(s=q/2;--p;){for(u=(A=m[p]).distance(za=m[p-1]);s<=z+u;)pa=A.x+(za.x-A.x)*(T=(s-z)/u),T=A.y+(za.y-A.y)*T,b.contains(new r(pa,
T))&&(a.save(),a.translate(pa,T),a.rotate(-x((za.y-A.y)/(A.x-za.x))*C-(A.x<za.x?270:90)),a.beginPath(),a.moveTo(-k,-e),a.lineTo(0,e),a.lineTo(k,-e),a.lineTo(0,-h),a.closePath(),a.fill(),a.restore()),s+=q;z+=u}}},project:function(a){return this.Zm[a.id]||(this.Zm[a.id]=a.geoToMapPoints(b.stencil(p,this.path.internalArray)))}})})(nokia.maps.util);ovi.provide("nokia.maps.map.render.p2d.dom.MapLayer");
(function(){function e(a,b){return a.jl-b.jl}var l=Math,h=l.abs,d=l.pow,c=l.round,g=nokia.maps,b=g.map.render.p2d.dom,f=g.dom,r=(l=f.Page.browser.mobile)?-1:-2,a=l?2:4;b.MapLayer=new ovi.Class({initialize:function(a,c,d,e){var g,h;this.Mf=g=c.min;this.fb=h=c.max;this.e=c;this.La=e;this.o=a;this.ak=a=[];this.nq=d.fading*1.1+20;this.Hm=ovi.bind(this,this.Hm);for(this.Lb=ovi.bind(this,this.Lb);g<=h;g++)a[g]=new b.TileLayer(f.pb(this.o,"div"),c,d,this.Lb),a[g].wg=g},shutdown:function(){var a=this.Mf,
b=this.ak,c=b.length;for(this.La=g.util.u;c--&&c>=a;)b[c].shutdown();f.Ob(this.o);return this.o},stop:function(){for(var a=this.Mf,b=this.ak,c=b.length;c--&&c>=a;)b[c].stop()},Lb:function(a,b){if(a===this.Ld){if(!b)this.nq&&(this.uu=setTimeout(this.Hm,this.nq));this.La(this,!1)}},Hm:function(){for(var a=this.Ld.jl;a--;)this.gs[a].hide()},kw:function(a){for(var b=this.ak,c=b.length,d=this.Mf,e;c--&&c>=d;)e=a-c,b[c].Tw=e,b[c].jl=-h(2*e-(e>0))},render:function(b,f,g,h,l,s,u,w,x,v,y,B,C){var y=c(y),A=
this.Mf,D=this.fb,E=this.ak,O,I;clearTimeout(this.uu);this.Ld&&this.Ld.wg!==y&&this.Ld.stop();this.Ld=E[y];this.kw(y);this.gs=y=E.slice(A,D+1).sort(e);for(I=y.length;I--;)y[I].jl=I;for(E=!(I=y.length);I--;)A=y[I],D=A===this.Ld,O=y[I].Tw,E||O&&(O<r||O>a)?A.hide():(d(2,O),E=A.render(b,f,g,h,l,s,u,w,x,v,A.wg,B||!D,C)&&!D),this.gs[I].o.style.zIndex=I-100;return E},capture:function(a,b,c,d,e){this.Ld&&this.Ld.capture(a,b,c,d,e)}})})();ovi.provide("nokia.maps.map.Polygon");
(function(){var e=nokia.maps.util.Brush,l=nokia.maps.util.d;nokia.maps.map.Polygon=new ovi.Class({Extends:nokia.maps.map.Polyline,initialize:function(e,d){(!d||!d.brush)&&(this.brush=this.brushSetter());this._super(e,d)},B:"polygon",fillColor:null,brush:null,closedShape:!0,coverNorthPole:!1,sm:136,fillColorSetter:function(h){var d=nokia.maps.gfx.Color,c=d.parseCss(h);c===null&&l("Invalid fillColor set!");this.sm=d.alpha(c);this.brush=new e({color:h},this.brush);return h},brushSetter:function(h){var d=
nokia.maps.gfx.Color,c;h instanceof e||(h=new e(h));this.set("fillColor",h.color);c=d.parseCss(h.color);this.sm=d.alpha(c);return h},coverNorthPoleSetter:function(e){return!!e}})})();ovi.provide("nokia.maps.map.Marker");
(function(){var e=nokia.maps,l=e.util,h=e.dom,d=e.map,c=e.gfx,g=l.Point,b=l.Strip,f=new g(0,0),r=l.Rectangle,a=d.Sb,q=e.geo,k=d.HitArea,m=q.Coordinate,e=new ovi.Class({Extends:d.Object,initialize:function(b,c){var d;if(this.B==="marker"&&(!c||!("icon"in c)))d=new a,this.set("icon",d.getIcon()),this.set("anchor",d.anchor),this.set("hitArea",d.hitArea);this.Xa={};this._super(c);this.set("coordinate",b,1)},B:"marker",anchor:f,f:f,coordinateSetter:function(a){(a=m.fromObject(a))||l.d("coord");this.Xa=
{};return a},hitAreaSetter:function(a){return!a?a:k.from(a)},anchorSetter:function(a){(a=g.fromObject(a))||l.d("you have to set util.Point");return a},draggableSetter:function(a){return this.isDraggable=a},Qa:function(a){this.f=new g(a.width,a.height);this.sc=1},iconSetter:function(a){ovi.type(a);a instanceof c.Image||(a=c.Image.fromObject(a));a instanceof c.Image||l.d("icon");this.icon=a.F===document?a:a.clone(document);a.state===1?this.Qa(a):this.sc=0;return this.icon},getBoundingBox:function(){return q.BoundingBox.coverAll([this.coordinate])},
getDisplayBoundingBox:function(a){a=a.geoToPixel(this.coordinate).sub(this.anchor);return new r([a,a.add(this.f)])},hitTest:function(a,b,c,d){var a=this.getDisplayBoundingBox(a),e=new g(b,c),f=this.hitArea;return a.contains(e)&&(!f||f.hitTest(b-a.topLeft.x,c-a.topLeft.y,d))},getDisplayOffset:function(a,b,c){return(new g(b,c)).sub(a.geoToPixel(this.coordinate))},ja:function(a,b){a!=="zIndex"&&(b|=a==="coordinate"?1:2);this._super(a,b)},xe:function(a){var b="error";a.state===1&&(this.Qa(a),this.ja("icon",
2),b="load");this.dispatch(new h.Event({type:b,target:this,relatedTarget:a}))},getIconForRendering:function(a){var b=this.icon;a!==document&&(b=b.clone(a));b.state?this.sc||b.state===1&&this.Qa(b):b.prepare(this.xe,this);return b},project:function(a){return this.Xa[a.id]||(this.Xa[a.id]=a.geoToMapPoints(b.stencil(b.LAT_LNG,[this.coordinate.latitude,this.coordinate.longitude])))}});if(d.Marker.isNs)d.Marker=e})();ovi.provide("nokia.maps.map.Rectangle");
(function(){var e=nokia.maps,l=e.util,e=e.geo,h=e.Strip,d=e.BoundingBox;nokia.maps.map.Rectangle=new ovi.Class({Extends:nokia.maps.map.Polygon,initialize:function(c,d){c=this.boundingBoxSetter(c,1);this._super(this.Vg(this.boundingBox=c),d)},simplify:0,B:"rectangle",Vg:function(c){var d=c.topLeft,b=d.latitude,e=d.longitude,l=c.bottomRight,d=l.latitude,l=l.longitude,e=[b,e,b,l,d,l,d,e],l=0;if(c.getWidth()>=180)c=c.getCenter(),l=c.longitude,e.splice(6,0,d,l),e.splice(2,0,b,l);return new h(e,"unsafe values lat lng")},
boundingBoxSetter:function(c,e){c=d.fromObject(c)||l.d();e||this.set("path",this.Vg(c));return c}})})();ovi.provide("nokia.maps.map.StandardMarker");
(function(){function e(c,d,b){c.V.set(d,b);if(d==="shape")c.f=c.V.f,c.set("anchor",c.V.anchor),c.set("hitArea",c.V.hitArea);return c.V[d]}var l=nokia.maps,h=l.util,d=l.map.Sb,l=nokia.maps.map.StandardMarker=new ovi.Class({Extends:nokia.maps.map.Marker,initialize:function(c,e){var b=this.V=new d(h.flatMerge({},e,1,d.$a));h.flatMerge(this,b,1,d.$a);this.f=b.f;this._super(c,h.flatMerge({},e,1,d.Le))},B:"standardmarker",shapeSetter:function(c){return e(this,"shape",c)},textSetter:function(c){return e(this,
"text",c)},textPenSetter:function(c){return e(this,"textPen",c)},penSetter:function(c){return e(this,"pen",c)},brushSetter:function(c){return e(this,"brush",c)},getIconForRendering:function(c){this.set("icon",this.V.getIcon());return this._super(c)}});h.flatMerge(l.prototype,d.prototype,!0,d.$a)})();ovi.provide("nokia.maps.map.provider.SpatialTile");
(function(){var e=nokia.maps,l=e.util.Point,h=e.dom.importNode,d=e.dom.cloneNode,c=e.map,g=c.Polyline.Ls,e=e.gfx,b=e.Graphics,f=e.IDL,r=e.GraphicsImage,a=e.Painter.defaultPainter.isVML,q=[],k=-1/0,m=q.concat,e=c.provider.SpatialTile=function(a,b,c,d){this.id=a;this.e=b;this.pi=c;this.Fc=d;this.ci={};this.Gn={}};ovi.extend(e.prototype=new c.provider.Tile(0,0,0),{Nn:k,Xi:k,getIDL:function(){var a,b=this.pq;return b&&new f(m.apply([f.opcodes.BEGIN_2D_IMAGE,(a=this.e).width,a.height,""],b))},getNode:function(b){var c=
this.data,e,f;if(!c&&(e=this.getIDL()))this.data=c=(new r(e,null,document)).createElement(),c.style.position="absolute";if(c){if(b&&b!==document)c=h(b,c,1);else if(a||(f=c.parentNode)&&f.nodeType!==11)c=d(c,1);return c}},pt:function(){var a=this.ci,b;this.hi=null;for(b in a)a.hasOwnProperty(b)&&this.Pp(a[b][0])},Pp:function(a){var b=a.id,c=this.pq,d,e=this.ci;if(b in e){delete a.Hn[this.id];if((d=e[b][2])&&(d=c.indexOf(d))!==-1)c.splice(d,1),this.data=0,this.Xi=k;delete e[b]}},Cr:function(a,b,c){var d=
a.id,e=this.ci;d in e||(a.Hn[this.id]=this);return e[d]=b?[a,b,c]:[a]},Ib:function(a,b){var c,d=this.Gn,e,f,k,h,m,r,A,D,E;for(f in d)if(d.hasOwnProperty(f)&&(k=(e=d[f])[1])){h=e[0];if(!(m=k===g)){r=h.width||0;for(A=k.length;A--&&!m;)if(E=l.isCoveredBy(a,b,k[A],r,D=h.closedShape),D&&h.brush.fill==="none"&&E==="S"&&(E=!1),E&&D||!D&&(E==="E"||E==="V"))m=1}m&&(c||(c=[]),c.push(h))}return c||q},Hv:function(){var a=this.e,b=a.tb;if(this.Nn<b)(a=a.fu(this.pi,this.Fc)).length?(this.hi=a,this.state=void 0):
(this.hi=null,this.state=!1),this.Nn=b},paint:function(){var a=0,c=this.hi,d=c.length;if(d){for(var e=this.e,f=this.pi,g=this.Fc,k=e.width,e=e.height,h=[],l,m,q=this.ci,r,E,O,I=new b;d--;){m=c[d];l=m.id;if(!(r=q[l]))I.beginImage(k,e),(l=m.drawToTile(I,f,g))?(r=this.Cr(m,l,I.getIDL().data.slice(4)),O=1):this.Cr(m);r&&(E=r[2])&&h.push(E)}this.Xi=this.Nn;if(O)this.pq=ovi.Array(h),this.data=0;h.length&&(a=1)}this.hi=0;this.Gn={};for(var L in this.ci)this.Gn[L]=q[L];return this.state=a!==0}}).constructor=
e})();ovi.provide("nokia.maps.map.Circle");
(function(){var e=nokia.maps,l=Math,h=l.asin,d=l.sin,c=l.cos,g=l.abs,b=l.PI,f=b/180,r=180/b,a=e.util,q=e.geo.Coordinate;nokia.maps.map.Circle=new ovi.Class({Extends:nokia.maps.map.Polygon,initialize:function(a,b,c){this._super(this.Vg(this.center=this.centerSetter(a,1),this.radius=this.radiusSetter(b,1),c&&"precision"in c?this.precisionSetter(c.precision,1):this.precision),c)},B:"circle",precision:60,centerSetter:function(b,c){b=q.fromObject(b)||a.d();b.equals(this.center)?b=this.center:c||this.ro(b,
this.radius,this.precision);return b},radiusSetter:function(b,c){(b=a.Pa(b,0,1E7))!==b&&a.d("Passed argument is not a number.");c||this.ro(this.center,b,this.precision);return b},precisionSetter:function(b,c){((b=a.Pa(b,4,360))!==b||b===Infinity)&&a.d("Passed argument is not a number or is a infinity.");c||this.ro(this.center,this.radius,b);return b},ro:function(a,b,c){this.set("path",this.Vg(a,b,c))},Vg:function(a,b,c){var d=270,c=360/c,e=[],a=q.fromObject(a);this.set("coverNorthPole",a.latitude>
0?!0:!1);if(g(a.latitude===90))e=this.vt(a,b,c,d,630);else for(;d<630;d+=c)e.push(a.walk(d,b,1));this.hj=null;return e},vt:function(a,e,g,l,s){e/=6371E3;for(var u=[],a=f*a.latitude,w,x;l<s;l+=g)w=f*l,x=h(d(a)*c(e)+c(a)*d(e)*c(w)),w=(w+b)%(2*b)-b,u.push(new q(x*r,w*r));return u}})})();ovi.provide("nokia.maps.map.provider.TileProvider");
(function(){var e=nokia.maps,l=e.util.Cache,h=l.NEXT,d=l.DONT;new Image;var c=e.map.provider.SpatialTile,g=e.util,b=g.Event,f=g.Point,e=e.geo,r=e.PixelProjection,a=Math.floor;nokia.maps.map.provider.TileProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,initialize:function(a){var b,c,d={},e={},g,h,l,x;this._super(a);this.uc=new f(this.width,this.height);a=this.projection;g=this.width;h=this.height;l=this.max;for(x=this.min;l>=x;)b=1<<l,c=function(a,b){this.y=a*h;this.x=b*g},c.prototype=
new r(a,g*b,h*b),e[l]=new c(0,0),d[l--]=c;this.Ps=d;this.pixelProjections=e;this.tileSize=new f(g,h)},width:256,height:256,opacity:1,alpha:!1,scalable:!0,cache:new l(128,function(a){return a.data?a:h},function(a){a.data&&!a.data.parentNode&&a.data.removeAttribute&&a.data.removeAttribute("src")},new l(512,function(a){a.data=null;return a instanceof c?a:h},function(a){a&&a.pt()},new l(2048,function(a){return a instanceof c?d:a}))),projection:e.mercator,getInvalidations:function(a,b){var c=this.getInvalidationMark();
return(b<c||a.Xi<c)*1},createId:function(a,b,c,d){return d||(c=this.checkAddy(a,b,c))!==-1?this.id+"_"+a+"_"+b+"_"+c:!1},checkAddy:function(a,b,c){var d=1<<a;return a<this.min||a>this.max||b<0||b>=(d=1<<a)?-1:(c%=d)<0?c+d:c},cancel:function(a){var b=this.bb[a];if(b&&!--b.Pk)return b.state=void 0,this.finishRequest(a,b,!0,!0),b},mt:function(){var a=this.bb,b,c;for(b in a)if((c=a[b])&&c.Pk)c.Pk=1,this.cancel(b)},finishRequest:function(a,c,d,e){var f;!d&&(f=this.cache)&&c.state!==void 0&&f.add(a,c);
delete this.bb[a];if(!e)d=new b("response"),d.data=[a,c.state?c:!1],this.dispatch(d)},request:function(a,b,c,d){var e,f,g=!1;if((c=this.checkAddy(a,b,c))!==-1)if(f=this.bb[e=this.createId(a,b,c,1)])d||(f.Pk++,g=!0);else{if(g=this.cache)if((f=g.get(e))&&this.getInvalidations(f,this.tb)!==0)g.remove(e,!1),f=void 0;!d&&(f===void 0||f.state===!0&&!f.data)?(f=this.create(a,b,c,e,!1),f.state===void 0?(this.bb[e]=f,g=!0):g=f.state&&f):(f&&f.state===!0&&!f.data&&(f=this.create(a,b,c,e,!0)),g=f!==!0&&f&&f.state&&
f.data&&f||!1)}return g},getTileAdr:function(b){return new f(a(b.x/this.width),a(b.y/this.height))},getTileId:function(b,c,d){if((c=this.checkAddy(b,d=a(d/this.height),a(c/this.width)))!==-1)return this.createId(b,d,c,!0)},destroy:function(){var a=this.cache;a&&a.removeAll(this.id);this.mt()}})})();ovi.provide("nokia.maps.map.provider.SpatialTileProvider");
(function(){var e=nokia.maps,l=e.util.Coroutine,h=e.geo.BoundingBox,d=e.map,c=e.map.provider,g=c.SpatialTile;nokia.maps.map.provider.SpatialTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(b,e){this.hn=b;b.addListener("update",this.Qe=ovi.bind(this,this.Qe));this.Sm=b instanceof c.LocalObjectProvider;this.label=b.label+"[Spatial]";this.min=b.min;this.max=b.max;this._super(e);this.Su=Math.round(d.Polyline.cj/2)+1;this.bi={};this.Fn(this);this.Tf=ovi.Array()},
mx:1,Zp:0,shutdown:function(){this.hn.removeListener("update",this.Qe);this._super()},Qe:function(){this.tb=this.hn.getInvalidationMark(!0)},finishRequest:function(b,c,d,a){this._super(b,c,d,a);a||this.Pv(c)},Pv:function(b){var c,d,a;a=(c=this.Tf).length;for(d=0;d<a;d++)if(c[d]===b)return c.splice(d,1)},Fn:l.create("nokia.maps.map.provider.SpatialTileProvider#_paintCo",function(b){for(var b=b.that,c;c=b.Tf.shift();)if(c.paint(1),b.finishRequest(c.id,c),l.shallYield())return l.yield();return l.wait(b.bi)},
"that"),du:function(b){for(var c=b.length,d=0;c--;)d+=b[c].path.internalArray.length;return d},create:function(b,c,d,a){b=new g(a,this,new this.Ps[b](c,d),b);b.Hv();b.state!==!1&&(this.Zp||this.du(b.hi)<3E3?(b.paint(),this.finishRequest(a,b,!1,!0)):(this.Tf.push(b),l.signal(this.bi)));return b},fu:function(b,c){for(var d=this.Sm,a=this.Su,a=this.hn.requestBBox(c?new h(b.xyToGeo(-a,-a),b.xyToGeo(this.width+a,this.height+a),!0):new h(b.xyToGeo(0,0),b.xyToGeo(this.width,this.height),!0),1,c),e=a.length,
g=-1,l=[],p;++g<e;)(p=d?a[g]:a[g].getObject(!0))&&l.push(p);return l}})})();ovi.provide("nokia.maps.map.provider.ImgTileProvider");
(function(){var e=nokia.maps,l=e.dom,h=e.util.now,d=e.map.provider.Tile,c=l.imgLoader;nokia.maps.map.provider.ImgTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(c){this._super(c);if(!c||c.timeout===void 0)this.timeout=3E4},create:function(e,b,f,r,a){var q=this,k,m=new d(r,k=document.createElement("img"),q),e=q.getUrl(e,b,f),p;a?l.loadImg(k,e)!==!0?l.cancelImg(k):m.state=!0:(p=h(),c.request(k,e,function(a,b,c){m.state=b;q.finishRequest(r,m,!b&&h()-p>q.timeout,
c)}));return m},cancel:function(d){var b;(b=this._super(d))&&c.cancel(b.data);return b}})})();ovi.provide("nokia.maps.map.provider.ObjectTileProvider");
(function(e){var l=e.net.Request,h=e.map.provider.Tile;nokia.maps.map.provider.ObjectTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(d){this._super(d);this.qa=new l(d.requestType||l.JSONP);this.lb=[];this.ea=0},Statics:{XHR:l.XHR,JSONP:l.JSONP},Tu:e.dom.Page.browser.mobile?6:34,Aq:function(){for(var d=this,c=0,e=d.lb,b;c<e.length&&d.ea<=d.Tu;c++)b=e.shift(),d.qa.send(d.getUrl(b[0],b[1],b[2]),function(b,c){return function(a){if(!a.error&&!a.timeout)c.data=
a.response,c.state=!0,d.finishRequest(b,c);d.ea--;setTimeout(function(){d.Aq()},1)}}(b[3],b[4]),b[3]),d.ea++},create:function(d,c,e,b,f){var l=new h(b,!1,this);f?this.bb[l.id]?this.cancel(l.id):l.state=!0:(this.lb.push([d,c,e,b,l]),this.Aq());return l},cancel:function(d){var c,e=0,b=this.lb,f=this.lb.length;if(c=this._super(d))for(;e<f;e++)if(b[e][4]===c){this.finishRequest(d,c,!0,!0);b.splice(e,1);break}return c}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.Engine");
(function(e){function l(a,b){return a instanceof b}var h=[],d=Number.POSITIVE_INFINITY,e=nokia.maps,c=e.util,g=c.u,b=c.d,f=c.Nf,r=c.Vector3D,a=e.css.supportsTransition,q=self.clearTimeout,k=Math,m=k.pow,p=k.min,z=k.max,s=k.round,u=k.floor,w=k.LN2,x=k.log,v=k.abs,y=k.tan,B=k.sqrt,k=k.PI,C=c.Point,A=c.Pa,D=[].slice,E=e.geo,O=e.dom.Page.browser,I=E.mercator,L=y(35/180*k),N=k*6371E3,G=new C(256,256),M=[0,0,0,0],$=[-256,-256,-256,-256],F=O.mobile?50:0,Z=E.Coordinate,ba=E.BoundingBox,y=e.map,k=y.provider,
J=k.TileProvider,V=k.LocalObjectProvider,H=k.RemoteObjectProvider,P=k.ImageProvider,za=k.CanvasProvider,T=y.render,pa=T.p2d,fa=pa.capabilities,K=pa.Animation,da=fa.ZOOM,W=fa.COORD,ja=fa.SIZE,X=pa._helpers.geoToScreen,ab=0;pa.Engine=new ovi.Class({initialize:function(a,b,c,d){var d=d||{},f=this;f.c=ab++;f.uj="nma_p2d_"+f.c;f.hw(d.fading);f.sv=d.onViewChange||g;f.ov=d.onStateChange||g;f.nr=d.onValueExceeded||g;f.Ck=d.onTransition||g;f.mj=ovi.bind(f,f.mj);f.cb=new C(a.offsetWidth,a.offsetHeight);f.Ce=
f.Ke(f.t=a);f.C={latitude:0,longitude:0,altitude:0,heading:0,tilt:0,incline:0,zoom:0,distance:0};f.me={latitude:0,longitude:0,altitude:0,yaw:0,pitch:0,roll:0,fov:70};f.aa=new E.PixelProjection(I,2,2,1,1);f.ub=new C(0.5,0.5);f.Ud=[0,0,0,0];f.qr=new C(0,0);f.xb=new C(0,0);f.mc=new C(0,0);f.Bh=new e.map.render.InteractionRecorder;f.Lb=ovi.bind(f,f.Lb);f.Qe=ovi.bind(f,f.Qe);f.Mu=0;f.Nu=0;f.ud=2147483647;f.eg("busy");f.Ih=f.Ke(f.Ce,void 0,!1,!0);f.setMapProvider(b);f.$r(c);f.zu();f.xl();f.Nv=setTimeout(function(){d.onReady(f)},
1)},Statics:{TRANSITION:{AUTO:0,NONE:1,FADE:2,LINEAR:4,FLUID:8}},zu:function(){var a=this.t;a.style[e.css.Pw+"Transition"]+=","+e.css.$o+"transform .15s linear";a.addEventListener&&a.addEventListener(e.css.Cs,ovi.bind(this,this.cv),!1)},loadDestinationCam:function(a,b){var c=this.viewToCam(a);this.uo(a);this.Xs=!0;this.update(!0,!0);b(c)},setHandoverProperties:function(){},exit:function(a,b){this.onExit=b;a?this.setCam(a):(this.onExit(),this.onExit=void 0)},enter:function(a,b){this.onEnter=b;a?this.setCam(a):
(b.call(this),this.onEnter=void 0)},TRANSITION_START:1,TRANSITION:2,TRANSITION_END:4,capabilities:fa,sf:0,Lb:function(){var a=this;this.bk&&!--this.bk&&setTimeout(function(){a.eg("idle")},0)},Rl:function(a,b){return l(a,V)||l(a,H)||l(a,J)||l(a,P)||l(a,za)&&(!b||a.projection===this.aa.p)},cq:function(a){return this.Ce.childNodes[a+1]},Vs:function(a,b){for(var c=this.En,d,e=this.Td,f,g=e.length;g--;)f=e[g],d=c.get(g),this.Rl(d,!0)?f?l(d,V)&&f.op(a,b):this.Ke(this.t,f.shutdown(),!0,!1):f&&this.Ke(this.t,
f.shutdown(),!0,!0)},setMapProvider:function(a){var b=this.md,c=this.Jf,d,e,f=this.uc,g,k=this.aa,h={cssClass:this.uj};if(a!==b&&(g=this.Rl(a),this.Ih=d=this.Ke(this.Ce,this.Ih,!0,!g),c&&(c.shutdown(),this.Uk(b,!1),--this.sf),g?(this.Uk(a,!0),++this.sf,l(a,J)?(h.fading=this.rm,c=new this.Hj.MapLayer(d,a,h,this.Lb),e=a.projection,b=a.tileSize):c=new this.Hj.ObjectLayer(d,a,h,this.Lb,e=I,b=G)):b=c=void 0,f=this.En&&(e!==k.p||!b.equals(f)),this.md=a,this.Jf=c,k.p=e,this.uc=b,g))this.vs=b.x/b.y,this.Sk(this.ub),
this.qc(A(this.C.zoom,a.min,a.max)),f&&this.Vs(e,b)},Uk:function(a,b){a[(b?"add":"remove")+"Listener"]("update",this.Qe)},$r:function(a){var b,c,d=0;a?(b="add",this.En=a,this.Td=ovi.Array([])):(b="remove",a=this.En);for(c=a.getLength();d<c;)this.or(a,b,a.get(d),d),d++;a[b+"Observer"](this.or,this);this.update(!1,!0)},or:function(a,b,c,d){var a=this.Td,e,f=this.Rl(c),g={cssClass:this.uj};if(b==="add")e=this.Ke(this.Ce,this.cq(d),!1,!f),f&&(++this.sf,this.Uk(c,!0),(b=this.Ht(c,e,g))&&a.splice(d,0,b),
b?b.za():this.Ce.removeChild(e));else{if(b=a[d])this.Uk(c,!1),e=b.shutdown(),--this.sf;e=a[d]?e:this.cq(d);a.splice(d,1);this.Ce!==e&&e&&this.Ce.removeChild(e)}this.update(!1,!0)},Ht:function(a,b,c){var d=this.Hj,e=this.Lb;return l(a,V)||l(a,H)?new d.ObjectLayer(b,a,c,e,this.aa.p,this.uc):l(a,J)?new d.TileLayer(b,a,c,e):l(a,P)?new d.ImageLayer(b,a,0,e):l(a,za)?new d.CanvasLayer(b,a,e):void 0},uc:G,vs:1,Qe:function(){this.update(!1,!0)},tb:Math.pow(-2,53),Ol:function(a){var b=this.ud;if(b&&(++this.tb,
this.sv(this,b,a),a))this.ud=0},mj:function(){var a=this.state;this.Nl=0;if(a!==this.Kv)this.ov(this,this.Kv=a)},eg:function(a){if(a!==this.state&&(this.state=a,!this.Nl))this.Nl=setTimeout(this.mj,0)},shutdown:function(){this.Ha&&this.Ha.stop(!0);this.$r();this.setMapProvider();q(this.Nv);c.cancelAnimationFrame(this.Bd);q(this.bg);q(this.Nl);this.state="shutdown";this.mj()},je:function(a,b,c){var d=this.aa,e=this.ub,f=d.w,a=d.x+=a;e.x=(d.x=(a%f+f)%f)/f;e.y=(d.y+=b)/d.h;c||this.Ii(d.p.pointToGeo(e),
!0)},Sr:function(a,b){a.i=b;a.Xj={x:this.ub.x,y:this.ub.y}},Zw:function(){var a=this.Jf.e,b=this.aa,c=this.C.zoom;return scale=new nokia.maps.util.Point(b.w/(Math.pow(2,c)*a.uc.x),b.h/(Math.pow(2,c)*a.uc.y))},xl:function(){var a=this.cb,b=this.xb,c=this.mc,d=this.Ud,e=d[0],f=d[3],g=a.x-f-d[1],a=a.y-e-d[2],d=this.qr;b.x=c.x=s(g/2+f);b.y=c.y=s(a/2+e);this.za(this.Ih);d.x=z(g,0);d.y=z(a,0);this.$n();this.update(!0)},resize:function(a,b){this.cb.x=a;this.cb.y=b;this.ud|=ja;this.xl()},setPadding:function(a,
b,c,d){this.Ud.splice(0,4,+a||0,+b||0,+c||0,+d||0);this.tb++;this.xl()},suspend:function(){this.eg("suspended")},resume:function(){this.eg("idle")},type:"2d",rm:0,hw:function(a){this.rm=O.mobile?0:+a},lg:0,setTransition:function(a,b){this.lg=a;this.Qo=b},getView:function(){return this.C},Sk:function(a,b){var c=this.ub,d=this.aa;d.x=d.w*(c.x=a.x);d.y=d.h*(c.y=a.y);b||this.Ii(d.p.pointToGeo(c),!0)},Ii:function(a,b){var c=this.C,d=this.me;b||this.Sk(this.aa.p.geoToPoint(a),!0);if(c.latitude!==a.latitude||
c.longitude!==a.longitude)c.latitude=d.latitude=a.latitude,c.longitude=d.longitude=a.longitude,this.ud|=W;this.$n();this.update(!1,!0)},$n:function(){this.ca=this.pr=this.Nq=0},Ki:function(a,b,c,d,e){var f=this;f.Ha&&f.Ha.isRunning&&(f.Ha.stop(e),f.Ck(f.TRANSITION_END));f.Ck(f.TRANSITION_START);f.Ha=new K(function(){a.apply(a,arguments);f.Ck(f.TRANSITION)},function(){b&&b.apply(b,arguments);f.Ck(f.TRANSITION_END)},c,d);f.Ha.start()},iq:function(){var a;if(this.onExit)a=this.onExit,this.onExit=void 0,
a();if(this.onEnter)a=this.onEnter,this.onEnter=void 0,a();this.Ol()},su:function(a){var b=this.C;return b.latitude===a.latitude&&b.longitude===a.longitude&&(!isNaN(a.zoom)&&b.zoom===a.zoom||!isNaN(a.distance)&&b.distance===a.distance)},setView:function(a){var b=this,c=b.C.zoom,d=(a.zoom!==void 0?a.zoom:b.km(a.distance))-c,e,f=!0,g,k;b.lg===pa.Engine.TRANSITION.AUTO&&b.yp(a)&&!b.su(a)?b.Ki(function(h){f&&(e=c+h*d,b.oj(e)?f=!1:b.qc(c+h*d));g=b.aa.p.geoToPoint(a);k=b.ub;b.Sk(new C(k.x+(g.x-k.x)*h,k.y+
(g.y-k.y)*h));b.update(!0,!0)},function(){b.uo(a);b.iq()},null,b.Qo):(b.uo(a),b.iq());return b.C},uo:function(a){this.lg=pa.Engine.TRANSITION.NONE;this.setCoord(a);isNaN(a.distance)?this.qc(a.zoom):this.setDistance(a.distance);this.lg=pa.Engine.TRANSITION.AUTO},setCoord:function(a){var b=this,d=b.aa.geoToPixel(a),e=b.aa.geoToPixel(b.C),f=d.x-e.x,g=d.y-e.y,k,h,l=0;a&&Z.isValid(a.latitude,a.longitude,a.altitude)&&!(b.C.latitude===a.latitude&&b.C.longitude===a.longitude)?b.lg===pa.Engine.TRANSITION.AUTO&&
b.yp(a)?b.Ki(function(a){k=e.x+(a-l)*f;h=e.y+(a-l)*g;b.je(k,h);b.update(!0,!0);l=a},function(){b.Ii(a)},c.animation.easeFunctions.EASE_OUT_QUAD,b.Qo):b.Ii(a):a=b.C;return new Z(a.latitude,a.longitude,a.altitude)},yp:function(a){var b=this.aa.geoToPixel(this.C),a=this.aa.geoToPixel(a);return v(a.x-b.x)<=this.cb.x&&v(a.y-b.y)<=this.cb.y},yl:function(a,b,c){c=c.width;return x((b.w=b.h=m(2,s(x(b.w/c)/w))*s(c*m(2,a-s(a))/2)*2)/256)/w},qc:function(a,b,c){var d=this.C,e=this.aa,f=b!==void 0,g=this.xb,a=
A(a,this.md.min,this.md.max);if(f)this.mc.x=b,this.mc.y=c,this.je(b-=g.x,c-=g.y,!0);e.w=m(2,a+8);a=this.yl(a,e,this.md);if(a!==this.C.zoom)d.zoom=a,d.distance=this.bj(a),this.ud|=da;this.me.altitude=d.distance+(d.altitude||0);this.Sk(this.ub,!0);f?(a=this.Ph(-c),this.je(-b,a,!1)):(this.$n(),this.update(!1,!0))},setZoom:function(a,b,c){var d=this,e=d.C,f=d.C.zoom,g=a-f,k=d.md;if((a=A(a,k.min,k.max))!==e.zoom&&!isNaN(a))d.lg===pa.Engine.TRANSITION.AUTO?d.Ki(function(a){d.qc(f+a*g,b,c);d.update(!0,!0)},
function(){d.qc(a,b,c)},null,d.Qo,!0):d.qc(a,b,c);return e.zoom},getZoom:function(){return this.C.zoom},bj:function(a){var b=this.md;return A(N/m(2,a)/L,N/m(2,b.max)/L,N/m(2,b.min)/L)},km:function(a){return A(-(x(a*L/N)/w),this.md.min,this.md.max)},setDistance:function(a,b,c){var d=this.C;p(z(a,0),1/0)===a&&this.qc(this.km(a),b,c);return d.distance},setHeading:function(){return this.C.heading},setTilt:function(){return this.C.tilt},setIncline:function(){return this.C.incline},uh:function(a){return a===
this.Ud?this.pr||(this.pr=this.Ug(a)):a===$?this.Nq||(this.Nq=this.Ug(a)):a===M||!a?this.ca||(this.ca=this.Ug(M)):this.Ug(a)},Ug:function(a){var b=this.cb,c=this.xb,d=a[0]-c.y,e=a[3]-c.x,f=b.y-c.y-a[2],a=b.x-c.x-a[1],b=this.aa;e>a&&(e=a=0);d>f&&(d=f=0);d=b.pixelToGeo({x:e,y:d});f=b.pixelToGeo({x:a,y:f});if(a-e>=b.w)d.longitude=-(f.longitude=180);return new ba(d,f)},Ph:function(a){var b=this.aa,c;c=(b.y+a)/b.h;c<0?a=-b.y:c>1&&(a=b.h-b.y);return a},xt:function(a,b,c,d){var c=a-c,e=b-d,d=B(m(c,2)+m(e,
2));a-=c/2;b-=e/2;d=x(m(2,this.Bu)*(d/this.Au))/w;this.oj(d,a,b)||v(this.C.zoom-d)>=0.1&&this.qc(d,a,b)},ut:function(a,b,c,d){this.je(this.Mj+(this.tq-this.Mj)/2-(a+(c-a)/2),this.Ph(this.Nj+(this.uq-this.Nj)/2-(b+(d-b)/2)))},getBBox:function(){return this.uh(this.Ud)},getCenter:function(){return new Z(this.C.latitude,this.C.longitude,void 0,!0)},camToView:function(a){var b=Z.fromObject([a.latitude,a.longitude,0,a.altMode]),a=b.distance(new Z(a.latitude,a.longitude,a.altitude,!1,a.altMode),!0),c=this.km(a),
a=this.bj(c);return ovi.extend({},this.C,b,{distance:a,zoom:c})},getCam:function(){return this.me},setCam:function(a){this.setView(this.camToView(a));return this.getCam()},setCamCoord:function(a){this.Ii(a);return new Z(a.latitude,a.longitude,a.altitude,!0)},setYaw:function(){return this.me.yaw},setPitch:function(){return this.me.pitch},setRoll:function(){return this.me.roll},viewToCam:function(a){var b=a.distance,b=+b===b?b:this.bj(a.zoom),a=Z.fromObject([a.latitude,a.longitude,b,a.altMode]);return ovi.extend({},
this.me,a)},ku:function(a,b,c){var d=this.aa,e=ovi.extend({},this.C),f=d.w;if(a||b)b=this.Ph(-b*91.401472),a={x:(a*91.401472+d.x)%f/f,y:(d.y+b)/d.h},d=d.p.pointToGeo(a),e.latitude=d.latitude,e.longitude=d.longitude;if(c)e.zoom+=c,e.distance=this.bj(e.zoom);e.distance=this.bj(e.zoom);return e},Zs:function(a,b,c,d){var e=this.C,d=d||1;if(a||b)b=this.Ph(-b*91.401472*d),this.je(a*91.401472*d,b);c&&(a=e.zoom+c*d,this.oj(a)||this.qc(a));this.update(!0,!0)},oj:function(a){var b=this.md;return a>b.max?(this.C.zoom!==
b.max&&this.qc(b.max),this.nr(da,a),!0):a<b.min?(this.C.zoom!==b.min&&this.qc(b.min),this.nr(da,a),!0):!1},qj:!1,beginControl:function(a,b,c,d){this.qj=D.call(arguments,0);this.Wj=b;this.Bt=ovi.extend({},this.getView());this.$w=c;this.ax=d;this.Ha&&this.Ha.isRunning&&this.Ha.stop(!0)},control:function(a,b,c,e,f,g,k,h){var l=this,m=l.C,p,e=e||h;if(l.qj)l.Ki(function(a,d,f){p=m.zoom+e*f;l.oj(p)?e=0:l.Zs(b,c,e,f);if(this!==l.Ha)return!0},null,null,d),l.Dt=b,l.Et=c,l.Ft=e,l.cx=h},endControl:function(a){var b=
this.Wj,c,d,f,g=this.C;d=!1;if(this.qj)this.qj=!1,this.Ha&&this.Ha.isRunning&&this.Ha.stop(),b&&(c=new r(this.Dt,this.Et,this.Ft),d=c.normalize(),f=c.magnitude(),c=typeof b.duration==="function"?b.duration(f):600,b=typeof b.power==="function"?b.power(f):1,f*=b,b=new e.map.render.KineticMove(f,-(f/c)),b=b.getPath(c),d=this.ku(d.x*b,d.y*b,d.z*b)),a=typeof a==="function"?a(this.Bt,g):d,a!==!1&&(this.setTransition(pa.Engine.TRANSITION.NONE,c),this.setView(a),this.setTransition(pa.Engine.TRANSITION.AUTO,
c))},Ws:function(a){if(a&=fa.ui)for(var b=a&W,c=W,d=0;c>>=1;){if(a&c&&(b|=c,++d>1))break}else b=W;return b},beginInteraction:function(a,b,c,d,e,f,g){if(this.Nm)this.nm=null,this.Ha&&this.Ha.isRunning&&this.Ha.stop(),this.endInteraction();if(this.Lj=this.Ws(a)){this.Nm=!0;this.Mj=d;this.Nj=e;if(f===+f&&g===+g)this.tq=f,this.uq=g;this.Au=B(m(d-f,2)+m(e-g,2));this.Bu=this.C.zoom}if(this.Wj=b)this.Bh.reset(),this.Bh.recordXY(c,d,e)},interact:function(a,b,c,e,f){var g,k;if(this.Nm&&(!this.Dq||a-this.Dq>
F)){if(a!==d)this.Dq=a;e===+e&&f===+f?(this.Lj&W&&this.ut(b,c,e,f),this.Lj&da&&this.xt(b,c,e,f),this.tq=e,this.uq=f):this.Lj&W&&(g=this.Ph(this.Nj-c),k=this.Mj-b,this.je(k,g));this.Mj=b;this.Nj=c;this.Wj&&this.Bh.recordXY(a,b,c,e,f)}},endInteraction:function(a){var b=this,c=b.Wj,d=b.aa,f,g,k,h,l,m,p;c&&(f=b.Bh.getInteractionDirection(a),h=b.Bh.getInteractionSpeed(a),g=typeof c.duration==="function"?c.duration(h):600,a=typeof c.power==="function"?c.power():1,l=h*a,p=new e.map.render.KineticMove(l,
-(l/g)),!isNaN(f.x)&&!isNaN(f.y)&&l>0&&b.Ki(function(a){l=p.getValue(a*g);if(b.Lj&W&&!isNaN(l)){m=-f.y*l;k=(d.y+m)/d.h;if(k<0||k>1)f.y=-f.y,m=-f.y*l;b.je(s(-f.x*l),s(-f.y*l),!1);b.update(!0,!0)}},null,c.ease,g));b.Nm=!1},setPointer:g,screenToGeo:function(a,b){return this.aa.pixelToGeo(new C(a-this.xb.x,b-this.xb.y))},geoToScreen:function(a){return X(a,this.aa).add(this.xb).round()},convertAlt:function(a,b){var c=a.altMode||"GL";return c===(b||"GL")?a.altitude:NaN},viewForXY:function(a,b){return ovi.extend({},
this.C,this.aa.pixelToGeo(new C(a-this.xb.x,b-this.xb.y)))},viewForBBox:function(a){var b=fa.view.zoom.max,c=ovi.extend({},this.C,a.getCenter()),d,e,f=this.qr,g;a.isEmpty()||(e=new E.PixelProjection(this.aa.p,d=m(2,b),d*this.vs),g=e.geoToPixel(a.topLeft),e=e.geoToPixel(a.bottomRight),b-=8+z(x(a.isCDB?d-g.x+e.x:e.x-g.x)/w-x(f.x)/w,x(e.y-g.y)/w-x(f.y)/w));c.zoom=u(b);c.distance=NaN;return c},viewFor:function(a){for(var b=[],c=a.length;c--;)b.push(a[c].getBoundingBox());return this.viewForBBox(ba.merge(b))},
getObjectAt:function(a,b){return this.Ib(a,b,!0)[0]},getObjectsAt:function(a,b){return this.Ib(a,b,!1)},Ib:function(a,b,c){var d=pa.ObjectLayer,e=this.Td,g=e.length,k,l,m,p=!1,q=this.aa,r=this.xb;a-=r.x;b-=r.y;for(c=!!c;g--;)if((k=e[g])&&k instanceof d)if(l=k.Ib(a,b,f((q.x+a)/q.w,1),f((q.y+b)/q.h,1),c),l.length){if(c)break;m=p?m.concat(l):l;p=!0}return m||l||h},getObjectsWithin:function(a,b,c,d){for(var e=this.cb,a=this.Ug([b,e.x-c,e.y-d,a]),b=this.Td,c=b.length,d=[];c--;)e=b[c],e.bq&&(e=e.bq(a))&&
e.length&&(d=d.concat(e));return d},capture:function(a,b,c,d){var f=this.cb,a=A(a||0,0,f.x),b=A(b||0,0,f.y),c=A(c||f.x,a,f.x),d=A(d||f.y,b,f.y),f=(new e.gfx.Graphics).beginImage(c-a,d-b,"capture"),g=this.Td,k=g.length,h;this.Jf.capture(f,a,b,c,d);for(h=0;h<k;h++)g[h].capture(f,a,b,c,d);return f},preload:function(a,c){a||b("view");return new T.Preloader([],c)},bounce:function(b,c,d){a()&&(c&&d&&(this.t.style[e.css.getVendorJsProperty("transformOrigin")]=[c,"px ",d,"px"].join("")),this.t.style[e.css.getVendorJsProperty("transform")]=
"matrix("+(!b?".9, 0, 0, .9, 0, 0":"1.1, 0, 0, 1.1, 0, 0")+")")},cv:function(a){if(/\btransform$/.test(a.propertyName))a=a.target.style,a[e.css.getVendorJsProperty("transform")]!=="matrix(1, 0, 0, 1, 0, 0)"?a[e.css.getVendorJsProperty("transform")]="matrix(1, 0, 0, 1, 0, 0)":this.Ww=!0}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.ObjectLayer");
(function(e){var l=[],h=e.map.provider,d=h.SpatialTileProvider,c=h.LocalObjectProvider;e.map.render.p2d.ObjectLayer=new ovi.Class({initialize:function(d,b,e,h,a,l){this.$j=e;this.Qf=ovi.bind(this,this.Qf);this.o=d;this.e=b;this.qu=b instanceof c;this.La=h;this.op(a,l);this.Hp()},op:function(c,b){var e=this.Wk;if(this.Pn!==c||!b.equals(this.uc))this.Pn=c,this.uc=b,e&&e.shutdown(),this.Wk=new d(this.e,{projection:c,width:b.x,height:b.y}),this.Ip(),this.Wk.Zp=1},ps:0,Qf:function(c){(this.ps|=c===this.Pb?
1:2)===3&&this.La(this,!1)},shutdown:function(){this.La=e.util.u;this.Pb.shutdown();this.Ie.shutdown();e.dom.Ob(this.o);return this.o},za:e.util.u,stop:function(){this.Pb.stop();this.Ie.stop()},render:function(c,b,d,e,a,h,k,l,p,z,s,u,w,x){var v=this.Pb.render(c,b,d,e,a,h,k,l,p,z,s,u,w,x),c=this.Ie.render(c,b,d,e,a,h,k,l,p,z,s,u,w,x);this.ps=0;return v&&c},Ib:function(c,b,d,e,a){c=this.Ie.Ib(c,b,a);if(!a||!c.length)c=c.concat(this.Pb.Ib(d,e,a));return c},bq:function(c){var c=this.e.requestBBox(c,3),
b;if(!this.qu)for(b=result.length;b--;)c[b]=c[b].getObject();return c||l},capture:function(c,b,d,e,a){this.Pb.capture(c,b,d,e,a);this.Ie.capture(c,b,d,e,a)}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.canvas.ObjectLayer");
(function(){var e=nokia.maps.map.render.p2d,l=e.canvas,h=l.MarkerLayer,d=l.SpatialTileLayer;l.ObjectLayer=new ovi.Class({Extends:e.ObjectLayer,za:function(){this.Pb.za();this.Ie.za()},Hp:function(){this.Ie=new h(this.o,this.e,this.$j,this.Qf)},Ip:function(){this.Pb=new d(this.Pb?this.Pb.shutdown():this.o,this.Wk,this.$j,this.Qf)}})})();ovi.provide("nokia.maps.map.overlay.TrafficIncidentsProvider");
(function(e){var l=e.util.Event,h=e.gfx.BitmapImage,d={x:12,y:12};nokia.maps.map.overlay.TrafficIncidentsProvider=new ovi.Class({Extends:e.map.provider.RemoteObjectProvider,initialize:function(c){var d=this.tileSize,b;this._super(c);b=1<<this.max;this.$k=new e.map.provider.ObjectTileProvider(c);this.oq=this.gt();this.bb={};this.Jc={};this.wu=new e.language.Manager;this.$k.addListener("response",this.ya=ovi.bind(this,this.ya));this.Pn=new e.geo.PixelProjection(nokia.maps.geo.mercator,d*b,d*b)},tileSize:256,
width:256,height:256,ya:function(c){var d=c.data[1],b=c.data[0],e=this.bb,h,a;delete this.Jc[b];for(h in e){a=e[h];c=a.Wd.indexOf(b);if(c!==-1)a.Wd.splice(c,1),a.$f=a.$f.concat(this.On(d));if(!a.Wd.length)c=new l("response"),c.data=[h,a.$f],this.dispatch(c),delete e[h]}},gt:function(){var c=e.loadPath+"assets/ovi/mapsapi/ui/images/trafficitems/";return{CONSTRUCTION:new h(c+"construction.png",function(){},24,24),EVENT:new h(c+"event.png",function(){},24,24),"MASS TRANSIT":new h(c+"masstransit.png",
function(){},24,24),INCIDENT:new h(c+"incident.png",function(){},24,24)}},requestBBox:function(c,d,b,e){if(d!==2)return!1;var d=this.Gj(c,b),h=this.bb[d];h?!e&&h.ea++:e||(h=this.bb[d]={ea:1,$f:[],Wd:new ovi.Array});if(h&&h.Wd.length&&h.ea>1&&!e)return!0;return this.Sv(c,b,e)},cancelBBoxRequest:function(c,d,b){var d=this.bb,c=this.Gj(c,b),e=d[c],h=this.Jc,a;if(e&&(b=e.Wd,a=b.length,e.ea--,!e.ea)){for(;a--;)e=b[a],h[e]===1?(this.$k.cancel(e),h[e]=void 0):h[e]--;delete d[c]}},Sv:function(c,d,b){var e=
this.aq(c,d),h=e[0],a=e[1],l=e[2],e=e[3],c=this.Gj(c,d),k,m,p,z,s=this.Jc,u=[];for(m=h;m<l+1;m++)for(p=a;p<e+1;p++)if(z=this.$k.request(d,m,p,b),b)z&&(u=u.concat(z.data.proxies||this.On(z)));else if(k=this.bb[c],z===!0)h=this.$k.createId(d,m,p,!0),z&&k.Wd.indexOf(h)===-1&&(k.Wd.push(h),this.Jc[h]?s[h]++:s[h]=1);else if(z!==!1)k.$f=k.$f.concat(z.data.proxies||this.On(z));if(b)return u;else{if(!k)return!1;return k.Wd.length?!0:(u=k.$f,delete this.bb[c],u)}},Gj:function(c,d){return this.aq(c,d).join("_")},
aq:function(c,d){var b=this.max,e=this.tileSize,h=this.Pn,a=h.geoToPixel(c.topLeft),h=h.geoToPixel(c.bottomRight);return[a.y/e>>b-d,a.x/e>>b-d,h.y/e>>b-d,h.x/e>>b-d]},getInvalidations:function(c,d){return c.getInvalidations(d)},On:function(c){var g=c.data,b,f,h,a,l=[];if(g.TRAFFICITEMS&&g.TRAFFICITEMS.TRAFFICITEM){f=g.TRAFFICITEMS.TRAFFICITEM;for(g=f.length;g--;)if(b=f[g],b.LOCATION&&b.LOCATION.GEOLOC&&b.LOCATION.GEOLOC.ORIGIN)h=new e.geo.Coordinate(b.LOCATION.GEOLOC.ORIGIN.LATITUDE,b.LOCATION.GEOLOC.ORIGIN.LONGITUDE),
a="",b.TRAFFICITEMDESCRIPTION&&(a+=b.TRAFFICITEMDESCRIPTION[1].content+"<br/>"),b.CRITICALITY&&b.CRITICALITY.DESCRIPTION&&(a+=this.wu.translateToken("ovi.service.map._t90")+": "+b.CRITICALITY.DESCRIPTION),h=new e.map.Marker(h,{icon:this.oq[b.TRAFFICITEMTYPEDESC]||this.oq.INCIDENT,anchor:d,isRemote:!0,$content:a}),h.e=this,b=h.ad(),b[h.CHANGE_SPATIAL]=b[h.CHANGE_VISUAL]=b[h.CHANGE_ZINDEX]=this.tb,l.push(function(a){return{getObject:function(){return a}}}(h))}return c.data.proxies=l},Dc:function(){this.update();
return++this.tb},adopt:function(){return!1},orphan:function(){return!1}})})(nokia.maps);ovi.provide("nokia.maps.map._packaging.package");ovi.provide("nokia.maps.map.render.p2d.dom.ObjectLayer");
(function(){function e(c){c=c.appendChild(c.ownerDocument.createElement("div"));c.style.position="absolute";c.style.zIndex=0;return c}var l=nokia.maps.map.render.p2d,h=l.dom,d=h.MarkerLayer,c=h.SpatialTileLayer;h.ObjectLayer=new ovi.Class({Extends:l.ObjectLayer,Hp:function(){this.Ie=new d(e(this.o),this.e,this.$j,this.Qf)},Ip:function(){this.Pb=new c(this.Pb?this.Pb.shutdown():e(this.o),this.Wk,this.$j,this.Qf)}})})();ovi.provide("nokia.maps.map.render.p2d.canvas.Engine");
(function(){var e=nokia.maps,l=e.util,h=l.requestAnimationFrame,d=[-256,-256,-256,-256],e=e.map.render.p2d,c=e.canvas;c.Engine=new ovi.Class({Extends:e.Engine,initialize:function(c,b,d,e){this.pa=ovi.bind(this,this.pa);this.Ok=ovi.bind(this,this.Ok);this.Zn=ovi.bind(this,this.Zn);this._super(c,b,d,e)},Statics:{TRANSITION:e.Engine.TRANSITION},Hj:c,Ke:function(c){if(!this.o)this.o=c.ownerDocument.createElement("canvas"),this.Vr(c),this.o.style.position="absolute",this.ne=this.o.getContext("2d"),c.appendChild(this.o);
return this.o},za:function(){var c=this.Td,b=c.length;this.Vr(this.t);for(this.Jf.za();b--;)c[b].za();this.update(!0)},Vr:function(){var c=this.cb.y;this.o.width=this.cb.x||1;this.o.height=c||1},update:function(c,b){if(!this.Ah){this.Ah=!0;this.Ol(!0);if(c)this.pa(b);else{if(!this.Bd)this.Bd=h(this.Ok);if(!this.bg)this.bg=setTimeout(this.Zn,150)}this.Ah=!1}},Ok:function(){this.pa(!0);this.Bd=h(this.Ok)},Zn:function(){this.pa(!1);this.bg=0},pa:function(c){var b,e,h=this.Td,a=h.length;e=this.cb;var l=
this.xb;this.eg("busy");this.ne.clearRect(0,0,e.x,e.y);this.bk=this.sf;(b=this.Jf)&&b.render(this.C.zoom,this.ub,this.aa,this.Ud,this.cb,l,this.uh(d),0,0,0,this.C.zoom,c,this.mc,this.tb);for(e=0;e<a;)(b=h[e++])&&b.render(this.C.zoom,this.ub,this.aa,this.Ud,this.cb,l,this.uh(d),0,0,0,void 0,c,this.mc,this.tb);if(!c)this.mc.x=l.x,this.mc.y=l.y},Lb:function(c){this._super(c);this.update(!1,!0);if(!this.bk)l.cancelAnimationFrame(this.Bd),this.Bd=0}})})();ovi.provide("nokia.maps.map.js.enterpriseTileProviders");
(function(){function e(a,e,h,l,r){return new d.ImgTileProvider({timeout:-1,label:e,descr:h,min:l||0,max:r||20,alpha:!1,opacity:1,uri:a,config:new g,getUrl:function(a,c,d){var e,g=this.config.get("secureConnection");if(!this.Ku){e=(b.defaultLanguage||"en").substr(0,2);if(q[e])this.Vm=q[e];this.Ku=!0}return f.addNlpParams((g=="prefer"||g=="force"?"https://":"http://")+[(this.config.get("dontUseSubdomains")!=="force"?(c+d)%4+1+".":"")+this.config.get("map.tileprovider."+this.uri+".baseUrl"),a,d,c,"256/png8"].join("/")+
"?"+(this.Vm?"lg="+this.Vm:""),!0)},getCopyrights:function(b,d){return c.copyrights.get(a==="grey"||a==="publictransport"||a==="traffic"?"normal":a,b,d)},setTileLanguage:function(a){this.Vm=a;this.update()}})}function l(){var c,d,e,f=b.serviceMode,g={};for(c in r)r.hasOwnProperty(c)&&(e=c.split(".")[0],d=r[c],g[c]=d.replace("{service}",a[e]).replace("{serviceMode}",f?"."+f:""));nokia.maps.Config.setDefaultsNS("map.tileprovider",g)}var h=nokia.maps,d=h.map.provider,c=h.map.js,g=h.Config,b=h.util.getRootNameSpace("nokia.maps").Settings,
f=nokia.maps.util.services,r,a={normal:"base",grey:"base",publictransport:"base",traffic:"traffic",trafficincidents:"traffic",satellite:"aerial",terrain:"aerial",hybrid:"aerial"},q={zh:"CHI",es:"SPA",fr:"FRE",it:"ITA",de:"GER",ru:"RUS"},h=e("traffic","Traffic Map","Show traffic",0,20),h=c.enterpriseTileProviders={base:[e("normal","Map","Show street map"),e("hybrid","Hybrid","Show hybrid imagery"),e("satellite","Satellite","Show satellite imagery"),e("terrain","Terrain","Show terrain map"),e("grey",
"Smart Map","Show smart map"),e("publictransport","Public Transit Map","Show public transport"),h],overlays:[function(a,b,d){return new nokia.maps.map.overlay.TrafficIncidentsProvider({label:b,descr:d,min:8,max:20,alpha:!0,updateCycle:180,opacity:1,uri:a,criticality:"0,1",config:new g,getUrl:function(a,b,c){for(var d=this.config.get("secureConnection"),e=[],g;a-- >0;)g=1<<a,e.push(((c&g)!==0)+((b&g)!==0)*2);return f.addNlpParams((d==="prefer"||d==="force"?"https://":"http://")+this.config.get("map.tileprovider."+
this.uri+".baseUrl")+"?profile=NTprtls&criticality="+this.criticality+"&quadkey="+e.join(""),!0)},getCopyrights:function(a,b){return c.copyrights.get(this.uri,a,b)}})}("trafficincidents","TrafficIncidents","Show traffic incidents"),h]};h.constants={NORMAL:h.base[0],SATELLITE:h.base[1],SATELLITE_PLAIN:h.base[2],TERRAIN:h.base[3],SMARTMAP:h.base[4],SMART_PT:h.base[5],TRAFFIC:h.base[6],TRAFFIC_INCIDENTS:h.overlays[0]};r={"normal.baseUrl":"{service}.maps{serviceMode}.api.here.com/maptile/2.1/maptile/newest/normal.day",
"hybrid.baseUrl":"{service}.maps{serviceMode}.api.here.com/maptile/2.1/maptile/newest/hybrid.day","satellite.baseUrl":"{service}.maps{serviceMode}.api.here.com/maptile/2.1/maptile/newest/satellite.day","terrain.baseUrl":"{service}.maps{serviceMode}.api.here.com/maptile/2.1/maptile/newest/terrain.day","publictransport.baseUrl":"{service}.maps{serviceMode}.api.here.com/maptile/2.1/maptile/newest/normal.day.transit","grey.baseUrl":"{service}.maps{serviceMode}.api.here.com/maptile/2.1/maptile/newest/normal.day.grey",
"traffic.baseUrl":"{service}.maps{serviceMode}.api.here.com/maptile/2.1/traffictile/newest/normal.day","trafficincidents.baseUrl":"{service}{serviceMode}.api.here.com/traffic/6.0/incidents.json"};l();b.addObserver("serviceMode",l)})();ovi.provide("nokia.maps.map.render.p2d.dom.Engine");
(function(){var e=nokia.maps,l=e.dom,h=e.util,d=h.Coroutine,c=new h.Matrix3D,g=e.css,b=g.applyMatrix,f=Math,r=f.log,a=f.LN2,q=f.round,k=[-256,-256,-256,-256],e=e.map.render.p2d,f=e.dom;f.Engine=new ovi.Class({Extends:e.Engine,initialize:function(){this.Yn={};this.Ir=this.Qv(this);this.ck=c;this._super.apply(this,arguments)},Statics:{TRANSITION:e.Engine.TRANSITION},Hj:f,setMapProvider:function(a){var b=this;b._super(a);l.eq(b.Ih.ownerDocument,function(a){b.Nw(a,b.rm)})},shutdown:function(){this._super();
d.kill(this.Ir)},us:null,Nw:function(a,b){var c=this.Ih.className=this.uj+"MapLayer",d=null;b>0&&(b/=1E3,d=l.jp(a,"."+c+" ."+this.uj+"Tile",g.$o+"transition: opacity "+b+"s linear;position: absolute;"));l.Er(a,this.us);this.us=d},Ke:function(a,b,c,d){var e=a.ownerDocument;d?d=e.createComment("comment"):(d=e.createElement("div"),d.style.position="absolute",d.style.zIndex=0);c?a.replaceChild(d,b):a.insertBefore(d,b||null);return d},update:function(a,b){var c=this,e=c.Ir,f=e.scope;if(c.Xs&&!c.Ah){c.Ah=
!0;c.Ol(!0);if(a)f.cacheOnly=b,e.run(!0,!0);else{if(b){var g=function(){f.cacheOnly=!0;d.signal(c.Yn);c.Bd=h.requestAnimationFrame(g)};!c.Bd&&g()}h.cancelAnimationFrame(c.Bd);c.Bd=0;if(!c.bg)c.bg=setTimeout(function(){f.cacheOnly=!1;d.signal(c.Yn);c.bg=0},300)}c.Ah=!1}},Qv:d.create("nokia.maps.map.render.p2d.Engine#_renderCo",function(e){var f=e.that,g=e.cacheOnly,h,l=e.i,w=f.Td,x=w.length;h=e.Xj;var v=f.xb;h&&h.x!==f.ub.x&&h.y!==f.ub.y&&(l=void 0);f.eg("busy");if(l===void 0&&(f.bk=f.sf,h=f.Jf))b(h.o,
f.ck=c.translate(v.x,v.y,0)),h.render(f.C.zoom,f.ub,f.aa,f.Ud,f.cb,v,f.uh(k),0,0,0,f.C.zoom-q(r(h.e.width/256)/a),g,f.mc);l=l||0;if(!g&&d.shallYield())return f.Sr(e,l),d.yield();for(;l<x;){if(h=w[l++])b(h.o,f.ck),h.render(f.C.zoom,f.ub,f.aa,f.Ud,f.cb,v,f.uh(k),0,0,0,void 0,g,f.mc,f.tb);if(!g&&l!==x&&d.shallYield())return f.Sr(e,l),d.yield()}if(!g)f.mc.x=v.x,f.mc.y=v.y;e.i=e.Xj=void 0;f.Mu=f.Nu=0;return d.wait(f.Yn)},"that"),za:function(a){b(a,this.ck=this.ck.translate(this.xb.x,this.xb.y,0))}})})();
ovi.provide("nokia.maps.map.Display");
(function(e){var l=e.css,h=e.util,d=h.Point,c=Math,g=c.max,b=e.dom.Page.browser,f=c.round,r=h.Pa,a=h.d,c=e.gfx,q=c.Painter.defaultPainter===c.CanvasPainter,k=e.map,m=k.render.Capabilities.prototype,p=e.geo.Coordinate,z=e.dom,s={add:"attach",remove:"detach"},u=ovi.buildNS(e.config.tileProviders),w=k.Display=new ovi.Class({Extends:k.Container,initialize:function(a,b){var c=this,f,g,b=b||{};g=p.fromObject(b.center||b.view||[0,0]);f=b.view?b.view:g?ovi.extend({zoom:b.zoomLevel||0,altitude:0},g):{latitude:0,
longitude:0,altitude:0,zoom:0};b.center=g;c.default2dRenderMode=b.default2dRenderMode||c.default2dRenderMode;c.Wm=0;c.Kf=0;c.Hf=!0;c.P=new k.Ms;e.util.getRootNameSpace("nokia.maps").Settings.lockLanguage();e.map.js.copyrights.loadCopyright();c.availableBaseMapTypes=new h.OList(u.base);u.constants.PANORAMA&&u.constants.PANORAMA.setBaseUrl();g=b&&b.baseMapType||c.availableBaseMapTypes.get(0);c.availableOverlays=new h.OList(u.overlays);c.overlays=new h.OList;c.om=new h.OList;c.overlays.addObserver(c.vv,
c);c.zt(a);c.f=new d(c.da.offsetWidth,c.da.offsetHeight);c.wj=c.f.divide(2).round();c.tn=ovi.bind(c,c.tn);c.qn=ovi.bind(c,c.qn);c.sn=ovi.bind(c,c.sn);c.rn=ovi.bind(c,c.rn);c.pn=ovi.bind(c,c.pn);c.addObserver("baseMapType",ovi.bind(c,c.av));c.Pd=f;c.copyrightPosition=c.poweredByPosition=new d(0,0);c.fading="fading"in b?b.fading:150;c.components=new h.OList;c.components.addObserver(c.tt,c);c.set("baseMapType",g);c.components.Rs=c.components.N;c.components.N=function(a,b,c){for(var d=this.ia,e=d.length,
f=a.getId();e--;)d[e].getId()===f&&h.d('Component instance with ID "'+f+'" already registered');this.Rs(a,b,c)};g=b.components;delete b.components;b.viewBounds&&(delete b.center,delete b.zoomLevel,delete b.view,delete b.cam);c._super(b);c.om.add(new k.provider.LocalObjectProvider(this,{min:-8,max:22}));f=c.parentDisplay;c.sj=(c.nx=f&&f.visibility&&f.width>c.width&&f.height>c.height)?null:e.map.gp&&new e.map.gp(c);c.ud=0;c.$m=0;if(g)c.components.addAll(g),b.components=g;c.addListener("mouseleave",
c.so);c.addListener("mousemove",c.so);c.insertListener("drag",c.so);c.Hg=ovi.bind(c,c.Hg);c.addListener("mapvalueexceeded",c.Hg,!1);c.addObserver("bounceEnabled",function(a,b,d){d?c.addListener("mapvalueexceeded",c.Hg,!1):c.removeListener("mapvalueexceeded",c.Hg,!1)});c.np()},destroy:function(){for(var a,b=this.components;b.getLength()>0&&(a=b.get(0));)this.removeComponent(a);this.yt();this.Rn=this.So=null;try{this.m&&this.m.shutdown()}catch(c){c.toString()!=="Error: Permission denied"&&c.toString()!==
"[object Error]"&&h.d(c)}this.m=null;clearTimeout(this.hl);clearTimeout(this.$m)},vv:function(a,b,c,d){var e=this.om;if(b==="add"){if(e.add(c,d),c==null||a.indexOf(c)!==d)return!0}else e.removeAt(d)},animation:new h.OList(["none","default"]),B:"display",copyrightAlignment:"bottomleft",copyrightWidth:0,copyrightHeight:0,minZoomLevel:0,maxZoomLevel:0,zoomLevel:0,minTilt:0,maxTilt:0,tilt:0,minHeading:0,maxHeading:0,heading:0,padding:{top:0,right:0,bottom:0,left:0},poweredByWidth:0,poweredByHeight:0,
fixedCenter:!0,margin:64,default2dRenderMode:"dom",focus:function(){this.da.focus()},blur:function(){this.da.blur()},setZoomLevel:function(a,b,c,d){this.Lc(b);if(this.P.inProgress)return a;this.Hs(a,c,d);this.m.setZoom(h.Pa(a,this.minZoomLevel,this.maxZoomLevel),c,d)},setCenter:function(a,b){this.P.inProgress||(this.Lc(b),this.m.setCoord(p.fromObject(a)))},setHeading:function(a,b){this.P.inProgress||(this.Lc(b),this.m.setHeading(h.Pa(a,this.minHeading,this.maxHeading)))},setTilt:function(a,b){this.P.inProgress||
(this.Lc(b),this.m.setTilt(h.Pa(a,this.minTilt,this.maxTilt)))},setView:function(a,b){if(!this.P.inProgress)return this.Lc(b),this.m.setView(a)},setCam:function(a,b){if(!this.P.inProgress&&!this.Qw(a.fov))return this.Lc(b),this.m.setCam(a)},setPadding:function(a,b,c,d){var e=arguments.length,e=e>3?[a,b,c,d]:e>2?[a,b,c,b]:e>1?[a,b,a,b]:[a,a,a,a];this.set("padding",{top:e[0],right:e[1],bottom:e[2],left:e[3]})},setAttributes:function(a,b,c,d,e){this.P.inProgress||(b!==void 0&&this.set("center",b),c!==
void 0&&this.set("zoomLevel",c),d!==void 0&&this.set("tilt",d),e!==void 0&&this.set("heading",e))},setCopyrightAlignment:function(a){this.set("copyrightAlignment",a)},setBaseMapType:function(a,b,c){if(!this.P.inProgress){this.Ys=b==="default"?!0:!1;if(c)this.Pd=c;this.set("baseMapType",a)}},setTransition:function(a){this.P.inProgress||this.m.setTransition(a)},getZoom:function(a,b){return this.m.getZoom&&this.m.getZoom(a,b)||this.getView().zoom},getView:function(){if(this.P.inProgress&&!this.Hf)return this.Pu;
return ovi.extend({},this.m.getView())},getCam:function(){if(this.P.inProgress&&!this.Hf)return this.Lu;return ovi.extend({},this.m.getCam())},getComponentById:function(a){for(var b=-1,c=this.components.getLength(),d;++b<c;)if((d=this.components.get(b))&&d.getId()===a)return d;return null},addComponent:function(a){var b=this.getComponentById(a.getId());if(b)return b.queryReference();this.components.add(a);return a},removeComponent:function(a){var b=a.releaseReference();b<=0&&this.components.remove(a);
return b},tt:function(a,b,c){(a=s[b])&&c[a](this);a==="attach"&&this.mp(c)},mp:function(a){a.isCompatible(this.m.type)?a.set("enabled",!0,!0):a.set("enabled",!1,!0)},np:function(){for(var a=this.components.asArray(),b=a.length,c;b--;)c=a[b],this.mp(c)},getUIContainer:function(){return this.T},getClippingUIContainer:function(){return this.rb},getHtmlMapContainer:function(){return this.ed},zt:function(a){var b=new k.DisplayContainer(this,a);this.da=b.da;this.ed=b.t;this.Zf=b.Zf;this.tj=b.tj;this.T=
b.T;this.rb=b.rb;this.So=b.So;this.Rn=b.Rn;this.addEvent=function(a){b.addEvent(a)};this.removeEvent=function(a){b.removeEvent(a)};this.yt=function(){b.containerDestroy()}},Ru:function(a){var b=l.$o;a.style.cssText=b?"position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;transition: opacity .5s linear;".replace(/\b(transition|transform)\b/g,b+"$1"):"";a.addEventListener?a.addEventListener(l.Cs,ovi.bind(this,this.fv),!1):this.Qd&&this.da.removeChild(this.Qd)},Zd:function(a,b){this.Cu=
!0;this.Jt=a;this.dg(a,b);this.Jt=null;this.Cu=!1},cg:function(a,b){this.m.resize(a,b);this.set("width",a);this.set("height",b);this.f=new d(a,b);this.wj=this.f.divide(2).round()},sn:function(a,b,c,d){var e=this.m.capabilities.cam.fov,f=this.baseMapType;a&this.m.capabilities.ZOOM&&this.yj("zoom",b,f.min,f.max);a&m.FOV&&this.yj("fov",b,e.min,e.max,c,d)},rn:function(a){this.m&&(a&this.m.TRANSITION_START&&this.Tp("start"),a&this.m.TRANSITION&&this.dl(this.m),a&this.m.TRANSITION_END&&this.Tp("end"))},
yj:function(a,b,c,d,e,f){var g=h.now();if(g-this.$m>1E3)this.dispatch(new v({type:"mapvalueexceeded",target:this.ed,display:this,valueData:{propertyName:a,value:b,min:c,max:d,x:e,y:f}})),this.$m=g},Bp:function(){this.hc&&this.hc.shutdown();this.Qd&&this.da.removeChild(this.Qd);this.hc=this.Qd=this.Pd=void 0},fv:function(a){a.target==this.Qd&&a.propertyName==="opacity"&&this.Bp()},bounceEnabled:!0,bounce:function(a,b,c){this.P.inProgress||(this.m.setTransition(this.Ca.TRANSITION.AUTO),this.m.bounce(a,
b,c))},Hg:function(a){var a=a.valueData,b=a.min,c=a.value;a.propertyName in{zoom:!0,fov:!0}&&this.bounce(c<b?!1:!0,a.x,a.y)},eu:function(a){var b=e.map.render,c=b.p2d[q&&this.default2dRenderMode==="canvas"?"canvas":"dom"].Engine;return a&4?[b.globe.Engine,b.globe.capabilities]:a&2?[b.panorama.Engine,b.panorama.capabilities]:[c,b.p2d.capabilities]},Xw:function(a){return"pitch"in a&&"roll"in a&&"yaw"in a},gw:function(a){var b=this.Pd,c,d,e,f=this.padding;if(this.P.inProgress)return this.Ca;else{this.Ca=
a;this.P.start();c=document.createElement("div");this.Ru(c);this.Pu=(e=this.hc=this.m)&&e.getView();this.Lu=e&&e.getCam();d=this.Qd=this.Hh;if(e)c.style.visibility="hidden";this.da.insertBefore(c,d||this.tj);if(!b)this.xq=!0,b=e.getView();this.hm=b;b=this.m=new a(c,this.baseMapType,this.om,{onViewChange:this.tn,onStateChange:this.qn,onValueExceeded:this.sn,onTransition:this.rn,onReady:this.pn,fading:this.fading,margin:this.margin});b.setPadding(f.top,f.right,f.bottom,f.left);this.np();this.Hh=c;return a}},
baseMapTypeSetter:function(b){b instanceof k.provider.Provider||a("baseMapType "+b);this.$u=this.baseMapType;return b},componentsSetter:function(a){var b=this.components;b.getLength()&&b.clear();return b.addAll(a)},paddingSetter:function(a){isNaN(a.top-a.right-a.bottom-a.left)&&h.d();var b=this.padding,c=this.m,d=b.top!=a.top||b.right!=a.right||b.bottom!=a.bottom||b.left!=a.left,b=d?{top:+a.top,right:+a.right,bottom:+a.bottom,left:+a.left}:b;if(d){if(!this.fixedCenter&&this.m.type!=="panorama"&&this.m.type!==
"3d"&&(this.wj=this.f.add({x:a.left-a.right,y:a.top-a.bottom}).divide(2).round(),a=c.screenToGeo(this.wj.x,this.wj.y)))c.setTransition(this.Ca.TRANSITION.NONE),c.setCoord(a);this.m.setPadding(b.top,b.right,b.bottom,b.left)}return b},so:function(a){var b=a.type==="mouseleave";this.m.setPointer(b?NaN:a.displayX,b?NaN:a.displayY)},centerSetter:function(a){var b=this.m,c=b.type==="panorama";if(this.P.inProgress)return a;this.Lc("NONE");this.Be||(a=c?b.setCamCoord(p.fromObject(a)):b.setCoord(p.fromObject(a)),
a=p.fromObject(a));this.Be=0;return a},zoomLevelSetter:function(a){var b=h.Pa(a,this.minZoomLevel,this.maxZoomLevel);if(this.P.inProgress)return b;this.Hs(a);this.Lc("NONE");return this.m.setZoom(b)},tiltSetter:function(a){a=h.Pa(a,this.minTilt,this.maxTilt);if(this.P.inProgress)return a;if(!this.Be)this.Be=1,a=this.m.setTilt(a);this.Be=0;return a},headingSetter:function(a){a=h.Pa(a,this.minHeading,this.maxHeading);if(this.P.inProgress)return a;if(!this.Be)this.Be=1,a=this.m.setHeading(a);this.Be=
0;return a},Hs:function(b,c,d){isNaN(b)&&a("zoomLevel");if(!this.P.inProgress&&(b>this.maxZoomLevel||b<this.minZoomLevel))return this.yj("zoom",b,this.minZoomLevel,this.maxZoomLevel,c,d),!0;return!1},Qw:function(a){var b=this.m.capabilities.cam.fov;if(!this.P.inProgress&&(a>b.max||a<b.min))return this.yj("fov",a,b.min,b.max),!0;return!1},fadingSetter:function(){return this.fading},pixelToGeo:function(a,b){return p.fromObject(this.m.screenToGeo(a,b))},geoToPixel:function(a){return this.m.geoToScreen(a)},
zoomTo:function(a,b,c){a=this.m.viewForBBox(b?a.resizeToCenter(this.center):a);this.Lc(c);if(a.zoom>this.maxZoomLevel)a.zoom=this.maxZoomLevel,a.distance=NaN;if(a.zoom<this.minZoomLevel)a.zoom=this.minZoomLevel,a.distance=NaN;this.m.setView(a)},getBestZoomLevel:function(a){var b=this.m,c=this.maxZoomLevel,d,e=a.length;for(isNaN(e)&&h.d();e--;)if((d=b.viewForBBox(a[e]).zoom)<c)c=d;return g(c,this.minZoomLevel)},getViewBounds:function(){return this.m&&this.m.getBBox()||this.hc&&this.hc.getBBox()},getObjectsWithin:function(a,
b,c,d){return this.m.getObjectsWithin(a,b,c,d)},getObjectsAt:function(a,b){return this.m.getObjectsAt(a,b)},getObjectAt:function(a,b){return this.m.getObjectAt(a,b)},nw:function(){if(!this.Kh)this.Bf("start",0),this.Kh=!0},Lc:function(a){a=a==="default"?"auto":a;this.Ca.TRANSITION&&this.m.setTransition(this.Ca.TRANSITION[a?a.toUpperCase():"NONE"])},Bf:function(a,b){this.dispatch(new w.MapViewChangeEvent({type:"mapviewchange"+a,target:this.ed,display:this,data:b}));if(a!=="start")this.Kf=0},dl:function(a){var b,
c,d,e;if(a instanceof this.Ca){b=this.ud;c=a.capabilities;d=a.getView();if(b&c.COORD)a.type==="panorama"&&(e=a.getCam()),a=this.center,this.center=p.fromObject(e||d),this.zd("center",this.center,a);if(b&c.ZOOM)d.zoom<this.minZoomLevel||d.zoom>this.maxZoomLevel?this.set("zoomLevel",d.zoom):(a=this.zoomLevel,this.zoomLevel=d.zoom,a!==this.zoomLevel&&this.zd("zoomLevel",this.zoomLevel,a));if(b&c.HEADING)a=this.heading,this.heading=d.heading,this.zd("heading",this.heading,a);if(b&c.TILT)a=this.tilt,this.tilt=
d.tilt,this.zd("tilt",this.tilt,a)}this.ud=0},tn:function(a,b,c){var d=this,e=h.now(),f=e-d.Wm;if(a!==d.hc){d.ud|=b;d.Kf|=b;if(d.Kh){if(d.Kh&&f>25)d.dl(a),d.Bf("",d.Kf),d.Wm=e}else d.Bf("start",0),d.dl(a),d.Bf("",d.Kf),d.Wm=e,d.Kh=!0;if(c)d.dl(a),d.hl&&clearTimeout(d.hl),d.hl=setTimeout(function(){d.Kf&&d.Bf("",d.Kf);d.Bf("end",0);d.Kh=!1;d.hl=void 0},250)}},qn:function(a,b){this.qaOnLoad&&b==="idle"&&this.qaOnLoad(this.zoomLevel);(this.hc||this.m)&&this.nu(b)},iw:function(){if(this.Hf)this.Pd=void 0,
this.P.finish(),this.Hf=!1},nu:function(a){var b=this.m,c=this.hc;if(a==="error"){this.P.finish();this.Hf=!0;this.Ca=this.m=this.hc=void 0;b.shutdown();if(c)this.Pd=c.getView(),c.shutdown();w.onError&&w.onError(this.Pd);this.onError&&this.onError(this.Pd);return!0}return!1},pn:function(a){var b=this,c=b.hc,d=b.hm,e=b.P,g,k={old:b.$u,current:b.baseMapType};if(a!==b.hc){b.Ys?(c&&c.setTransition(b.Ca.TRANSITION.AUTO),a.setTransition(b.Ca.TRANSITION.AUTO)):(c&&c.setTransition(b.Ca.TRANSITION.NONE),a.setTransition(b.Ca.TRANSITION.NONE));
if(b.viewBounds)b.hm=d=a.viewForBBox(b.viewBounds),delete b.viewBounds;if(c&&c.type==="panorama"&&!b.Pd)g=c.getCam(),d.latitude=g.latitude,d.longitude=g.longitude,d.altitude=c.convertAlt(d,"GL"),d.distance=void 0;b.im("start",k);if(a.type==="2d"&&d.zoom===+d.zoom)d.zoom=f(d.zoom),d.distance=void 0;a.loadDestinationCam(b.hm,function(d){var f,g,h;b.Hh.style.visibility="";if(c){g=f=e.getHandoverCam(a.type,c.type,d);h=b.xq?e.getDestinationCam(a.type,c.type,d):d;if(a.type==="panorama")f=ovi.extend({},
g),g.altitude=d.altitude+52.8;a.setHandoverProperties(g);c.exit(f,function(){b.Yt();a.enter(h,function(){b.P.finish();b.xq=!1;b.im("end",k)})})}else g=h=d,a.setHandoverProperties(g),a.enter(h,function(){b.im("end",k)});a.setPadding(b.padding.top,b.padding.right,b.padding.bottom,b.padding.left);b.cg(b.Hh.offsetWidth,b.Hh.offsetHeight)})}},Yt:function(){this.Hh.style.visibility="visible";b.msie&&b.version<10?this.Bp():this.Qd&&z.$d(this.Qd,0)},Tp:function(a){this.dispatch(new y({type:"transition"+a,
target:this.ed,display:this}))},im:function(a,b){this.dispatch(new B({type:"basemapchange"+a,target:this.ed,display:this,baseMapData:b}));this.Hf&&a==="end"&&(this.iw(),this.dispatch(new C({type:"displayready",target:this.ed,display:this})))},update:function(a,b){this.m&&this.m.update(a<=0?!0:!1,b);return this},av:function(a,b,c){var b=this.eu(c.pType),a=b[0],b=b[1],d=b.view.zoom;this.set("maxZoomLevel",r(c.max,d.min,d.max));this.set("minZoomLevel",r(c.min,d.min,d.max));b.view&&(b.view.tilt&&(this.set("maxTilt",
b.view.tilt.max||0),this.set("minTilt",b.view.tilt.min||0)),b.view.heading&&(this.set("maxHeading",b.view.heading.max||0),this.set("minHeading",b.view.heading.min||0)));this.Ca=this.gw(a);c.bt(this.m);this.Ca===a&&this.m.setMapProvider&&this.m.setMapProvider(c)},pan:function(a,b,c,d,e){var f=this.m;if(a-c||b-d)this.Lc(e),e=this.geoToPixel(this.center),a=this.pixelToGeo(e.x+c-a,e.y+d-b),b=this.getView(),b.latitude=a.latitude,b.longitude=a.longitude,f.setView(b)},getCopyright:function(){var a=this.getViewBounds(),
b=this.zoomLevel,c=[this.baseMapType].concat(this.overlays.asArray()),d=c.length,e=0,f=[];if(a)for(;e<d;e++)c[e].getCopyrights&&(f=f.concat(c[e].getCopyrights(a,b)));for(e=f.length;e--;)a=f[e].label,e!==0&&(a=a.replace(/[0-9]{4}[,\s]+/g,"")),f[e]=a;return f.join(", ")},beginControl:function(a,b,c,d){this.P.inProgress||this.m.beginControl(a,b,c,d)},control:function(a,b,c,d,e,f,g,k){this.P.inProgress||this.m.control(a,b,c,d,e,f,g,k)},endControl:function(a){this.P.inProgress||this.m.endControl(a)},beginInteraction:function(a,
b,c,d,e,f,g){this.P.inProgress||this.m.beginInteraction(a,b,c,d,e,f,g)},interact:function(a,b,c,d,e){this.P.inProgress||this.m.interact(a,b,c,d,e)},endInteraction:function(){this.P.inProgress||this.m.endInteraction()},capture:function(a,b,c,d){var e=this.m,f,g,k;if(e.capabilities.capture){this.sj&&(f=this.sj.getCopyrightGfx(),g=f.getWidth(),k=f.getHeight());a=e.capture(a,b,c,d);for(b=this.components.getLength();b--;)this.components.get(b).capture(a);return this.sj?a.drawGraphics(f,0,0,g,k,0,a.getHeight()-
k,g,k):a}}}),c=k.Display.InteractionModifiers={ZOOM:m.ZOOM,HEADING:m.HEADING,TILT:m.TILT,INCLINE:m.INCLINE,COORD:m.COORD,SIZE:m.SIZE};k.Display.prototype.InteractionModifiers={};h.flatMerge(k.Display.prototype.InteractionModifiers,c);h.flatMerge(k.Display,u.constants);h.flatMerge(k.Display.prototype,u.constants);var c=k.Display.MapViewChangeEvent=function(a){z.Event.call(this,a)},x={MAPVIEWCHANGE_ZOOM:m.ZOOM,MAPVIEWCHANGE_HEADING:m.HEADING,MAPVIEWCHANGE_TILT:m.TILT,MAPVIEWCHANGE_INCLINE:m.INCLINE,
MAPVIEWCHANGE_CENTER:m.COORD,MAPVIEWCHANGE_SIZE:m.SIZE};h.flatMerge(c,x);x.data=0;h.flatMerge(c.prototype=new z.Event,x);var v=k.Display.MapValueExceededEvent=function(a){z.Event.call(this,a)},y=k.Display.TransitionEvent=function(a){z.Event.call(this,a)},B=k.Display.BaseMapChangeEvent=function(a){z.Event.call(this,a)};B.baseMapData={old:void 0,current:void 0};B.prototype=new z.Event;var C=k.Display.DisplayReadyEvent=function(a){z.Event.call(this,a)};x.valueData={value:"",propertyName:"",min:null,
max:null};v.prototype=new z.Event})(nokia.maps);ovi.provide("nokia.maps.map._packaging.package-render-display");})();
