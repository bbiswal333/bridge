describe("IT Direct ticket data", function(){
    var $httpBackend;
    var $q;
    var $rootScope;
    var ticketData;
    var deferred;
    var loadDataCalled = false;
    var mockData = '<feed xmlns="http://www.w3.org/2005/Atom" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xml:base="https://pgxmain.wdf.sap.corp/sap/opu/odata/sap/ZMOB_INCIDENT;v=2/"><id>https://pgxmain.wdf.sap.corp/sap/opu/odata/sap/ZMOB_INCIDENT;v=2/TicketCollection</id><title type="text">TicketCollection</title><updated>2014-08-18T05:36:23Z</updated><author><name/></author><link href="TicketCollection" rel="self" title="TicketCollection"/><entry><id>https://pgxmain.wdf.sap.corp/sap/opu/odata/sap/ZMOB_INCIDENT;v=2/TicketCollection(OBJECT_ID="8000009070",PROCESS_TYPE="ZINC")</id><title type="text">TicketCollection(OBJECT_ID="8000009070",PROCESS_TYPE="ZINC")</title><updated>2014-08-18T05:36:23Z</updated><category term="ZMOB_INCIDENT.Ticket" scheme="http://schemas.microsoft.com/ado/2007/08/dataservices/scheme"/><link href="TicketCollection(OBJECT_ID="8000009070",PROCESS_TYPE="ZINC")" rel="edit" title="Ticket"/><link href="TicketCollection(OBJECT_ID="8000009070",PROCESS_TYPE="ZINC")/Partners" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Partners" type="application/atom+xml;type=feed" title="Partners"/><link href="TicketCollection(OBJECT_ID="8000009070",PROCESS_TYPE="ZINC")/Survey" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Survey" type="application/atom+xml;type=entry" title="Survey"/><link href="TicketCollection(OBJECT_ID="8000009070",PROCESS_TYPE="ZINC")/LongText" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/LongText" type="application/atom+xml;type=feed" title="LongText"/><link href="TicketCollection(OBJECT_ID="8000009070",PROCESS_TYPE="ZINC")/Attachments" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Attachments" type="application/atom+xml;type=feed" title="Attachments"/><link href="TicketCollection(OBJECT_ID="8000009070",PROCESS_TYPE="ZINC")/AttachmentDetails" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/AttachmentDetails" type="application/atom+xml;type=feed" title="AttachmentDetails"/><content type="application/xml"><m:properties xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"><d:OBJECT_ID>8000009070</d:OBJECT_ID><d:PROCESS_TYPE>ZINC</d:PROCESS_TYPE><d:ROLE></d:ROLE><d:GUID>0050569B03091EE288D4E625FF26152B</d:GUID><d:DESCRIPTION>ED: Testmessage for Notifications</d:DESCRIPTION><d:CREATED_AT>20121030153355</d:CREATED_AT><d:CREATED_BY>C5169672</d:CREATED_BY><d:CHANGED_AT>20121030153825</d:CHANGED_AT><d:DUE_DATE>0</d:DUE_DATE><d:PRIORITY>3</d:PRIORITY><d:PRIORITY_DESC>3: Medium</d:PRIORITY_DESC><d:URGENCY>03</d:URGENCY><d:URGENCY_DESC>Medium</d:URGENCY_DESC><d:IMPACT>03</d:IMPACT><d:IMPACT_DESC>Single User limited</d:IMPACT_DESC><d:USER_STATUS>E0001</d:USER_STATUS><d:USER_STATUS_TEXT>New</d:USER_STATUS_TEXT><d:CAT_ID>IMAS_FI_GL</d:CAT_ID><d:CAT_DESC>General Ledger</d:CAT_DESC><d:ASP_ID>ZITSM_IM_CS</d:ASP_ID><d:ASP_GUID>0050569B03091EE287EBD09D510A152B</d:ASP_GUID><d:ATTACH_NO>0</d:ATTACH_NO><d:COMMENT>&lt;div> &lt;u>Details&lt;br>&lt;/u>&lt;br> 30.10.2012&amp;nbsp&amp;nbsp&amp;nbsp16:38:25&amp;nbsp&amp;nbsp&amp;nbspTobias Losert / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;reply&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>16.05.12&amp;#x20;132823&amp;#x20;D051804&lt;br>and&amp;#x20;this&amp;#x20;is&amp;#x20;a&amp;#x20;test-answer&lt;br>&amp;nbsp;&lt;/P>____________________&lt;br>&lt;u>Details&lt;br>&lt;/u>&lt;br> 30.10.2012&amp;nbsp&amp;nbsp&amp;nbsp16:33:55&amp;nbsp&amp;nbsp&amp;nbspTobias Losert / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;longtext&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>15.05.12&amp;#x20;094754&amp;#x20;D051804&lt;br>this&amp;#x20;is&amp;#x20;a&amp;#x20;testmessage&amp;#x20;for&amp;#x20;the&amp;#x20;employee&amp;#x20;dashboard&lt;br>&amp;nbsp;&lt;/P> &lt;/div></d:COMMENT><d:ZZEQUI>000000000000000000</d:ZZEQUI><d:ZZSYS_ID></d:ZZSYS_ID><d:ZZQEC></d:ZZQEC><d:ZZVISIBILITY>01</d:ZZVISIBILITY><d:ZZVISIBILITY_DESC></d:ZZVISIBILITY_DESC><d:COMPLETED></d:COMPLETED><d:CREATED_AT_F>20121030153355</d:CREATED_AT_F><d:CREATED_AT_T>20121030153355</d:CREATED_AT_T><d:CHANGED_AT_F>20121030153825</d:CHANGED_AT_F><d:CHANGED_AT_T>20121030153825</d:CHANGED_AT_T><d:DUE_TO_DATE>20120519114754</d:DUE_TO_DATE><d:PARTIES_OF_REQ></d:PARTIES_OF_REQ><d:PROCESSOR></d:PROCESSOR><d:APPROVER></d:APPROVER><d:REPORTER>X</d:REPORTER><d:AFFECTED>X</d:AFFECTED><d:TEL_NOTEL></d:TEL_NOTEL><d:COUNTRY></d:COUNTRY><d:BUILDING></d:BUILDING><d:FLOOR></d:FLOOR><d:ROOM_NO></d:ROOM_NO><d:MAX_HITS>  5</d:MAX_HITS><d:EDITABLE>X</d:EDITABLE><d:ERRORS></d:ERRORS><d:SYNC_NEEDED></d:SYNC_NEEDED><d:PARAMETER_KEY></d:PARAMETER_KEY><d:DISPLAY_ONLY_FIELDS></d:DISPLAY_ONLY_FIELDS></m:properties></content></entry><entry><id>https://pgxmain.wdf.sap.corp/sap/opu/odata/sap/ZMOB_INCIDENT;v=2/TicketCollection(OBJECT_ID="8000009019",PROCESS_TYPE="ZINC")</id><title type="text">TicketCollection(OBJECT_ID="8000009019",PROCESS_TYPE="ZINC")</title><updated>2014-08-18T05:36:23Z</updated><category term="ZMOB_INCIDENT.Ticket" scheme="http://schemas.microsoft.com/ado/2007/08/dataservices/scheme"/><link href="TicketCollection(OBJECT_ID="8000009019",PROCESS_TYPE="ZINC")" rel="edit" title="Ticket"/><link href="TicketCollection(OBJECT_ID="8000009019",PROCESS_TYPE="ZINC")/Partners" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Partners" type="application/atom+xml;type=feed" title="Partners"/><link href="TicketCollection(OBJECT_ID="8000009019",PROCESS_TYPE="ZINC")/Survey" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Survey" type="application/atom+xml;type=entry" title="Survey"/><link href="TicketCollection(OBJECT_ID="8000009019",PROCESS_TYPE="ZINC")/LongText" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/LongText" type="application/atom+xml;type=feed" title="LongText"/><link href="TicketCollection(OBJECT_ID="8000009019",PROCESS_TYPE="ZINC")/Attachments" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Attachments" type="application/atom+xml;type=feed" title="Attachments"/><link href="TicketCollection(OBJECT_ID="8000009019",PROCESS_TYPE="ZINC")/AttachmentDetails" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/AttachmentDetails" type="application/atom+xml;type=feed" title="AttachmentDetails"/><content type="application/xml"><m:properties xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"><d:OBJECT_ID>8000009019</d:OBJECT_ID><d:PROCESS_TYPE>ZINC</d:PROCESS_TYPE><d:ROLE></d:ROLE><d:GUID>0050569B03091EE288D2D562A036152B</d:GUID><d:DESCRIPTION>ED: Testmessage for Notifications</d:DESCRIPTION><d:CREATED_AT>20121030133536</d:CREATED_AT><d:CREATED_BY>C5175814</d:CREATED_BY><d:CHANGED_AT>20121030133540</d:CHANGED_AT><d:DUE_DATE>0</d:DUE_DATE><d:PRIORITY>3</d:PRIORITY><d:PRIORITY_DESC>3: Medium</d:PRIORITY_DESC><d:URGENCY>03</d:URGENCY><d:URGENCY_DESC>Medium</d:URGENCY_DESC><d:IMPACT>03</d:IMPACT><d:IMPACT_DESC>Single User limited</d:IMPACT_DESC><d:USER_STATUS>E0001</d:USER_STATUS><d:USER_STATUS_TEXT>New</d:USER_STATUS_TEXT><d:CAT_ID>IMAS_FI_GL</d:CAT_ID><d:CAT_DESC>General Ledger</d:CAT_DESC><d:ASP_ID>ZITSM_IM_CS</d:ASP_ID><d:ASP_GUID>0050569B03091EE287EBD09D510A152B</d:ASP_GUID><d:ATTACH_NO>0</d:ATTACH_NO><d:COMMENT>&lt;div> &lt;u>Details&lt;br>&lt;/u>&lt;br> 30.10.2012&amp;nbsp&amp;nbsp&amp;nbsp14:35:40&amp;nbsp&amp;nbsp&amp;nbspThorsten Bruegel / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;reply&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>16.05.12&amp;#x20;132823&amp;#x20;D051804&lt;br>and&amp;#x20;this&amp;#x20;is&amp;#x20;a&amp;#x20;test-answer&lt;br>&amp;nbsp;&lt;/P>____________________&lt;br>&lt;u>Details&lt;br>&lt;/u>&lt;br> 30.10.2012&amp;nbsp&amp;nbsp&amp;nbsp14:35:36&amp;nbsp&amp;nbsp&amp;nbspThorsten Bruegel / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;longtext&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>15.05.12&amp;#x20;094754&amp;#x20;D051804&lt;br>this&amp;#x20;is&amp;#x20;a&amp;#x20;testmessage&amp;#x20;for&amp;#x20;the&amp;#x20;employee&amp;#x20;dashboard&lt;br>&amp;nbsp;&lt;/P> &lt;/div></d:COMMENT><d:ZZEQUI>000000000000000000</d:ZZEQUI><d:ZZSYS_ID></d:ZZSYS_ID><d:ZZQEC></d:ZZQEC><d:ZZVISIBILITY>01</d:ZZVISIBILITY><d:ZZVISIBILITY_DESC></d:ZZVISIBILITY_DESC><d:COMPLETED></d:COMPLETED><d:CREATED_AT_F>20121030133536</d:CREATED_AT_F><d:CREATED_AT_T>20121030133536</d:CREATED_AT_T><d:CHANGED_AT_F>20121030133540</d:CHANGED_AT_F><d:CHANGED_AT_T>20121030133540</d:CHANGED_AT_T><d:DUE_TO_DATE>20120519114754</d:DUE_TO_DATE><d:PARTIES_OF_REQ></d:PARTIES_OF_REQ><d:PROCESSOR></d:PROCESSOR><d:APPROVER></d:APPROVER><d:REPORTER>X</d:REPORTER><d:AFFECTED>X</d:AFFECTED><d:TEL_NOTEL></d:TEL_NOTEL><d:COUNTRY></d:COUNTRY><d:BUILDING></d:BUILDING><d:FLOOR></d:FLOOR><d:ROOM_NO></d:ROOM_NO><d:MAX_HITS>  5</d:MAX_HITS><d:EDITABLE>X</d:EDITABLE><d:ERRORS></d:ERRORS><d:SYNC_NEEDED></d:SYNC_NEEDED><d:PARAMETER_KEY></d:PARAMETER_KEY><d:DISPLAY_ONLY_FIELDS></d:DISPLAY_ONLY_FIELDS></m:properties></content></entry><entry><id>https://pgxmain.wdf.sap.corp/sap/opu/odata/sap/ZMOB_INCIDENT;v=2/TicketCollection(OBJECT_ID="8000008900",PROCESS_TYPE="ZINC")</id><title type="text">TicketCollection(OBJECT_ID="8000008900",PROCESS_TYPE="ZINC")</title><updated>2014-08-18T05:36:23Z</updated><category term="ZMOB_INCIDENT.Ticket" scheme="http://schemas.microsoft.com/ado/2007/08/dataservices/scheme"/><link href="TicketCollection(OBJECT_ID="8000008900",PROCESS_TYPE="ZINC")" rel="edit" title="Ticket"/><link href="TicketCollection(OBJECT_ID="8000008900",PROCESS_TYPE="ZINC")/Partners" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Partners" type="application/atom+xml;type=feed" title="Partners"/><link href="TicketCollection(OBJECT_ID="8000008900",PROCESS_TYPE="ZINC")/Survey" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Survey" type="application/atom+xml;type=entry" title="Survey"/><link href="TicketCollection(OBJECT_ID="8000008900",PROCESS_TYPE="ZINC")/LongText" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/LongText" type="application/atom+xml;type=feed" title="LongText"/><link href="TicketCollection(OBJECT_ID="8000008900",PROCESS_TYPE="ZINC")/Attachments" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Attachments" type="application/atom+xml;type=feed" title="Attachments"/><link href="TicketCollection(OBJECT_ID="8000008900",PROCESS_TYPE="ZINC")/AttachmentDetails" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/AttachmentDetails" type="application/atom+xml;type=feed" title="AttachmentDetails"/><content type="application/xml"><m:properties xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"><d:OBJECT_ID>8000008900</d:OBJECT_ID><d:PROCESS_TYPE>ZINC</d:PROCESS_TYPE><d:ROLE></d:ROLE><d:GUID>0050569B03091EE287E95C1D706F952B</d:GUID><d:DESCRIPTION>ED: Testmessage for Notifications</d:DESCRIPTION><d:CREATED_AT>20121026085528</d:CREATED_AT><d:CREATED_BY>C5175814</d:CREATED_BY><d:CHANGED_AT>20121026090252</d:CHANGED_AT><d:DUE_DATE>0</d:DUE_DATE><d:PRIORITY>3</d:PRIORITY><d:PRIORITY_DESC>3: Medium</d:PRIORITY_DESC><d:URGENCY>03</d:URGENCY><d:URGENCY_DESC>Medium</d:URGENCY_DESC><d:IMPACT>03</d:IMPACT><d:IMPACT_DESC>Single User limited</d:IMPACT_DESC><d:USER_STATUS>E0001</d:USER_STATUS><d:USER_STATUS_TEXT>New</d:USER_STATUS_TEXT><d:CAT_ID>IMAS_FI_GL</d:CAT_ID><d:CAT_DESC>General Ledger</d:CAT_DESC><d:ASP_ID>ZITSM_IM_CS</d:ASP_ID><d:ASP_GUID>0050569B03091EE284F6CF771EF5F52B</d:ASP_GUID><d:ATTACH_NO>0</d:ATTACH_NO><d:COMMENT>&lt;div> &lt;u>Details&lt;br>&lt;/u>&lt;br> 26.10.2012&amp;nbsp&amp;nbsp&amp;nbsp11:02:52&amp;nbsp&amp;nbsp&amp;nbspThorsten Bruegel / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;reply&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>16.05.12&amp;#x20;132823&amp;#x20;D051804&lt;br>and&amp;#x20;this&amp;#x20;is&amp;#x20;a&amp;#x20;test-answer&lt;br>&amp;nbsp;&lt;/P>____________________&lt;br>&lt;u>Details&lt;br>&lt;/u>&lt;br> 26.10.2012&amp;nbsp&amp;nbsp&amp;nbsp10:55:28&amp;nbsp&amp;nbsp&amp;nbspThorsten Bruegel / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;longtext&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>15.05.12&amp;#x20;094754&amp;#x20;D051804&lt;br>this&amp;#x20;is&amp;#x20;a&amp;#x20;testmessage&amp;#x20;for&amp;#x20;the&amp;#x20;employee&amp;#x20;dashboard&lt;br>&amp;nbsp;&lt;/P> &lt;/div></d:COMMENT><d:ZZEQUI>000000000000000000</d:ZZEQUI><d:ZZSYS_ID></d:ZZSYS_ID><d:ZZQEC></d:ZZQEC><d:ZZVISIBILITY>01</d:ZZVISIBILITY><d:ZZVISIBILITY_DESC></d:ZZVISIBILITY_DESC><d:COMPLETED></d:COMPLETED><d:CREATED_AT_F>20121026085528</d:CREATED_AT_F><d:CREATED_AT_T>20121026085528</d:CREATED_AT_T><d:CHANGED_AT_F>20121026090252</d:CHANGED_AT_F><d:CHANGED_AT_T>20121026090252</d:CHANGED_AT_T><d:DUE_TO_DATE>20120519114754</d:DUE_TO_DATE><d:PARTIES_OF_REQ></d:PARTIES_OF_REQ><d:PROCESSOR></d:PROCESSOR><d:APPROVER></d:APPROVER><d:REPORTER>X</d:REPORTER><d:AFFECTED>X</d:AFFECTED><d:TEL_NOTEL></d:TEL_NOTEL><d:COUNTRY></d:COUNTRY><d:BUILDING></d:BUILDING><d:FLOOR></d:FLOOR><d:ROOM_NO></d:ROOM_NO><d:MAX_HITS>  5</d:MAX_HITS><d:EDITABLE>X</d:EDITABLE><d:ERRORS></d:ERRORS><d:SYNC_NEEDED></d:SYNC_NEEDED><d:PARAMETER_KEY></d:PARAMETER_KEY><d:DISPLAY_ONLY_FIELDS></d:DISPLAY_ONLY_FIELDS></m:properties></content></entry><entry><id>https://pgxmain.wdf.sap.corp/sap/opu/odata/sap/ZMOB_INCIDENT;v=2/TicketCollection(OBJECT_ID="8000008897",PROCESS_TYPE="ZINC")</id><title type="text">TicketCollection(OBJECT_ID="8000008897",PROCESS_TYPE="ZINC")</title><updated>2014-08-18T05:36:23Z</updated><category term="ZMOB_INCIDENT.Ticket" scheme="http://schemas.microsoft.com/ado/2007/08/dataservices/scheme"/><link href="TicketCollection(OBJECT_ID="8000008897",PROCESS_TYPE="ZINC")" rel="edit" title="Ticket"/><link href="TicketCollection(OBJECT_ID="8000008897",PROCESS_TYPE="ZINC")/Partners" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Partners" type="application/atom+xml;type=feed" title="Partners"/><link href="TicketCollection(OBJECT_ID="8000008897",PROCESS_TYPE="ZINC")/Survey" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Survey" type="application/atom+xml;type=entry" title="Survey"/><link href="TicketCollection(OBJECT_ID="8000008897",PROCESS_TYPE="ZINC")/LongText" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/LongText" type="application/atom+xml;type=feed" title="LongText"/><link href="TicketCollection(OBJECT_ID="8000008897",PROCESS_TYPE="ZINC")/Attachments" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Attachments" type="application/atom+xml;type=feed" title="Attachments"/><link href="TicketCollection(OBJECT_ID="8000008897",PROCESS_TYPE="ZINC")/AttachmentDetails" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/AttachmentDetails" type="application/atom+xml;type=feed" title="AttachmentDetails"/><content type="application/xml"><m:properties xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"><d:OBJECT_ID>8000008897</d:OBJECT_ID><d:PROCESS_TYPE>ZINC</d:PROCESS_TYPE><d:ROLE></d:ROLE><d:GUID>0050569B03091EE287E95B5E1F21B52B</d:GUID><d:DESCRIPTION>ED: Testmessage for Notifications 2</d:DESCRIPTION><d:CREATED_AT>20121026085517</d:CREATED_AT><d:CREATED_BY>C5175814</d:CREATED_BY><d:CHANGED_AT>20121026090249</d:CHANGED_AT><d:DUE_DATE>0</d:DUE_DATE><d:PRIORITY>3</d:PRIORITY><d:PRIORITY_DESC>3: Medium</d:PRIORITY_DESC><d:URGENCY>03</d:URGENCY><d:URGENCY_DESC>Medium</d:URGENCY_DESC><d:IMPACT>03</d:IMPACT><d:IMPACT_DESC>Single User limited</d:IMPACT_DESC><d:USER_STATUS>E0010</d:USER_STATUS><d:USER_STATUS_TEXT>In process</d:USER_STATUS_TEXT><d:CAT_ID>IMAS_FI_GL</d:CAT_ID><d:CAT_DESC>General Ledger</d:CAT_DESC><d:ASP_ID>ZITSM_IM_CS</d:ASP_ID><d:ASP_GUID>0050569B03091EE284F6CF771EF5F52B</d:ASP_GUID><d:ATTACH_NO>0</d:ATTACH_NO><d:COMMENT>&lt;div> &lt;u>Details&lt;br>&lt;/u>&lt;br> 26.10.2012&amp;nbsp&amp;nbsp&amp;nbsp11:02:49&amp;nbsp&amp;nbsp&amp;nbspThorsten Bruegel / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;reply&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>16.05.12&amp;#x20;122433&amp;#x20;D051804&lt;br>test-answer&lt;br>another&amp;#x20;reply&lt;br>changedsdafasfda&lt;br>&amp;nbsp;&lt;/P>____________________&lt;br>&lt;u>IT-internal Memo&lt;br>&lt;/u>&lt;br> 26.10.2012&amp;nbsp&amp;nbsp&amp;nbsp10:55:21&amp;nbsp&amp;nbsp&amp;nbspThorsten Bruegel / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;internal&amp;#x20;memo&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>20.08.12&amp;#x20;115543&amp;#x20;D051804&lt;br>test&lt;br>&amp;nbsp;&lt;/P>____________________&lt;br>&lt;u>Details&lt;br>&lt;/u>&lt;br> 26.10.2012&amp;nbsp&amp;nbsp&amp;nbsp10:55:17&amp;nbsp&amp;nbsp&amp;nbspThorsten Bruegel / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;longtext&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>15.05.12&amp;#x20;103747&amp;#x20;D051804&lt;br>Notification&amp;#x20;Test&lt;br>&amp;nbsp;&lt;/P> &lt;/div></d:COMMENT><d:ZZEQUI>000000000000000000</d:ZZEQUI><d:ZZSYS_ID></d:ZZSYS_ID><d:ZZQEC></d:ZZQEC><d:ZZVISIBILITY>01</d:ZZVISIBILITY><d:ZZVISIBILITY_DESC></d:ZZVISIBILITY_DESC><d:COMPLETED></d:COMPLETED><d:CREATED_AT_F>20121026085517</d:CREATED_AT_F><d:CREATED_AT_T>20121026085517</d:CREATED_AT_T><d:CHANGED_AT_F>20121026090249</d:CHANGED_AT_F><d:CHANGED_AT_T>20121026090249</d:CHANGED_AT_T><d:DUE_TO_DATE>20120519123747</d:DUE_TO_DATE><d:PARTIES_OF_REQ></d:PARTIES_OF_REQ><d:PROCESSOR>X</d:PROCESSOR><d:APPROVER></d:APPROVER><d:REPORTER>X</d:REPORTER><d:AFFECTED>X</d:AFFECTED><d:TEL_NOTEL></d:TEL_NOTEL><d:COUNTRY></d:COUNTRY><d:BUILDING></d:BUILDING><d:FLOOR></d:FLOOR><d:ROOM_NO></d:ROOM_NO><d:MAX_HITS>  5</d:MAX_HITS><d:EDITABLE>X</d:EDITABLE><d:ERRORS></d:ERRORS><d:SYNC_NEEDED></d:SYNC_NEEDED><d:PARAMETER_KEY></d:PARAMETER_KEY><d:DISPLAY_ONLY_FIELDS></d:DISPLAY_ONLY_FIELDS></m:properties></content></entry><entry><id>https://pgxmain.wdf.sap.corp/sap/opu/odata/sap/ZMOB_INCIDENT;v=2/TicketCollection(OBJECT_ID="8000008842",PROCESS_TYPE="ZINC")</id><title type="text">TicketCollection(OBJECT_ID="8000008842",PROCESS_TYPE="ZINC")</title><updated>2014-08-18T05:36:23Z</updated><category term="ZMOB_INCIDENT.Ticket" scheme="http://schemas.microsoft.com/ado/2007/08/dataservices/scheme"/><link href="TicketCollection(OBJECT_ID="8000008842",PROCESS_TYPE="ZINC")" rel="edit" title="Ticket"/><link href="TicketCollection(OBJECT_ID="8000008842",PROCESS_TYPE="ZINC")/Partners" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Partners" type="application/atom+xml;type=feed" title="Partners"/><link href="TicketCollection(OBJECT_ID="8000008842",PROCESS_TYPE="ZINC")/Survey" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Survey" type="application/atom+xml;type=entry" title="Survey"/><link href="TicketCollection(OBJECT_ID="8000008842",PROCESS_TYPE="ZINC")/LongText" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/LongText" type="application/atom+xml;type=feed" title="LongText"/><link href="TicketCollection(OBJECT_ID="8000008842",PROCESS_TYPE="ZINC")/Attachments" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Attachments" type="application/atom+xml;type=feed" title="Attachments"/><link href="TicketCollection(OBJECT_ID="8000008842",PROCESS_TYPE="ZINC")/AttachmentDetails" rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/AttachmentDetails" type="application/atom+xml;type=feed" title="AttachmentDetails"/><content type="application/xml"><m:properties xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"><d:OBJECT_ID>8000008842</d:OBJECT_ID><d:PROCESS_TYPE>ZINC</d:PROCESS_TYPE><d:ROLE></d:ROLE><d:GUID>0050569B03091EE286B9AE1D1360552B</d:GUID><d:DESCRIPTION>ED: Testmessage for Notifications</d:DESCRIPTION><d:CREATED_AT>20121019091503</d:CREATED_AT><d:CREATED_BY>C5169672</d:CREATED_BY><d:CHANGED_AT>20121019100956</d:CHANGED_AT><d:DUE_DATE>0</d:DUE_DATE><d:PRIORITY>3</d:PRIORITY><d:PRIORITY_DESC>3: Medium</d:PRIORITY_DESC><d:URGENCY>03</d:URGENCY><d:URGENCY_DESC>Medium</d:URGENCY_DESC><d:IMPACT>03</d:IMPACT><d:IMPACT_DESC>Single User limited</d:IMPACT_DESC><d:USER_STATUS>E0001</d:USER_STATUS><d:USER_STATUS_TEXT>New</d:USER_STATUS_TEXT><d:CAT_ID>IMAS_FI_GL</d:CAT_ID><d:CAT_DESC>General Ledger</d:CAT_DESC><d:ASP_ID>ZITSM_IM_CS</d:ASP_ID><d:ASP_GUID>0050569B03091EE284F6CF771EF5F52B</d:ASP_GUID><d:ATTACH_NO>0</d:ATTACH_NO><d:COMMENT>&lt;div> &lt;u>Details&lt;br>&lt;/u>&lt;br> 19.10.2012&amp;nbsp&amp;nbsp&amp;nbsp12:09:56&amp;nbsp&amp;nbsp&amp;nbspTobias Losert / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;reply&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>16.05.12&amp;#x20;132823&amp;#x20;D051804&lt;br>and&amp;#x20;this&amp;#x20;is&amp;#x20;a&amp;#x20;test-answer&lt;br>&amp;nbsp;&lt;/P>____________________&lt;br>&lt;u>Details&lt;br>&lt;/u>&lt;br> 19.10.2012&amp;nbsp&amp;nbsp&amp;nbsp11:15:03&amp;nbsp&amp;nbsp&amp;nbspTobias Losert / D-65795 Hattersheim am Main&lt;br>&lt;br>&lt;P>&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x20;CSS&amp;#x20;longtext&amp;#x20;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&amp;#x2a;&lt;br>15.05.12&amp;#x20;094754&amp;#x20;D051804&lt;br>this&amp;#x20;is&amp;#x20;a&amp;#x20;testmessage&amp;#x20;for&amp;#x20;the&amp;#x20;employee&amp;#x20;dashboard&lt;br>&amp;nbsp;&lt;/P> &lt;/div></d:COMMENT><d:ZZEQUI>000000000000000000</d:ZZEQUI><d:ZZSYS_ID></d:ZZSYS_ID><d:ZZQEC></d:ZZQEC><d:ZZVISIBILITY>01</d:ZZVISIBILITY><d:ZZVISIBILITY_DESC></d:ZZVISIBILITY_DESC><d:COMPLETED></d:COMPLETED><d:CREATED_AT_F>20121019091503</d:CREATED_AT_F><d:CREATED_AT_T>20121019091503</d:CREATED_AT_T><d:CHANGED_AT_F>20121019100956</d:CHANGED_AT_F><d:CHANGED_AT_T>20121019100956</d:CHANGED_AT_T><d:DUE_TO_DATE>20120519114754</d:DUE_TO_DATE><d:PARTIES_OF_REQ></d:PARTIES_OF_REQ><d:PROCESSOR></d:PROCESSOR><d:APPROVER></d:APPROVER><d:REPORTER>X</d:REPORTER><d:AFFECTED>X</d:AFFECTED><d:TEL_NOTEL></d:TEL_NOTEL><d:COUNTRY></d:COUNTRY><d:BUILDING></d:BUILDING><d:FLOOR></d:FLOOR><d:ROOM_NO></d:ROOM_NO><d:MAX_HITS>  5</d:MAX_HITS><d:EDITABLE>X</d:EDITABLE><d:ERRORS></d:ERRORS><d:SYNC_NEEDED></d:SYNC_NEEDED><d:PARAMETER_KEY></d:PARAMETER_KEY><d:DISPLAY_ONLY_FIELDS></d:DISPLAY_ONLY_FIELDS></m:properties></content></entry></feed>';

    var loadDataMock = function() {
        loadDataCalled = true;
        return deferred.promise;
    };

    beforeEach(function(){
        angular.module("mock.module", []).service("bridgeDataService", function(){
            this.getUserInfo = function() {
                return {
                    BNAME: "D051804"
                };
            };
        });

        module("app.itdirect");
        module("mock.module");
        inject(["$rootScope", "$httpBackend", "$q", "app.itdirect.ticketData", function(_$rootScope, _$httpBackend, _$q, _ticketData){
            $rootScope = _$rootScope;
            $httpBackend = _$httpBackend;
            $q = _$q;
            ticketData = _ticketData;
        }]);
    });

    it("should set the initialized flag and get the data from the backend", function () {
        deferred = $q.defer();

        expect(angular.isFunction(ticketData.loadTicketData)).toBe(true);
        ticketData.loadTicketData = loadDataMock;

        var initializePromise = ticketData.initialize();

        initializePromise.then(function success() {
            expect(ticketData.isInitialized.value).toBe(true);
            expect(loadDataCalled).toBe(true);
        });

        deferred.resolve();
        $rootScope.$apply();
    });

    it("should load the data from the backend", function(){
        $httpBackend.whenGET(/https:\/\/pgpmain\.wdf\.sap\.corp\/sap\/opu\/odata\/sap\/ZMOB_INCIDENT;v=2\/TicketCollection\?$filter=PROCESS_TYPE eq 'ZINC,ZSER' and PARTIES_OF_REQ eq(.*)/)
            .respond(mockData);

        ticketData.loadTicketData();
    });
});
